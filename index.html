<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="keywords" content="MessagePack,msgpack,JSON,alternative,better json,faster json,serializer">
  <link href='favicon.ico' rel='icon' type='image/x-icon'>

  <link rel="alternate" hreflang="en" href="index.html">
  <link rel="alternate" hreflang="ja" href="ja.html">


  <title>MessagePack: It&#39;s like JSON. but fast and small.</title>

  <link media="all" rel="stylesheet" href="css/yuibase.css">
  <link media="all" rel="stylesheet" href="js/prettify/prettify.css">
  <link media="all" rel="stylesheet" href="css/all.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web:400,200">
  <script src="js/all.js"></script>
  <script src="js/prettify/prettify.js"></script>
  <script src="js/prettify/run_prettify.js"></script>
  <script src="js/jquery-2.1.4.min.js"></script>
  <script src="js/jquery.leanModal.min.js" ></script>
  <script src="js/msgpack.js" ></script>

  <style>
  
  </style>

  <script type="text/javascript">
  // select initially-selected quick start randomly
  $(function(){
    var index = Math.floor(Math.random()*(document.getElementsByClassName('qs').length-1));
    changeQuickStart(document.getElementsByClassName('qs')[index].id,document.getElementsByClassName('qs-a')[index])}
  );

  $(function() {
    $('pre > code').addClass('prettyprint');
    prettyPrint();
  });

  $(function() {
    $('a[rel*=leanModal]').leanModal({
      top: 100,
      overlay : 0.5,
      closeButton: ".modal_close"
    });
    $(document).keydown(function(e) {
      if (e.keyCode == 27) {
        $('#lean_overlay').fadeOut(200);
        $('#json-to-msgpack').css({'display':'none'});
      }
    });
  });
  </script>

  <script type="text/javascript">
  $(function() {
    $("#json-text").keyup(function(event) {
      var text = $("#json-text").val();
      var obj;
      try {
         obj = JSON.parse(text);
      } catch (e) {
         return;
      }
      var msg = msgpack.pack(obj);
      var hex = jQuery.map(msg, function(e,i) {
        return ("0" + e.toString(16)).slice(-2);
      }).join(" ");
      $("#msgpack-text").text(hex);
      var textLength = encodeURIComponent(text).replace(/%../g,"%").length;
      $("#json-bytes").text(textLength.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + " bytes");
      $("#msgpack-bytes").text(msg.length.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + " bytes");
      $("#msgpack-percent").text(Math.round(msg.length / textLength * 100).toString() + " %");
    }).keyup();
    $("#msgpack-text").keyup(function(event) {
      var hex = $("#msgpack-text").val().replace(/ +/g,'');
      var msgbytes = [];
      for(var i=0; i< hex.length-1; i+=2){
        msgbytes.push(parseInt(hex.substr(i, 2), 16));
      }
      var msg = String.fromCharCode.apply(String, msgbytes);
      var obj=msgpack.unpack(msg);
      var text=JSON.stringify(obj);
      $("#json-text").text(text);
      var textLength = encodeURIComponent(text).replace(/%../g,"%").length;
      $("#json-bytes").text(textLength.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + " bytes");
      $("#msgpack-bytes").text(msg.length.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + " bytes");
      $("#msgpack-percent").text(Math.round(msg.length / textLength * 100).toString() + " %");
    });
  });
  </script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-17125377-1', 'auto', {'allowLinker': true});
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
  </script>
</head>
<body>
  <header>
    <div>
      <h1><a href="/">MessagePack</a></h1>
      <nav id="topnav">
        <ul>
          <li><a rel="leanModal" href="#json-to-msgpack" class="i18n_nav">Try!</a></li>
          <li><a href="https://github.com/msgpack/msgpack/blob/master/spec.md" class="i18n_nav">Spec</a></li>
          <li><a href="https://twitter.com/search/MessagePack%20OR%20msgpack" class="i18n_nav">#msgpack</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <section id="introduction">
      <div id="description">
        <h2 class="i18n">It's like JSON.<br />but fast and small.</h2>
        <p class="i18n">MessagePack is an efficient binary serialization format. It lets you exchange data among multiple languages like JSON. But it's faster and smaller. Small integers are encoded into a single byte, and typical short strings require only one extra byte in addition to the strings themselves.</p>
      </div>

      <div id="next">
        <h3 class="i18n_head i18n_next">Next:</h3>
        <p class="i18n">MessagePack is supported by over 50 programming languages and environments.<br />See <a href="#languages">list of implementations</a>.</p>
      </div>
    </section>

    
    <section id="usecases">
      <div id="testimonials">
        <div class="tmset">
          <div class="tm">
            <a class="tmlogo" href="https://redis.io/"><img src="images/redis.png" alt="Redis" width="150" height="50" /></a>
            <p class="tmtext">Redis scripting has support for MessagePack because it is a fast and compact serialization format with a simple to implement specification. I liked it so much that I implemented a MessagePack C extension for Lua just to include it into Redis.</p>
            <p class="tmauthor">Salvatore Sanfilippo, creator of Redis</p>
          </div>

          <div class="tm">
            <a class="tmlogo" href="https://fluentd.org/" style="height:100px;margin-top:-35px;"><img src="images/fluentd.png" alt="Fluentd" width="245" height="85" /></a>
            <p class="tmtext">Fluentd uses MessagePack for all internal data representation. It's crazy fast because of zero-copy optimization of msgpack-ruby. Now MessagePack is an essential component of Fluentd to achieve high performance and flexibility at the same time.</p>
            <p class="tmauthor">Sadayuki Furuhashi, creator of Fluentd</p>
          </div>
        </div>

        <div class="tmset">
          <div class="tm">
            <a class="tmlogo" href="https://www.treasuredata.com/"><img src="images/treasuredata.png" alt="Treasure Data" width="242" height="52" /></a>
            <p class="tmtext">Treasure Data built a multi-tenant database optimized for analytical queries using MessagePack. The schemaless database is growing by billions of records every month. We also use MessagePack as a glue between components. Actually we just wanted a fast replacement of JSON, and MessagePack is simply useful.</p>
            <p class="tmauthor">Kazuki Ohta, CTO</p>
          </div>

          <div class="tm">
            <a class="tmlogo" href="https://www.pinterest.com/pinterest/"><img src="images/pinterest.png" alt="Pinterest" width="197" height="50" /></a>
            <p class="tmtext">MessagePack has been simply invaluable to us. We use MessagePack + Memcache to cache many of our feeds on Pinterest. These feeds are compressed and very quick to unpack thanks to MessagePack while Memcache gives us fast atomic pushes.</p>
            <p class="tmauthor">Marty Weiner, Software Engineer</p>

            <p class="tmcontribute">Also use MessagePack? <a href="https://github.com/msgpack/website">Waiting for your testimonial!</a></p>
          </div>
        </div>
      </div>

      <div id="twitter">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/search?q=msgpack+OR+MessagePack+lang%3Aen" data-widget-id="343624208380735490" width="350" height="500">Tweets about "msgpack OR MessagePack"</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
      </div>
    </section>
    

    <section id="usage">
      <div id="languages">
        <h3 class="i18n_head">Languages</h3>

        <ul class="qslist">
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-camgunz-cmp',this)">C <span class="qs-sub">camgunz</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-ludocode-mpack',this)">C <span class="qs-sub">ludocode</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-cli',this)">C# <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-neuecc-MessagePack-CSharp',this)">C# <span class="qs-sub">neuecc</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-Lichtso-netLink',this)">C++11 <span class="qs-sub">Lichtso</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-c',this)">C/C++ <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-crystal-community-msgpack-crystal',this)">Crystal <span class="qs-sub">crystal-community</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-d',this)">D <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-erlang',this)">Erlang <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-vmihailenco-msgpack',this)">Go <span class="qs-sub">vmihailenco</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-ugorji-go',this)">Go <span class="qs-sub">ugorji</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-tinylib-msgp',this)">Go <span class="qs-sub">tinylib</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-haskell',this)">Haskell <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-java',this)">Java <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-javascript',this)">JavaScript <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-kawanet-msgpack-lite',this)">JavaScript <span class="qs-sub">kawanet</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-markstinson-lua-MessagePack',this)">Lua <span class="qs-sub">markstinson</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-mcollina-msgpack5',this)">Node <span class="qs-sub">mcollina</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-gabriel-MPMessagePack',this)">Objective-C <span class="qs-sub">gabriel</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-php',this)">PHP <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-ymofen-msgpack-delphi',this)">Pascal <span class="qs-sub">ymofen</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-romixlab-qmsgpack',this)">Qt <span class="qs-sub">romixlab</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-ruby',this)">Ruby <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-3Hren-msgpack-rust',this)">Rust <span class="qs-sub">3Hren</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-msgpack-msgpack-scala',this)">Scala <span class="qs-sub">msgpack</span></a></li>
          
          <li><a class="qs-a" onclick="changeQuickStart('qs-a2-MessagePack-swift',this)">Swift <span class="qs-sub">a2</span></a></li>
          
        </ul>
      </div>

      <div id="api">
        <h3 class="i18n_head">API</h3>
        <h4 id="language">&nbsp;</h4>
        <div id="quickstart" class="qsholder"></div>
        <p id="quickstart-guide"><a href="https://github.com/msgpack/website/blob/master/README.md#how-to-list-up-your-project-on-msgpackorg">List your implementation here!</a></p>

        
        <div id="qs-camgunz-cmp" class="qs"><h4><a href="https://github.com/camgunz/cmp" target="_blank">camgunz/cmp <span class="qs-url">https://github.com/camgunz/cmp</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-cmp" class="anchor" aria-hidden="true" href="#cmp"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CMP</h5>
<p dir="auto"><a href="https://travis-ci.org/camgunz/cmp" rel="nofollow"><img src="https://camo.githubusercontent.com/465d8533b73a5e982f26d2aa13f67ff2d336156209ffdf7811970bdcbade7cb9/68747470733a2f2f7472617669732d63692e6f72672f63616d67756e7a2f636d702e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/camgunz/cmp.svg?branch=master" style="max-width: 100%;"></a> <a href="https://coveralls.io/github/camgunz/cmp?branch=develop" rel="nofollow"><img src="https://camo.githubusercontent.com/f20bd22a78b2ced18c4325d686e75c1eff942defe46751faf16e9c2ada8519d1/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f63616d67756e7a2f636d702f62616467652e7376673f6272616e63683d646576656c6f70" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/camgunz/cmp/badge.svg?branch=develop" style="max-width: 100%;"></a></p>
<p dir="auto">CMP is a C implementation of the MessagePack serialization format.  It
currently implements version 5 of the <a href="http://github.com/msgpack/msgpack/blob/master/spec.md">MessagePack
Spec</a>.</p>
<p dir="auto">CMP's goal is to be lightweight and straightforward, forcing nothing on the
programmer.</p>
<h6 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h6>
<p dir="auto">While I'm a big believer in the GPL, I license CMP under the MIT license.</p>
<h6 dir="auto">
<a id="user-content-example-usage" class="anchor" aria-hidden="true" href="#example-usage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example Usage</h6>
<p dir="auto">The following examples use a file as the backend, and are modeled after the
examples included with the msgpack-c project.</p>
<div class="highlight highlight-source-c position-relative overflow-auto" data-snippet-clipboard-copy-content="#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#include &quot;cmp.h&quot;

static bool read_bytes(void *data, size_t sz, FILE *fh) {
    return fread(data, sizeof(uint8_t), sz, fh) == (sz * sizeof(uint8_t));
}

static bool file_reader(cmp_ctx_t *ctx, void *data, size_t limit) {
    return read_bytes(data, limit, (FILE *)ctx-&gt;buf);
}

static bool file_skipper(cmp_ctx_t *ctx, size_t count) {
    return fseek((FILE *)ctx-&gt;buf, count, SEEK_CUR);
}

static size_t file_writer(cmp_ctx_t *ctx, const void *data, size_t count) {
    return fwrite(data, sizeof(uint8_t), count, (FILE *)ctx-&gt;buf);
}

static void error_and_exit(const char *msg) {
    fprintf(stderr, &quot;%s\n\n&quot;, msg);
    exit(EXIT_FAILURE);
}

int main(void) {
    FILE *fh = NULL;
    cmp_ctx_t cmp = {0};
    uint32_t array_size = 0;
    uint32_t str_size = 0;
    char hello[6] = {0};
    char message_pack[12] = {0};

    fh = fopen(&quot;cmp_data.dat&quot;, &quot;w+b&quot;);

    if (fh == NULL) {
        error_and_exit(&quot;Error opening data.dat&quot;);
    }

    cmp_init(&amp;cmp, fh, file_reader, file_skipper, file_writer);

    if (!cmp_write_array(&amp;cmp, 2)) {
        error_and_exit(cmp_strerror(&amp;cmp));
    }

    if (!cmp_write_str(&amp;cmp, &quot;Hello&quot;, 5)) {
        error_and_exit(cmp_strerror(&amp;cmp));
    }

    if (!cmp_write_str(&amp;cmp, &quot;MessagePack&quot;, 11)) {
        error_and_exit(cmp_strerror(&amp;cmp));
    }

    rewind(fh);

    if (!cmp_read_array(&amp;cmp, &amp;array_size)) {
        error_and_exit(cmp_strerror(&amp;cmp));
    }

    /* You can read the str byte size and then read str bytes... */

    if (!cmp_read_str_size(&amp;cmp, &amp;str_size)) {
        error_and_exit(cmp_strerror(&amp;cmp));
    }

    if (str_size &gt; (sizeof(hello) - 1)) {
        error_and_exit(&quot;Packed 'hello' length too long\n&quot;);
    }

    if (!read_bytes(hello, str_size, fh)) {
        error_and_exit(cmp_strerror(&amp;cmp));
    }

    /*
     * ...or you can set the maximum number of bytes to read and do it all in
     * one call
     */

    str_size = sizeof(message_pack);
    if (!cmp_read_str(&amp;cmp, message_pack, &amp;str_size)) {
        error_and_exit(cmp_strerror(&amp;cmp));
    }

    printf(&quot;Array Length: %u.\n&quot;, array_size);
    printf(&quot;[\&quot;%s\&quot;, \&quot;%s\&quot;]\n&quot;, hello, message_pack);

    fclose(fh);

    return EXIT_SUCCESS;
}"><pre>#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">&lt;</span>stdio.h<span class="pl-pds">&gt;</span></span>
#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">&lt;</span>stdlib.h<span class="pl-pds">&gt;</span></span>

#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>cmp.h<span class="pl-pds">"</span></span>

<span class="pl-k">static</span> <span class="pl-k">bool</span> <span class="pl-en">read_bytes</span>(<span class="pl-k">void</span> *data, <span class="pl-c1">size_t</span> sz, FILE *fh) {
    <span class="pl-k">return</span> <span class="pl-c1">fread</span>(data, <span class="pl-k">sizeof</span>(<span class="pl-c1">uint8_t</span>), sz, fh) == (sz * <span class="pl-k">sizeof</span>(<span class="pl-c1">uint8_t</span>));
}

<span class="pl-k">static</span> <span class="pl-k">bool</span> <span class="pl-en">file_reader</span>(<span class="pl-c1">cmp_ctx_t</span> *ctx, <span class="pl-k">void</span> *data, <span class="pl-c1">size_t</span> limit) {
    <span class="pl-k">return</span> <span class="pl-c1">read_bytes</span>(data, limit, (FILE *)ctx-&gt;<span class="pl-smi">buf</span>);
}

<span class="pl-k">static</span> <span class="pl-k">bool</span> <span class="pl-en">file_skipper</span>(<span class="pl-c1">cmp_ctx_t</span> *ctx, <span class="pl-c1">size_t</span> count) {
    <span class="pl-k">return</span> <span class="pl-c1">fseek</span>((FILE *)ctx-&gt;<span class="pl-smi">buf</span>, count, SEEK_CUR);
}

<span class="pl-k">static</span> <span class="pl-c1">size_t</span> <span class="pl-en">file_writer</span>(<span class="pl-c1">cmp_ctx_t</span> *ctx, <span class="pl-k">const</span> <span class="pl-k">void</span> *data, <span class="pl-c1">size_t</span> count) {
    <span class="pl-k">return</span> <span class="pl-c1">fwrite</span>(data, <span class="pl-k">sizeof</span>(<span class="pl-c1">uint8_t</span>), count, (FILE *)ctx-&gt;<span class="pl-smi">buf</span>);
}

<span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">error_and_exit</span>(<span class="pl-k">const</span> <span class="pl-k">char</span> *msg) {
    <span class="pl-c1">fprintf</span>(stderr, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-c1">%s</span><span class="pl-cce">\n\n</span><span class="pl-pds">"</span></span>, msg);
    <span class="pl-c1">exit</span>(EXIT_FAILURE);
}

<span class="pl-k">int</span> <span class="pl-en">main</span>(<span class="pl-k">void</span>) {
    FILE *fh = <span class="pl-c1">NULL</span>;
    <span class="pl-c1">cmp_ctx_t</span> cmp = {<span class="pl-c1">0</span>};
    <span class="pl-c1">uint32_t</span> array_size = <span class="pl-c1">0</span>;
    <span class="pl-c1">uint32_t</span> str_size = <span class="pl-c1">0</span>;
    <span class="pl-k">char</span> hello[<span class="pl-c1">6</span>] = {<span class="pl-c1">0</span>};
    <span class="pl-k">char</span> message_pack[<span class="pl-c1">12</span>] = {<span class="pl-c1">0</span>};

    fh = <span class="pl-c1">fopen</span>(<span class="pl-s"><span class="pl-pds">"</span>cmp_data.dat<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>w+b<span class="pl-pds">"</span></span>);

    <span class="pl-k">if</span> (fh == <span class="pl-c1">NULL</span>) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-s"><span class="pl-pds">"</span>Error opening data.dat<span class="pl-pds">"</span></span>);
    }

    <span class="pl-c1">cmp_init</span>(&amp;cmp, fh, file_reader, file_skipper, file_writer);

    <span class="pl-k">if</span> (!<span class="pl-c1">cmp_write_array</span>(&amp;cmp, <span class="pl-c1">2</span>)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-c1">cmp_strerror</span>(&amp;cmp));
    }

    <span class="pl-k">if</span> (!<span class="pl-c1">cmp_write_str</span>(&amp;cmp, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span>, <span class="pl-c1">5</span>)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-c1">cmp_strerror</span>(&amp;cmp));
    }

    <span class="pl-k">if</span> (!<span class="pl-c1">cmp_write_str</span>(&amp;cmp, <span class="pl-s"><span class="pl-pds">"</span>MessagePack<span class="pl-pds">"</span></span>, <span class="pl-c1">11</span>)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-c1">cmp_strerror</span>(&amp;cmp));
    }

    <span class="pl-c1">rewind</span>(fh);

    <span class="pl-k">if</span> (!<span class="pl-c1">cmp_read_array</span>(&amp;cmp, &amp;array_size)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-c1">cmp_strerror</span>(&amp;cmp));
    }

    <span class="pl-c"><span class="pl-c">/*</span> You can read the str byte size and then read str bytes... <span class="pl-c">*/</span></span>

    <span class="pl-k">if</span> (!<span class="pl-c1">cmp_read_str_size</span>(&amp;cmp, &amp;str_size)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-c1">cmp_strerror</span>(&amp;cmp));
    }

    <span class="pl-k">if</span> (str_size &gt; (<span class="pl-k">sizeof</span>(hello) - <span class="pl-c1">1</span>)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-s"><span class="pl-pds">"</span>Packed 'hello' length too long<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    }

    <span class="pl-k">if</span> (!<span class="pl-c1">read_bytes</span>(hello, str_size, fh)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-c1">cmp_strerror</span>(&amp;cmp));
    }

    <span class="pl-c"><span class="pl-c">/*</span></span>
<span class="pl-c">     * ...or you can set the maximum number of bytes to read and do it all in</span>
<span class="pl-c">     * one call</span>
<span class="pl-c">     <span class="pl-c">*/</span></span>

    str_size = <span class="pl-k">sizeof</span>(message_pack);
    <span class="pl-k">if</span> (!<span class="pl-c1">cmp_read_str</span>(&amp;cmp, message_pack, &amp;str_size)) {
        <span class="pl-c1">error_and_exit</span>(<span class="pl-c1">cmp_strerror</span>(&amp;cmp));
    }

    <span class="pl-c1">printf</span>(<span class="pl-s"><span class="pl-pds">"</span>Array Length: <span class="pl-c1">%u</span>.<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>, array_size);
    <span class="pl-c1">printf</span>(<span class="pl-s"><span class="pl-pds">"</span>[<span class="pl-cce">\"</span><span class="pl-c1">%s</span><span class="pl-cce">\"</span>, <span class="pl-cce">\"</span><span class="pl-c1">%s</span><span class="pl-cce">\"</span>]<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>, hello, message_pack);

    <span class="pl-c1">fclose</span>(fh);

    <span class="pl-k">return</span> EXIT_SUCCESS;
}</pre></div>
<h6 dir="auto">
<a id="user-content-advanced-usage" class="anchor" aria-hidden="true" href="#advanced-usage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Advanced Usage</h6>
<p dir="auto">See the <code>examples</code> folder.</p>
<h6 dir="auto">
<a id="user-content-fast-lightweight-flexible-and-robust" class="anchor" aria-hidden="true" href="#fast-lightweight-flexible-and-robust"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Fast, Lightweight, Flexible, and Robust</h6>
<p dir="auto">CMP uses no internal buffers; conversions, encoding and decoding are done on
the fly.</p>
<p dir="auto">CMP's source and header file together are ~4k LOC.</p>
<p dir="auto">CMP makes no heap allocations.</p>
<p dir="auto">CMP uses standardized types rather than declaring its own, and it depends only
on <code>stdbool.h</code>, <code>stdint.h</code> and <code>string.h</code>.</p>
<p dir="auto">CMP is written using C89 (ANSI C), aside, of course, from its use of
fixed-width integer types and <code>bool</code>.</p>
<p dir="auto">On the other hand, CMP's test suite requires C99.</p>
<p dir="auto">CMP only requires the programmer supply a read function, a write function, and
an optional skip function.  In this way, the programmer can use CMP on memory,
files, sockets, etc.</p>
<p dir="auto">CMP is portable.  It uses fixed-width integer types, and checks the endianness
of the machine at runtime before swapping bytes (MessagePack is big-endian).</p>
<p dir="auto">CMP provides a fairly comprehensive error reporting mechanism modeled after
<code>errno</code> and <code>strerror</code>.</p>
<p dir="auto">CMP is thread aware; while contexts cannot be shared between threads, each
thread may use its own context freely.</p>
<p dir="auto">CMP is tested using the MessagePack test suite as well as a large set of custom
test cases.  Its small test program is compiled with clang using <code>-Wall -Werror -Wextra ...</code> along with several other flags, and generates no compilation
errors in either clang or GCC.</p>
<p dir="auto">CMP's source is written as readably as possible, using explicit, descriptive
variable names and a consistent, clear style.</p>
<p dir="auto">CMP's source is written to be as secure as possible.  Its testing suite checks
for invalid values, and data is always treated as suspect before it passes
validation.</p>
<p dir="auto">CMP's API is designed to be clear, convenient and unsurprising.  Strings are
null-terminated, binary data is not, error codes are clear, and so on.</p>
<p dir="auto">CMP provides optional backwards compatibility for use with other MessagePack
implementations that only implement version 4 of the spec.</p>
<h6 dir="auto">
<a id="user-content-building" class="anchor" aria-hidden="true" href="#building"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Building</h6>
<p dir="auto">There is no build system for CMP.  The programmer can drop <code>cmp.c</code> and <code>cmp.h</code>
in their source tree and modify as necessary.  No special compiler settings are
required to build it, and it generates no compilation errors in either clang or
gcc.</p>
<h6 dir="auto">
<a id="user-content-versioning" class="anchor" aria-hidden="true" href="#versioning"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Versioning</h6>
<p dir="auto">CMP's versions are single integers.  I don't use semantic versioning because
I don't guarantee that any version is completely compatible with any other.  In
general, semantic versioning provides a false sense of security.  You should be
evaluating compatibility yourself, not relying on some stranger's versioning
convention.</p>
<h6 dir="auto">
<a id="user-content-stability" class="anchor" aria-hidden="true" href="#stability"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Stability</h6>
<p dir="auto">I only guarantee stability for versions released on
<a href="/camgunz/cmp/releases">the releases page</a>.  While rare, both <code>master</code> and <code>develop</code>
branches may have errors or mismatched versions.</p>
<h6 dir="auto">
<a id="user-content-backwards-compatibility" class="anchor" aria-hidden="true" href="#backwards-compatibility"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Backwards Compatibility</h6>
<p dir="auto">Version 4 of the MessagePack spec has no <code>BIN</code> type, and provides no <code>STR8</code>
marker.  In order to remain backwards compatible with version 4 of MessagePack,
do the following:</p>
<p dir="auto">Avoid these functions:</p>
<ul dir="auto">
<li><code>cmp_write_bin</code></li>
<li><code>cmp_write_bin_marker</code></li>
<li><code>cmp_write_str8_marker</code></li>
<li><code>cmp_write_str8</code></li>
<li><code>cmp_write_bin8_marker</code></li>
<li><code>cmp_write_bin8</code></li>
<li><code>cmp_write_bin16_marker</code></li>
<li><code>cmp_write_bin16</code></li>
<li><code>cmp_write_bin32_marker</code></li>
<li><code>cmp_write_bin32</code></li>
</ul>
<p dir="auto">Use these functions in lieu of their v5 counterparts:</p>
<ul dir="auto">
<li>
<code>cmp_write_str_marker_v4</code> instead of <code>cmp_write_str_marker</code>
</li>
<li>
<code>cmp_write_str_v4</code> instead of <code>cmp_write_str</code>
</li>
<li>
<code>cmp_write_object_v4</code> instead of <code>cmp_write_object</code>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-disabling-floating-point-operations" class="anchor" aria-hidden="true" href="#disabling-floating-point-operations"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Disabling Floating Point Operations</h6>
<p dir="auto">Thanks to <a href="https://github.com/tdragon">tdragon</a> it's possible to disable
floating point operations in CMP by defining <code>CMP_NO_FLOAT</code>. No floating point
functionality will be included.  Fair warning: this changes the ABI.</p>
<h6 dir="auto">
<a id="user-content-setting-endianness-at-compile-time" class="anchor" aria-hidden="true" href="#setting-endianness-at-compile-time"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Setting Endianness at Compile Time</h6>
<p dir="auto">CMP will honor <code>WORDS_BIGENDIAN</code>. If defined to <code>0</code> it will convert data
to/from little-endian format when writing/reading. If defined to <code>1</code> it won't.
If not defined, CMP will check at runtime.</p>
</article>
  </div>
        </div>
        
        <div id="qs-ludocode-mpack" class="qs"><h4><a href="https://github.com/ludocode/mpack" target="_blank">ludocode/mpack <span class="qs-url">https://github.com/ludocode/mpack</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h6 dir="auto">
<a id="user-content-introduction" class="anchor" aria-hidden="true" href="#introduction"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Introduction</h6>
<p dir="auto">MPack is a C implementation of an encoder and decoder for the <a href="http://msgpack.org/" rel="nofollow">MessagePack</a> serialization format. It is:</p>
<ul dir="auto">
<li>Simple and easy to use</li>
<li>Secure against untrusted data</li>
<li>Lightweight, suitable for embedded</li>
<li><a href="http://ludocode.github.io/mpack/" rel="nofollow">Extensively documented</a></li>
<li><a href="https://github.com/ludocode/schemaless-benchmarks#speed---desktop-pc">Extremely fast</a></li>
</ul>
<p dir="auto">The core of MPack contains a buffered reader and writer, and a tree-style parser that decodes into a tree of dynamically typed nodes. Helper functions can be enabled to read values of expected type, to work with files, to grow buffers or allocate strings automatically, to check UTF-8 encoding, and more.</p>
<p dir="auto">The MPack code is small enough to be embedded directly into your codebase. Simply download the <a href="https://github.com/ludocode/mpack/releases">amalgamation package</a> and add <code>mpack.h</code> and <code>mpack.c</code> to your project.</p>
<p dir="auto">MPack supports all modern compilers, all desktop and smartphone OSes, WebAssembly, <a href="https://github.com/ludocode/mpack-linux-kernel">inside the Linux kernel</a>, and even 8-bit microcontrollers such as Arduino. The MPack featureset can be customized at compile-time to set which features, components and debug checks are compiled, and what dependencies are available.</p>
<h6 dir="auto">
<a id="user-content-build-status" class="anchor" aria-hidden="true" href="#build-status"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Build Status</h6>
<p dir="auto"><a href="https://github.com/ludocode/mpack/actions?query=workflow%3A%22Unit+Tests%22"><img src="https://github.com/ludocode/mpack/workflows/Unit%20Tests/badge.svg" alt="Unit Tests" style="max-width: 100%;"></a>
<a href="https://coveralls.io/github/ludocode/mpack?branch=develop" rel="nofollow"><img src="https://camo.githubusercontent.com/4a1c0a1b51e4bd997d9c4292acb068998af56c321a2ef3e1f3cd74fad9d56ded/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6c75646f636f64652f6d7061636b2f62616467652e7376673f6272616e63683d646576656c6f7026736572766963653d676974687562" alt="Coverage" data-canonical-src="https://coveralls.io/repos/ludocode/mpack/badge.svg?branch=develop&amp;service=github" style="max-width: 100%;"></a></p>
<h6 dir="auto">
<a id="user-content-the-node-api" class="anchor" aria-hidden="true" href="#the-node-api"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The Node API</h6>
<p dir="auto">The Node API parses a chunk of MessagePack data into an immutable tree of dynamically-typed nodes. A series of helper functions can be used to extract data of specific types from each node.</p>
<div class="highlight highlight-source-c position-relative overflow-auto" data-snippet-clipboard-copy-content='// parse a file into a node tree
mpack_tree_t tree;
mpack_tree_init_filename(&amp;tree, "homepage-example.mp", 0);
mpack_tree_parse(&amp;tree);
mpack_node_t root = mpack_tree_root(&amp;tree);

// extract the example data on the msgpack homepage
bool compact = mpack_node_bool(mpack_node_map_cstr(root, "compact"));
int schema = mpack_node_i32(mpack_node_map_cstr(root, "schema"));

// clean up and check for errors
if (mpack_tree_destroy(&amp;tree) != mpack_ok) {
    fprintf(stderr, "An error occurred decoding the data!\n");
    return;
}'><pre><span class="pl-c"><span class="pl-c">//</span> parse a file into a node tree</span>
<span class="pl-c1">mpack_tree_t</span> tree;
<span class="pl-en">mpack_tree_init_filename</span>(&amp;tree, <span class="pl-s"><span class="pl-pds">"</span>homepage-example.mp<span class="pl-pds">"</span></span>, <span class="pl-c1">0</span>);
<span class="pl-en">mpack_tree_parse</span>(&amp;tree);
<span class="pl-c1">mpack_node_t</span> root = mpack_tree_root(&amp;tree);

<span class="pl-c"><span class="pl-c">//</span> extract the example data on the msgpack homepage</span>
<span class="pl-k">bool</span> compact = mpack_node_bool(mpack_node_map_cstr(root, <span class="pl-s"><span class="pl-pds">"</span>compact<span class="pl-pds">"</span></span>));
<span class="pl-k">int</span> schema = mpack_node_i32(mpack_node_map_cstr(root, <span class="pl-s"><span class="pl-pds">"</span>schema<span class="pl-pds">"</span></span>));

<span class="pl-c"><span class="pl-c">//</span> clean up and check for errors</span>
<span class="pl-k">if</span> (mpack_tree_destroy(&amp;tree) != mpack_ok) {
    <span class="pl-c1">fprintf</span>(stderr, <span class="pl-s"><span class="pl-pds">"</span>An error occurred decoding the data!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-k">return</span>;
}</pre></div>
<p dir="auto">Note that no additional error handling is needed in the above code. If the file is missing or corrupt, if map keys are missing or if nodes are not in the expected types, special "nil" nodes and false/zero values are returned and the tree is placed in an error state. An error check is only needed before using the data.</p>
<p dir="auto">The above example allocates nodes automatically. A fixed node pool can be provided to the parser instead in memory-constrained environments. For maximum performance and minimal memory usage, the <a href="/ludocode/mpack/blob/develop/docs/expect.md">Expect API</a> can be used to parse data of a predefined schema.</p>
<h6 dir="auto">
<a id="user-content-the-write-api" class="anchor" aria-hidden="true" href="#the-write-api"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The Write API</h6>
<p dir="auto">The Write API encodes structured data to MessagePack.</p>
<div class="highlight highlight-source-c position-relative overflow-auto" data-snippet-clipboard-copy-content='// encode to memory buffer
char* data;
size_t size;
mpack_writer_t writer;
mpack_writer_init_growable(&amp;writer, &amp;data, &amp;size);

// write the example on the msgpack homepage
mpack_build_map(&amp;writer);
mpack_write_cstr(&amp;writer, "compact");
mpack_write_bool(&amp;writer, true);
mpack_write_cstr(&amp;writer, "schema");
mpack_write_uint(&amp;writer, 0);
mpack_complete_map(&amp;writer);

// finish writing
if (mpack_writer_destroy(&amp;writer) != mpack_ok) {
    fprintf(stderr, "An error occurred encoding the data!\n");
    return;
}

// use the data
do_something_with_data(data, size);
free(data);'><pre><span class="pl-c"><span class="pl-c">//</span> encode to memory buffer</span>
<span class="pl-k">char</span>* data;
<span class="pl-c1">size_t</span> size;
<span class="pl-c1">mpack_writer_t</span> writer;
<span class="pl-en">mpack_writer_init_growable</span>(&amp;writer, &amp;data, &amp;size);

<span class="pl-c"><span class="pl-c">//</span> write the example on the msgpack homepage</span>
<span class="pl-en">mpack_build_map</span>(&amp;writer);
<span class="pl-en">mpack_write_cstr</span>(&amp;writer, <span class="pl-s"><span class="pl-pds">"</span>compact<span class="pl-pds">"</span></span>);
<span class="pl-en">mpack_write_bool</span>(&amp;writer, <span class="pl-c1">true</span>);
<span class="pl-en">mpack_write_cstr</span>(&amp;writer, <span class="pl-s"><span class="pl-pds">"</span>schema<span class="pl-pds">"</span></span>);
<span class="pl-en">mpack_write_uint</span>(&amp;writer, <span class="pl-c1">0</span>);
<span class="pl-en">mpack_complete_map</span>(&amp;writer);

<span class="pl-c"><span class="pl-c">//</span> finish writing</span>
<span class="pl-k">if</span> (mpack_writer_destroy(&amp;writer) != mpack_ok) {
    <span class="pl-c1">fprintf</span>(stderr, <span class="pl-s"><span class="pl-pds">"</span>An error occurred encoding the data!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-k">return</span>;
}

<span class="pl-c"><span class="pl-c">//</span> use the data</span>
<span class="pl-en">do_something_with_data</span>(data, size);
<span class="pl-en">free</span>(data);</pre></div>
<p dir="auto">In the above example, we encode to a growable memory buffer. The writer can instead write to a pre-allocated or stack-allocated buffer (with up-front sizes for compound types), avoiding the need for memory allocation. The writer can also be provided with a flush function (such as a file or socket write function) to call when the buffer is full or when writing is done.</p>
<p dir="auto">If any error occurs, the writer is placed in an error state. The writer will flag an error if too much data is written, if the wrong number of elements are written, if an allocation failure occurs, if the data could not be flushed, etc. No additional error handling is needed in the above code; any subsequent writes are ignored when the writer is in an error state, so you don't need to check every write for errors.</p>
<p dir="auto">The above example uses <code>mpack_build_map()</code> to automatically determine the number of key-value pairs contained. If you know up-front the number of elements needed, you can pass it to <code>mpack_start_map()</code> instead. In that case the corresponding <code>mpack_finish_map()</code> will assert in debug mode that the expected number of elements were actually written, which is something that other MessagePack C/C++ libraries may not do.</p>
<h6 dir="auto">
<a id="user-content-comparison-with-other-parsers" class="anchor" aria-hidden="true" href="#comparison-with-other-parsers"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Comparison With Other Parsers</h6>
<p dir="auto">MPack is rich in features while maintaining very high performance and a small code footprint. Here's a short feature table comparing it to other C parsers:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="center">
<a href="https://github.com/ludocode/mpack">MPack</a><br>(v1.1)</th>
<th align="center">
<a href="https://github.com/msgpack/msgpack-c">msgpack-c</a><br>(v3.3.0)</th>
<th align="center">
<a href="https://github.com/camgunz/cmp">CMP</a><br>(v19)</th>
<th align="center">
<a href="https://github.com/clwi/CWPack">CWPack</a><br>(v1.3.1)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">No libc requirement</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">Growable memory writer</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">✓*</td>
</tr>
<tr>
<td align="left">File I/O helpers</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">✓*</td>
</tr>
<tr>
<td align="left">Stateful error handling</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">✓</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Incremental parser</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">Tree stream parser</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Compound size tracking</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Automatic compound size</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p dir="auto">A larger feature comparison table is available <a href="/ludocode/mpack/blob/develop/docs/features.md">here</a> which includes descriptions of the various entries in the table.</p>
<p dir="auto"><a href="https://github.com/ludocode/schemaless-benchmarks">This benchmarking suite</a> compares the performance of MPack to other implementations of schemaless serialization formats. MPack outperforms all JSON and MessagePack libraries (except <a href="https://github.com/clwi/CWPack">CWPack</a>), and in some tests MPack is several times faster than <a href="https://github.com/miloyip/rapidjson">RapidJSON</a> for equivalent data.</p>
<h6 dir="auto">
<a id="user-content-why-not-just-use-json" class="anchor" aria-hidden="true" href="#why-not-just-use-json"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Why Not Just Use JSON?</h6>
<p dir="auto">Conceptually, MessagePack stores data similarly to JSON: they are both composed of simple values such as numbers and strings, stored hierarchically in maps and arrays. So why not just use JSON instead? The main reason is that JSON is designed to be human-readable, so it is not as efficient as a binary serialization format:</p>
<ul dir="auto">
<li>
<p dir="auto">Compound types such as strings, maps and arrays are delimited, so appropriate storage cannot be allocated upfront. The whole object must be parsed to determine its size.</p>
</li>
<li>
<p dir="auto">Strings are not stored in their native encoding. Special characters such as quotes and backslashes must be escaped when written and converted back when read.</p>
</li>
<li>
<p dir="auto">Numbers are particularly inefficient (especially when parsing back floats), making JSON inappropriate as a base format for structured data that contains lots of numbers.</p>
</li>
<li>
<p dir="auto">Binary data is not supported by JSON at all. Small binary blobs such as icons and thumbnails need to be Base64 encoded or passed out-of-band.</p>
</li>
</ul>
<p dir="auto">The above issues greatly increase the complexity of the decoder. Full-featured JSON decoders are quite large, and minimal decoders tend to leave out such features as string unescaping and float parsing, instead leaving these up to the user or platform. This can lead to hard-to-find platform-specific and locale-specific bugs, as well as a greater potential for security vulnerabilites. This also significantly decreases performance, making JSON unattractive for use in applications such as mobile games.</p>
<p dir="auto">While the space inefficiencies of JSON can be partially mitigated through minification and compression, the performance inefficiencies cannot. More importantly, if you are minifying and compressing the data, then why use a human-readable format in the first place?</p>
<h6 dir="auto">
<a id="user-content-testing-mpack" class="anchor" aria-hidden="true" href="#testing-mpack"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Testing MPack</h6>
<p dir="auto">The MPack build process does not build MPack into a library; it is used to build and run the unit tests. You do not need to build MPack or the unit testing suite to use MPack.</p>
<p dir="auto">See <a href="/ludocode/mpack/blob/develop/test/README.md">test/README.md</a> for information on how to test MPack.</p>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-cli" class="qs"><h4><a href="https://github.com/msgpack/msgpack-cli" target="_blank">msgpack/msgpack-cli <span class="qs-url">https://github.com/msgpack/msgpack-cli</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-cli" class="anchor" aria-hidden="true" href="#messagepack-for-cli"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for CLI</h5>
<h6 dir="auto">
<a id="user-content-ci-status" class="anchor" aria-hidden="true" href="#ci-status"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CI Status</h6>
<table>
<thead>
<tr>
<th align="left"><strong>Configuration</strong></th>
<th align="left"><strong>Status</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Release</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli-x2p85" rel="nofollow"><img src="https://camo.githubusercontent.com/c094c78f781d275e66e4bcf1b3a5b4461311e50af6ca64a5a5b50570f209238a/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f356c6e3775376566776a65706a366f383f7376673d74727565" alt="Build status release" data-canonical-src="https://ci.appveyor.com/api/projects/status/5ln7u7efwjepj6o8?svg=true" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="left">Debug (.NET Core 2.0)</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli" rel="nofollow"><img src="https://camo.githubusercontent.com/ac845f5c56a1effcf270487b700d75bc995170666470ebc1c6060dd715fe5592/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f646c6330763472726f6c776a307432743f7376673d74727565" alt="Build status debug (.NET Core 2.0)" data-canonical-src="https://ci.appveyor.com/api/projects/status/dlc0v4rrolwj0t2t?svg=true" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="left">Debug (.NET Core 2.0)</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli-g3guk" rel="nofollow"><img src="https://camo.githubusercontent.com/b02194b48999915ae0ef1d033f90fa1c2a447d5579be2e869a3ceb7398c038e2/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6176757266353139616c6c39327635753f7376673d74727565" alt="Build status debug (.NET Core 1.0)" data-canonical-src="https://ci.appveyor.com/api/projects/status/avurf519all92v5u?svg=true" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="left">Debug (.NET Framework 4.x)</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli-nuf62" rel="nofollow"><img src="https://camo.githubusercontent.com/d83df61fdffa740eccba9ee80fc9152a32ccc670583d94d36f4e45eeeb3eb0f0/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6e703637323371327569716f667231613f7376673d74727565" alt="Build status debug (.NET Framework 4.x)" data-canonical-src="https://ci.appveyor.com/api/projects/status/np6723q2uiqofr1a?svg=true" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="left">Debug (Code DOM)]</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli-rhnh0" rel="nofollow"><img src="https://camo.githubusercontent.com/084355257ef0e748954540e86ee0eef5949d4f65aa8da2015ff4e9f04a7af999/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f316d773738776b787835306a766162313f7376673d74727565" alt="Build status debug (Code DOM)" data-canonical-src="https://ci.appveyor.com/api/projects/status/1mw78wkxx50jvab1?svg=true" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="left">Debug (miscs)]</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli-bo856" rel="nofollow"><img src="https://camo.githubusercontent.com/4124c4e43b458aba2260d3b6b6f07aff6b9d7c64e13e47de4ac4ee355f4eb705/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f61767566633531797532636d366964773f7376673d74727565" alt="Build status debug (miscs)" data-canonical-src="https://ci.appveyor.com/api/projects/status/avufc51yu2cm6idw?svg=true" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="left">Debug (.NET Framework 3.5)</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli-3jme9" rel="nofollow"><img src="https://camo.githubusercontent.com/6bb8bdcb4d9994172b1505cbb39f31dfc64a86f127ddaca42d20db13ba51a870/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f636a703870686c6e62776a37676b6a393f7376673d74727565" alt="Build status debug (.NET Framework 3.5)" data-canonical-src="https://ci.appveyor.com/api/projects/status/cjp8phlnbwj7gkj9?svg=true" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="left">Debug (.NET Framework 3.5 Code DOM)</td>
<td align="left"><a href="https://ci.appveyor.com/project/yfakariya/msgpack-cli-rhnh0" rel="nofollow"><img src="https://camo.githubusercontent.com/084355257ef0e748954540e86ee0eef5949d4f65aa8da2015ff4e9f04a7af999/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f316d773738776b787835306a766162313f7376673d74727565" alt="Build status debug (.NET Framework 3.5 Code DOM)" data-canonical-src="https://ci.appveyor.com/api/projects/status/1mw78wkxx50jvab1?svg=true" style="max-width: 100%;"></a></td>
</tr>
</tbody>
</table>
<h6 dir="auto">
<a id="user-content-what-is-it" class="anchor" aria-hidden="true" href="#what-is-it"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What is it?</h6>
<p dir="auto">This is MessagePack serialization/deserialization for CLI (Common Language Infrastructure) implementations such as .NET Framework, Silverlight, Mono (including Moonlight.)
This library can be used from ALL CLS compliant languages such as C#, F#, Visual Basic, Iron Python, Iron Ruby, PowerShell, C++/CLI or so.</p>
<h6 dir="auto">
<a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h6>
<p dir="auto">You can serialize/deserialize objects as following:</p>
<ol dir="auto">
<li>Create serializer via <code>MessagePackSerializer.Get</code> generic method. This method creates dependent types serializers as well.</li>
<li>Invoke serializer as following:</li>
</ol>
<ul dir="auto">
<li>
<code>Pack</code> method with destination <code>Stream</code> and target object for serialization.</li>
<li>
<code>Unpack</code> method with source <code>Stream</code>.</li>
</ul>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// Creates serializer.
var serializer = MessagePackSerializer.Get&lt;T&gt;();
// Pack obj to stream.
serializer.Pack(stream, obj);
// Unpack from stream.
var unpackedObject = serializer.Unpack(stream);"><pre><span class="pl-c"><span class="pl-c">//</span> Creates serializer.</span>
<span class="pl-k">var</span> <span class="pl-en">serializer</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Get</span>&lt;<span class="pl-en">T</span>&gt;();
<span class="pl-c"><span class="pl-c">//</span> Pack obj to stream.</span>
<span class="pl-smi">serializer</span>.<span class="pl-en">Pack</span>(<span class="pl-smi">stream</span>, <span class="pl-smi">obj</span>);
<span class="pl-c"><span class="pl-c">//</span> Unpack from stream.</span>
<span class="pl-k">var</span> <span class="pl-en">unpackedObject</span> <span class="pl-k">=</span> <span class="pl-smi">serializer</span>.<span class="pl-en">Unpack</span>(<span class="pl-smi">stream</span>);</pre></div>
<div class="highlight highlight-source-vbnet position-relative overflow-auto" data-snippet-clipboard-copy-content="' Creates serializer.
Dim serializer = MessagePackSerializer.Get(Of T)()
' Pack obj to stream.
serializer.Pack(stream, obj)
' Unpack from stream.
Dim unpackedObject = serializer.Unpack(stream)"><pre><span class="pl-c">' Creates serializer.</span>
<span class="pl-k">Dim</span> <span class="pl-smi">serializer</span> <span class="pl-smi">=</span> <span class="pl-smi">MessagePackSerializer.Get(</span><span class="pl-k">Of</span> <span class="pl-smi">T)()</span>
<span class="pl-c">' Pack obj to stream.</span>
<span class="pl-smi">serializer.Pack(stream,</span> <span class="pl-smi">obj)</span>
<span class="pl-c">' Unpack from stream.</span>
<span class="pl-k">Dim</span> <span class="pl-smi">unpackedObject</span> <span class="pl-smi">=</span> <span class="pl-smi">serializer.Unpack(stream)</span></pre></div>
<p dir="auto"><strong>For production environment, you should instantiate own <code>SerializationContext</code> and manage its lifetime. It is good idea to treat it as singleton because <code>SerializationContext</code> is thread-safe.</strong></p>
<h6 dir="auto">
<a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h6>
<ul dir="auto">
<li>Fast and interoperable binary format serialization with simple API.</li>
<li>Generating pre-compiled assembly for rapid start up.</li>
<li>Flexible MessagePackObject which represents MessagePack type system naturally.</li>
</ul>
<p dir="auto"><strong>Note: AOT support is limited yet. Use <a href="https://github.com/msgpack/msgpack-cli/wiki/Xamarin-and-Unity">serializer pre-generation</a> with <code>mpu -s</code> utility or API.</strong><br>
If you do not pre-generated serializers, MsgPack for CLI uses reflection in AOT environments, it is slower and it sometimes causes AOT related error (<code>ExecutionEngineException</code> for runtime JIT compilation). <strong>You also have to call <code>MessagePackSerializer.PrepareType&lt;T&gt;</code> and companions in advance to avoid AOT related error.</strong> See <a href="https://github.com/msgpack/msgpack-cli/wiki/Xamarin-and-Unity">wiki</a> for details.</p>
<h6 dir="auto">
<a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Documentation</h6>
<p dir="auto">See <a href="https://github.com/msgpack/msgpack-cli/wiki">wiki</a></p>
<h6 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h6>
<ul dir="auto">
<li>Binary files distributed via the NuGet package <a href="http://www.nuget.org/packages/MsgPack.Cli/" rel="nofollow">MsgPack.Cli</a>.</li>
<li>You can extract binary (DLL) file as following:
<ol dir="auto">
<li>Download *.zip file from <a href="https://github.com/msgpack/msgpack-cli/releases/">GitHub Release page</a>.</li>
<li>Extract it.</li>
<li>Under the <code>bin</code> directory, binaries are there!</li>
</ol>
<ul dir="auto">
<li>For mono, you can use <code>net461</code> or <code>net35</code> drops as you run with.</li>
<li>For Unity, <code>unity3d</code> drop is suitable.</li>
</ul>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-how-to-build" class="anchor" aria-hidden="true" href="#how-to-build"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to build</h6>
<h7 dir="auto">
<a id="user-content-for-net-framework" class="anchor" aria-hidden="true" href="#for-net-framework"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>For .NET Framework</h7>
<ol dir="auto">
<li>
<p dir="auto">Install Visual Studio 2017 (Community edition is OK) and 2015 (for MsgPack.Windows.sln).</p>
<ul dir="auto">
<li>You must install .NET Framework 3.5, 4.x, .NET Core, and Xamarin dev tools to build all builds successfully.
If you do not want to install options, edit <code>&lt;TargetFrameworks&gt;</code> element in <code>*.csproj</code> files to exclude platforms you want to exclude.</li>
</ul>
</li>
<li>
<p dir="auto">Install latest .NET Core SDK.</p>
</li>
<li>
<p dir="auto">Run with Visual Studio Developer Command Prompt:</p>
<p dir="auto">msbuild MsgPack.sln /t:Restore
msbuild MsgPack.sln</p>
</li>
</ol>
<p dir="auto">Or (for Unity 3D drops):</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="msbuild MsgPack.compats.sln /t:Restore
msbuild MsgPack.compats.sln"><pre><code>msbuild MsgPack.compats.sln /t:Restore
msbuild MsgPack.compats.sln
</code></pre></div>
<p dir="auto">Or (for Windows Runtime/Phone drops and Silverlight 5 drops):</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="msbuild MsgPack.Windows.sln /t:Restore
msbuild MsgPack.Windows.sln"><pre><code>msbuild MsgPack.Windows.sln /t:Restore
msbuild MsgPack.Windows.sln
</code></pre></div>
<p dir="auto">Or (for Xamarin unit testing, you must have Xamarin Business or upper license and Mac machine on the LAN to build on Windows):</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="msbuild MsgPack.Xamarin.sln /t:Restore
msbuild MsgPack.Xamarin.sln"><pre><code>msbuild MsgPack.Xamarin.sln /t:Restore
msbuild MsgPack.Xamarin.sln
</code></pre></div>
<p dir="auto">Or open one of above solution files in your IDE and run build command in it.</p>
<h7 dir="auto">
<a id="user-content-for-mono" class="anchor" aria-hidden="true" href="#for-mono"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>For Mono</h7>
<ol dir="auto">
<li>Install latest Mono and .NET Core SDK.</li>
<li>Now, you can build MsgPack.sln and MsgPack.Xamarin.sln with above instructions and <code>msbuild</code> in latest Mono. Note that <code>xbuild</code> does not work because it does not support latest csproj format.</li>
</ol>
<h7 dir="auto">
<a id="user-content-own-unity-3d-build" class="anchor" aria-hidden="true" href="#own-unity-3d-build"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Own Unity 3D Build</h7>
<p dir="auto">First of all, there are binary drops on github release page, you should use it to save your time.<br>
Because we will not guarantee source code organization compatibilities, we might add/remove non-public types or members, which should break source code build.<br>
If you want to import sources, you must include just only described on MsgPack.Unity3D.csproj.<br>
If you want to use ".NET 2.0 Subset" settings, you must use just only described on MsgPack.Unity3D.CorLibOnly.csproj file, and define <code>CORLIB_ONLY</code> compiler constants.</p>
<h7 dir="auto">
<a id="user-content-xamarin-android-testing" class="anchor" aria-hidden="true" href="#xamarin-android-testing"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Xamarin Android testing</h7>
<p dir="auto">If you run on Windows, it is recommended to use HXM instead of Hyper-V based emulator.<br>
You can disable Hyper-V from priviledged (administrator) powershell as follows:</p>
<div class="highlight highlight-source-powershell position-relative overflow-auto" data-snippet-clipboard-copy-content="Disable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-Hypervisor"><pre><span class="pl-c1">Disable-WindowsOptionalFeature</span> <span class="pl-k">-</span>Online <span class="pl-k">-</span>FeatureName Microsoft<span class="pl-k">-</span>Hyper<span class="pl-k">-</span>V<span class="pl-k">-</span>Hypervisor</pre></div>
<p dir="auto">If you want to use Hyper-V again (such as for Docker for Windows etc.), you can do it by following in priviledged (administrator) powershell:</p>
<div class="highlight highlight-source-powershell position-relative overflow-auto" data-snippet-clipboard-copy-content="Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-Hypervisor"><pre><span class="pl-c1">Enable-WindowsOptionalFeature</span> <span class="pl-k">-</span>Online <span class="pl-k">-</span>FeatureName Microsoft<span class="pl-k">-</span>Hyper<span class="pl-k">-</span>V<span class="pl-k">-</span>Hypervisor</pre></div>
<h8 dir="auto">
<a id="user-content-xamarin-android-trouble-shooting-tips" class="anchor" aria-hidden="true" href="#xamarin-android-trouble-shooting-tips"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Xamarin Android Trouble shooting tips</h8>
<ul dir="auto">
<li>
<strong>Q:</strong> Javac shows compilation error.
<ul dir="auto">
<li>
<strong>A:</strong> Rebuild the test project and try it run again.</li>
</ul>
</li>
</ul>
<h7 dir="auto">
<a id="user-content-xamarin-ios-testing" class="anchor" aria-hidden="true" href="#xamarin-ios-testing"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Xamarin iOS testing</h7>
<p dir="auto">You must create provisoning profiles in your MacOS devices.<br>
See <a href="https://developer.xamarin.com/guides/ios/getting_started/installation/device_provisioning/free-provisioning/" rel="nofollow">Xamarin documents about provisining</a> for details.</p>
<p dir="auto">There are bundle IDs of current iOS tests:</p>
<ul dir="auto">
<li><code>org.msgpack.msgpack-cli-xamarin-ios-test</code></li>
<li><code>org.msgpack.msgpack-cli-xamarin-ios-test-packer</code></li>
<li><code>org.msgpack.msgpack-cli-xamarin-ios-test-unpacker</code></li>
<li><code>org.msgpack.msgpack-cli-xamarin-ios-test-unpacking</code></li>
<li><code>org.msgpack.msgpack-cli-xamarin-ios-test-timestamp</code></li>
<li><code>org.msgpack.msgpack-cli-xamarin-ios-test-arrayserialization</code></li>
<li><code>org.msgpack.msgpack-cli-xamarin-ios-test-mapserialization</code></li>
</ul>
<p dir="auto"><em>Note that some reflection based serializer tests failed with AOT related limitation.</em></p>
<h8 dir="auto">
<a id="user-content-xamarin-ios-trouble-shooting-tips" class="anchor" aria-hidden="true" href="#xamarin-ios-trouble-shooting-tips"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Xamarin iOS Trouble shooting tips</h8>
<p dir="auto">See <a href="https://developer.xamarin.com/guides/ios/getting_started/installation/windows/connecting-to-mac/troubleshooting/" rel="nofollow">Xamarin's official trouble shooting docs first.</a></p>
<ul dir="auto">
<li>
<strong>Q:</strong> An error occurred while running unit test project.
<ul dir="auto">
<li>
<strong>A:</strong> Rebuild the project and rerun it. Or, login your Mac again, ant retry it.</li>
</ul>
</li>
<li>
<strong>Q:</strong> It is hard to read English.
<ul dir="auto">
<li>
<strong>A:</strong> You can read localized Xamarin docs with putting <code>{region}-{lang}</code> as the first component of URL path such as <code>https://developer.xamarin.com/ja-jp/guides/...</code>.</li>
</ul>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-maintenance" class="anchor" aria-hidden="true" href="#maintenance"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Maintenance</h6>
<h7 dir="auto">
<a id="user-content-msgpackwindowssln" class="anchor" aria-hidden="true" href="#msgpackwindowssln"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MsgPack.Windows.sln</h7>
<p dir="auto">This solution contains Silverlight5 and (old) UWP project for backward compability. They are required Visual Studio 2015 to build and test.<br>
You can download Visual Studio 2015 community edition from <a href="https://visualstudio.microsoft.com/vs/older-downloads/" rel="nofollow">here</a>.</p>
<p dir="auto"><strong>You do not have to install Visual Studio 2015 as long as you don't edit/test/build Silverlight and/or old UWP project.</strong></p>
<h6 dir="auto">
<a id="user-content-see-also" class="anchor" aria-hidden="true" href="#see-also"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>See also</h6>
<ul dir="auto">
<li>GitHub Page           : <a href="http://cli.msgpack.org/" rel="nofollow">http://cli.msgpack.org/</a>
</li>
<li>Wiki (documentation)  : <a href="https://github.com/msgpack/msgpack-cli/wiki">https://github.com/msgpack/msgpack-cli/wiki</a>
</li>
<li>API Reference         : <a href="http://cli.msgpack.org/doc/top.html" rel="nofollow">http://cli.msgpack.org/doc/top.html</a>
</li>
<li>Issue tracker         : <a href="https://github.com/msgpack/msgpack-cli/issues">https://github.com/msgpack/msgpack-cli/issues</a>
</li>
<li>MSBuild reference     : <a href="http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx</a>
</li>
<li>Mono xbuild reference : <a href="http://www.mono-project.com/Microsoft.Build" rel="nofollow">http://www.mono-project.com/Microsoft.Build</a>
</li>
</ul>
</article>
  </div>
        </div>
        
        <div id="qs-neuecc-MessagePack-CSharp" class="qs"><h4><a href="https://github.com/neuecc/MessagePack-CSharp" target="_blank">neuecc/MessagePack-CSharp <span class="qs-url">https://github.com/neuecc/MessagePack-CSharp</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-c-net-net-core-unity-xamarin" class="anchor" aria-hidden="true" href="#messagepack-for-c-net-net-core-unity-xamarin"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for C# (.NET, .NET Core, Unity, Xamarin)</h5>
<p dir="auto"><a href="https://www.nuget.org/packages/messagepack" rel="nofollow"><img src="https://camo.githubusercontent.com/1c23b2be0af974240454f6c0f3d73c0708153ee89fdd1ccad72769e7101f34e9/68747470733a2f2f696d672e736869656c64732e696f2f6e756765742f762f4d6573736167655061636b2e737667" alt="NuGet" data-canonical-src="https://img.shields.io/nuget/v/MessagePack.svg" style="max-width: 100%;"></a>
<a href="https://www.nuget.org/packages/messagepack" rel="nofollow"><img src="https://camo.githubusercontent.com/2786a378b266636d02024525d7622f1e8ad1047700aa2cf9fe37504e0f7ad7b2/68747470733a2f2f696d672e736869656c64732e696f2f6e756765742f767072652f4d6573736167655061636b2e737667" alt="NuGet" data-canonical-src="https://img.shields.io/nuget/vpre/MessagePack.svg" style="max-width: 100%;"></a>
<a href="https://github.com/neuecc/MessagePack-CSharp/releases"><img src="https://camo.githubusercontent.com/f13073faf2f1060237fa58c7e520574b59718381960e3259b004d54c1a40d25c/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f6e65756563632f4d6573736167655061636b2d4353686172702e737667" alt="Releases" data-canonical-src="https://img.shields.io/github/release/neuecc/MessagePack-CSharp.svg" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://gitter.im/MessagePack-CSharp/Lobby?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" rel="nofollow"><img src="https://camo.githubusercontent.com/3eee9a2b0fc8f28042e9a3767aa94d0c447b603963aefda78479c2c075126895/68747470733a2f2f6261646765732e6769747465722e696d2f4d6573736167655061636b2d4353686172702f4c6f6262792e737667" alt="Join the chat at https://gitter.im/MessagePack-CSharp/Lobby" data-canonical-src="https://badges.gitter.im/MessagePack-CSharp/Lobby.svg" style="max-width: 100%;"></a>
<a href="https://dev.azure.com/ils0086/MessagePack-CSharp/_build/latest?definitionId=2&amp;branchName=master" rel="nofollow"><img src="https://camo.githubusercontent.com/1f2c4fbbd9171a947757dcf04b95bd3724b6c74d791882ad6cf4141078a03a8e/68747470733a2f2f6465762e617a7572652e636f6d2f696c73303038362f4d6573736167655061636b2d4353686172702f5f617069732f6275696c642f7374617475732f4d6573736167655061636b2d4353686172702d43493f6272616e63684e616d653d6d6173746572" alt="Build Status" data-canonical-src="https://dev.azure.com/ils0086/MessagePack-CSharp/_apis/build/status/MessagePack-CSharp-CI?branchName=master" style="max-width: 100%;"></a></p>
<p dir="auto">The extremely fast <a href="http://msgpack.org/" rel="nofollow">MessagePack</a> serializer for C#.
It is 10x faster than <a href="https://github.com/msgpack/msgpack-cli">MsgPack-Cli</a> and outperforms other C# serializers. MessagePack for C# also ships with built-in support for LZ4 compression - an extremely fast compression algorithm. Performance is important, particularly in applications like games, distributed computing, microservices, or data caches.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/46207/23835716/89c8ab08-07af-11e7-9183-9e9415bdc87f.png"><img src="https://cloud.githubusercontent.com/assets/46207/23835716/89c8ab08-07af-11e7-9183-9e9415bdc87f.png" alt="Perf comparison graph" style="max-width: 100%;"></a></p>
<p dir="auto">MessagePack has a compact binary size and a full set of general purpose expressive data types. Please have a look at the <a href="#comparison">comparison with JSON, protobuf, ZeroFormatter section</a> and learn <a href="#performance">why MessagePack C# is the fastest</a>.</p>
<h6 dir="auto">
<a id="user-content-table-of-contents" class="anchor" aria-hidden="true" href="#table-of-contents"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Table of Contents</h6>
<ul dir="auto">
<li>
<a href="#installation">Installation</a>
<ul dir="auto">
<li><a href="#nuget-packages">NuGet packages</a></li>
<li><a href="#unity">Unity</a></li>
<li><a href="#migration-notes-from-v1x">Migration notes from v1.x</a></li>
</ul>
</li>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#analyzer">Analyzer</a></li>
<li><a href="#built-in-supported-types">Built-in supported types</a></li>
<li><a href="#object-serialization">Object Serialization</a></li>
<li><a href="#datacontract-compatibility">DataContract compatibility</a></li>
<li><a href="#serializing-readonlyimmutable-object-members--serializationconstructor">Serializing readonly/immutable object members  (SerializationConstructor)</a></li>
<li><a href="#serialization-callback">Serialization Callback</a></li>
<li><a href="#union">Union</a></li>
<li><a href="#dynamic-untyped-deserialization">Dynamic (Untyped) Deserialization</a></li>
<li><a href="#object-type-serialization">Object Type Serialization</a></li>
<li><a href="#typeless">Typeless</a></li>
<li><a href="#security">Security</a></li>
<li>
<a href="#performance">Performance</a>
<ul dir="auto">
<li><a href="#deserialization-performance-for-different-options">Deserialization Performance for different options</a></li>
</ul>
</li>
<li>
<a href="#lz4-compression">LZ4 Compression</a>
<ul dir="auto">
<li><a href="#attributions">Attributions</a></li>
</ul>
</li>
<li><a href="#comparison-with-protobuf-json-zeroformatter">Comparison with protobuf, JSON, ZeroFormatter</a></li>
<li>
<a href="#hints-to-achieve-maximum-performance-when-using-messagepack-for-c">Hints to achieve maximum performance when using MessagePack for C#</a>
<ul dir="auto">
<li><a href="#use-indexed-keys-instead-of-string-keys-contractless">Use indexed keys instead of string keys (Contractless)</a></li>
<li><a href="#create-own-custom-composite-resolver">Create own custom composite resolver</a></li>
<li><a href="#use-native-resolvers">Use native resolvers</a></li>
<li><a href="#be-careful-when-copying-buffers">Be careful when copying buffers</a></li>
<li><a href="#choosing-compression">Choosing compression</a></li>
</ul>
</li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#experimental-features">Experimental Features</a></li>
<li>
<a href="#high-level-api-messagepackserializer">High-Level API (<code>MessagePackSerializer</code>)</a>
<ul dir="auto">
<li><a href="#multiple-messagepack-structures-on-a-single-stream">Multiple MessagePack structures on a single <code>Stream</code></a></li>
</ul>
</li>
<li><a href="#low-level-api-imessagepackformattert">Low-Level API (<code>IMessagePackFormatter&lt;T&gt;</code>)</a></li>
<li>
<a href="#primitive-api-messagepackwriter-messagepackreader">Primitive API (<code>MessagePackWriter</code>, <code>MessagePackReader</code>)</a>
<ul dir="auto">
<li><a href="#messagepackreader"><code>MessagePackReader</code></a></li>
<li><a href="#messagepackwriter"><code>MessagePackWriter</code></a></li>
</ul>
</li>
<li><a href="#main-extension-point-iformatterresolver">Main Extension Point (<code>IFormatterResolver</code>)</a></li>
<li><a href="#messagepackformatterattribute">MessagePackFormatterAttribute</a></li>
<li><a href="#ignoreformatter">IgnoreFormatter</a></li>
<li><a href="#reserved-extension-types">Reserved Extension Types</a></li>
<li><a href="#unity-support">Unity support</a></li>
<li><a href="#aot-code-generation-support-for-unityxamarin">AOT Code Generation (support for Unity/Xamarin)</a></li>
<li>
<a href="#rpc">RPC</a>
<ul dir="auto">
<li><a href="#magiconion">MagicOnion</a></li>
<li><a href="#streamjsonrpc">StreamJsonRpc</a></li>
</ul>
</li>
<li><a href="#how-to-build">How to build</a></li>
<li><a href="#author-info">Author Info</a></li>
</ul>
<h6 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h6>
<p dir="auto">This library is distributed via NuGet. Special <a href="#unity">Unity support</a> is available, too.</p>
<p dir="auto">We target .NET Standard 2.0 with special optimizations for .NET Core 2.1+, making it compatible with most reasonably recent .NET runtimes such as Core 2.0 and later, Framework 4.6.1 and later, Mono 5.4 and later and Unity 2018.3 and later.
The library code is pure C# (with Just-In-Time IL code generation on some platforms).</p>
<h7 dir="auto">
<a id="user-content-nuget-packages" class="anchor" aria-hidden="true" href="#nuget-packages"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>NuGet packages</h7>
<p dir="auto">To install with NuGet, just install the <code>MessagePack</code> package:</p>
<div class="highlight highlight-source-powershell position-relative overflow-auto" data-snippet-clipboard-copy-content="Install-Package MessagePack"><pre><span class="pl-c1">Install-Package</span> MessagePack</pre></div>
<p dir="auto">Install the optional C# <a href="/neuecc/MessagePack-CSharp/blob/master/doc/analyzers/index.md">analyzers</a> package to get warnings about coding mistakes and automatic fix suggestions to save you time:</p>
<div class="highlight highlight-source-powershell position-relative overflow-auto" data-snippet-clipboard-copy-content="Install-Package MessagePackAnalyzer"><pre><span class="pl-c1">Install-Package</span> MessagePackAnalyzer</pre></div>
<p dir="auto">There are also a range of official and third party Extension Packages available (learn more in our <a href="#extensions">extensions section</a>):</p>
<div class="highlight highlight-source-powershell position-relative overflow-auto" data-snippet-clipboard-copy-content="Install-Package MessagePack.ReactiveProperty
Install-Package MessagePack.UnityShims
Install-Package MessagePack.AspNetCoreMvcFormatter"><pre><span class="pl-c1">Install-Package</span> MessagePack.ReactiveProperty
<span class="pl-c1">Install-Package</span> MessagePack.UnityShims
<span class="pl-c1">Install-Package</span> MessagePack.AspNetCoreMvcFormatter</pre></div>
<h7 dir="auto">
<a id="user-content-unity" class="anchor" aria-hidden="true" href="#unity"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Unity</h7>
<p dir="auto">For Unity projects, the <a href="https://github.com/neuecc/MessagePack-CSharp/releases">releases</a> page provides downloadable <code>.unitypackage</code> files. When using in Unity IL2CPP or Xamarin AOT environments, please carefully read the <a href="#aot">pre-code generation section</a>.</p>
<h7 dir="auto">
<a id="user-content-migration-notes-from-v1x" class="anchor" aria-hidden="true" href="#migration-notes-from-v1x"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Migration notes from v1.x</h7>
<p dir="auto">If you were using MessagePack for C# v1.x, check out the <a href="/neuecc/MessagePack-CSharp/blob/master/doc/migration.md">"How to update to our new v2.x version"</a> document.</p>
<h6 dir="auto">
<a id="user-content-quick-start" class="anchor" aria-hidden="true" href="#quick-start"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quick Start</h6>
<p dir="auto">Define the struct or class to be serialized and annotate it with a <code>[MessagePackObject]</code> attribute.
Annotate members whose values should be serialized (fields as well as properties) with <code>[Key]</code> attributes.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[MessagePackObject]
public class MyClass
{
    // Key attributes take a serialization index (or string name)
    // The values must be unique and versioning has to be considered as well.
    // Keys are described in later sections in more detail.
    [Key(0)]
    public int Age { get; set; }

    [Key(1)]
    public string FirstName { get; set; }

    [Key(2)]
    public string LastName { get; set; }

    // All fields or properties that should not be serialized must be annotated with [IgnoreMember].
    [IgnoreMember]
    public string FullName { get { return FirstName + LastName; } }
}"><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">MyClass</span>
{
    <span class="pl-c"><span class="pl-c">//</span> Key attributes take a serialization index (or string name)</span>
    <span class="pl-c"><span class="pl-c">//</span> The values must be unique and versioning has to be considered as well.</span>
    <span class="pl-c"><span class="pl-c">//</span> Keys are described in later sections in more detail.</span>
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Age</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }

    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">string</span> <span class="pl-en">FirstName</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }

    [<span class="pl-en">Key</span>(<span class="pl-c1">2</span>)]
    <span class="pl-k">public</span> <span class="pl-k">string</span> <span class="pl-en">LastName</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }

    <span class="pl-c"><span class="pl-c">//</span> All fields or properties that should not be serialized must be annotated with [IgnoreMember].</span>
    [<span class="pl-en">IgnoreMember</span>]
    <span class="pl-k">public</span> <span class="pl-k">string</span> <span class="pl-en">FullName</span> { <span class="pl-k">get</span> { <span class="pl-k">return</span> <span class="pl-smi">FirstName</span> <span class="pl-k">+</span> <span class="pl-smi">LastName</span>; } }
}</pre></div>
<p dir="auto">Call <code>MessagePackSerializer.Serialize&lt;T&gt;/Deserialize&lt;T&gt;</code> to serialize/deserialize your object instance.
You can use the <code>ConvertToJson</code> method to get a human readable representation of any MessagePack binary blob.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="class Program
{
    static void Main(string[] args)
    {
        var mc = new MyClass
        {
            Age = 99,
            FirstName = &quot;hoge&quot;,
            LastName = &quot;huga&quot;,
        };

        // Call Serialize/Deserialize, that's all.
        byte[] bytes = MessagePackSerializer.Serialize(mc);
        MyClass mc2 = MessagePackSerializer.Deserialize&lt;MyClass&gt;(bytes);

        // You can dump MessagePack binary blobs to human readable json.
        // Using indexed keys (as opposed to string keys) will serialize to MessagePack arrays,
        // hence property names are not available.
        // [99,&quot;hoge&quot;,&quot;huga&quot;]
        var json = MessagePackSerializer.ConvertToJson(bytes);
        Console.WriteLine(json);
    }
}"><pre><span class="pl-k">class</span> <span class="pl-en">Program</span>
{
    <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">Main</span>(<span class="pl-k">string</span>[] <span class="pl-en">args</span>)
    {
        <span class="pl-k">var</span> <span class="pl-en">mc</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">MyClass</span>
        {
            <span class="pl-smi">Age</span> <span class="pl-k">=</span> <span class="pl-c1">99</span>,
            <span class="pl-smi">FirstName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>hoge<span class="pl-pds">"</span></span>,
            <span class="pl-smi">LastName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>huga<span class="pl-pds">"</span></span>,
        };

        <span class="pl-c"><span class="pl-c">//</span> Call Serialize/Deserialize, that's all.</span>
        <span class="pl-k">byte</span>[] <span class="pl-en">bytes</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">mc</span>);
        <span class="pl-en">MyClass</span> <span class="pl-en">mc2</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">MyClass</span>&gt;(<span class="pl-smi">bytes</span>);

        <span class="pl-c"><span class="pl-c">//</span> You can dump MessagePack binary blobs to human readable json.</span>
        <span class="pl-c"><span class="pl-c">//</span> Using indexed keys (as opposed to string keys) will serialize to MessagePack arrays,</span>
        <span class="pl-c"><span class="pl-c">//</span> hence property names are not available.</span>
        <span class="pl-c"><span class="pl-c">//</span> [99,"hoge","huga"]</span>
        <span class="pl-k">var</span> <span class="pl-en">json</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">ConvertToJson</span>(<span class="pl-smi">bytes</span>);
        <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">json</span>);
    }
}</pre></div>
<p dir="auto">By default, a <code>MessagePackObject</code> annotation is required. This can be made optional; see the <a href="#object-serialization">Object Serialization section</a> and the <a href="#resolvers">Formatter Resolver section</a> for details.</p>
<h6 dir="auto">
<a id="user-content-analyzer" class="anchor" aria-hidden="true" href="#analyzer"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Analyzer</h6>
<p dir="auto">The MessagePackAnalyzer package aids with:</p>
<ol dir="auto">
<li>Automating definitions for your serializable objects.</li>
<li>Produces compiler warnings upon incorrect attribute use, member accessibility, and more.</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/46207/23837445/ce734eae-07cb-11e7-9758-d69f0f095bc1.gif"><img src="https://cloud.githubusercontent.com/assets/46207/23837445/ce734eae-07cb-11e7-9758-d69f0f095bc1.gif" alt="analyzergif" style="max-width: 100%;"></a></p>
<p dir="auto">If you want to allow a specific custom type (for example, when registering a custom type), put <code>MessagePackAnalyzer.json</code> at the project root and change the Build Action to <code>AdditionalFiles</code>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/46207/23837427/8a8d507c-07cb-11e7-9277-5a566eb0bfde.png"><img src="https://cloud.githubusercontent.com/assets/46207/23837427/8a8d507c-07cb-11e7-9277-5a566eb0bfde.png" alt="image" style="max-width: 100%;"></a></p>
<p dir="auto">An example <code>MessagePackAnalyzer.json</code>:</p>
<div class="highlight highlight-source-json position-relative overflow-auto" data-snippet-clipboard-copy-content='[ "MyNamespace.FooClass", "MyNameSpace.BarStruct" ]'><pre>[ <span class="pl-s"><span class="pl-pds">"</span>MyNamespace.FooClass<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>MyNameSpace.BarStruct<span class="pl-pds">"</span> </span>]</pre></div>
<h6 dir="auto">
<a id="user-content-built-in-supported-types" class="anchor" aria-hidden="true" href="#built-in-supported-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Built-in supported types</h6>
<p dir="auto">These types can serialize by default:</p>
<ul dir="auto">
<li>Primitives (<code>int</code>, <code>string</code>, etc...), <code>Enum</code>s, <code>Nullable&lt;&gt;</code>, <code>Lazy&lt;&gt;</code>
</li>
<li>
<code>TimeSpan</code>,  <code>DateTime</code>, <code>DateTimeOffset</code>
</li>
<li>
<code>Guid</code>, <code>Uri</code>, <code>Version</code>, <code>StringBuilder</code>
</li>
<li>
<code>BigInteger</code>, <code>Complex</code>, <code>Half</code>
</li>
<li>
<code>Array[]</code>, <code>Array[,]</code>, <code>Array[,,]</code>, <code>Array[,,,]</code>, <code>ArraySegment&lt;&gt;</code>, <code>BitArray</code>
</li>
<li>
<code>KeyValuePair&lt;,&gt;</code>, <code>Tuple&lt;,...&gt;</code>, <code>ValueTuple&lt;,...&gt;</code>
</li>
<li>
<code>ArrayList</code>, <code>Hashtable</code>
</li>
<li>
<code>List&lt;&gt;</code>, <code>LinkedList&lt;&gt;</code>, <code>Queue&lt;&gt;</code>, <code>Stack&lt;&gt;</code>, <code>HashSet&lt;&gt;</code>, <code>ReadOnlyCollection&lt;&gt;</code>, <code>SortedList&lt;,&gt;</code>
</li>
<li>
<code>IList&lt;&gt;</code>, <code>ICollection&lt;&gt;</code>, <code>IEnumerable&lt;&gt;</code>, <code>IReadOnlyCollection&lt;&gt;</code>, <code>IReadOnlyList&lt;&gt;</code>
</li>
<li>
<code>Dictionary&lt;,&gt;</code>, <code>IDictionary&lt;,&gt;</code>, <code>SortedDictionary&lt;,&gt;</code>, <code>ILookup&lt;,&gt;</code>, <code>IGrouping&lt;,&gt;</code>, <code>ReadOnlyDictionary&lt;,&gt;</code>, <code>IReadOnlyDictionary&lt;,&gt;</code>
</li>
<li>
<code>ObservableCollection&lt;&gt;</code>, <code>ReadOnlyObservableCollection&lt;&gt;</code>
</li>
<li>
<code>ISet&lt;&gt;</code>,</li>
<li>
<code>ConcurrentBag&lt;&gt;</code>, <code>ConcurrentQueue&lt;&gt;</code>, <code>ConcurrentStack&lt;&gt;</code>, <code>ConcurrentDictionary&lt;,&gt;</code>
</li>
<li>Immutable collections (<code>ImmutableList&lt;&gt;</code>, etc)</li>
<li>Custom implementations of <code>ICollection&lt;&gt;</code> or <code>IDictionary&lt;,&gt;</code> with a parameterless constructor</li>
<li>Custom implementations of <code>IList</code> or <code>IDictionary</code> with a parameterless constructor</li>
</ul>
<p dir="auto">You can add support for custom types, and there are some official/third-party extension packages for:</p>
<ul dir="auto">
<li>ReactiveProperty</li>
<li>for Unity (<code>Vector3</code>, <code>Quaternion</code>, etc...)</li>
<li>F# (Record, FsList, Discriminated Unions, etc...)</li>
</ul>
<p dir="auto">Please see the <a href="#extensions">extensions section</a>.</p>
<p dir="auto"><code>MessagePack.Nil</code> is the built-in type representing null/void in MessagePack for C#.</p>
<h6 dir="auto">
<a id="user-content-object-serialization" class="anchor" aria-hidden="true" href="#object-serialization"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Object Serialization</h6>
<p dir="auto">MessagePack for C# can serialize your own public <code>class</code> or <code>struct</code> types. By default, serializable types must be annotated with the <code>[MessagePackObject]</code> attribute and members with the <code>[Key]</code> attribute. Keys can be either indexes (<code>int</code>) or arbitrary strings. If all keys are indexes, arrays are used for serialization, which offers advantages in performance and binary size. Otherwise, MessagePack maps (dictionaries) will be used.</p>
<p dir="auto">If you use <code>[MessagePackObject(keyAsPropertyName: true)]</code>, then members do not require explicit <code>Key</code> attributes, but string keys will be used.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='[MessagePackObject]
public class Sample1
{
    [Key(0)]
    public int Foo { get; set; }
    [Key(1)]
    public int Bar { get; set; }
}

[MessagePackObject]
public class Sample2
{
    [Key("foo")]
    public int Foo { get; set; }
    [Key("bar")]
    public int Bar { get; set; }
}

[MessagePackObject(keyAsPropertyName: true)]
public class Sample3
{
    // No need for a Key attribute
    public int Foo { get; set; }

    // If want to ignore a public member, you can use the  IgnoreMember attribute
    [IgnoreMember]
    public int Bar { get; set; }
}

// [10,20]
Console.WriteLine(MessagePackSerializer.SerializeToJson(new Sample1 { Foo = 10, Bar = 20 }));

// {"foo":10,"bar":20}
Console.WriteLine(MessagePackSerializer.SerializeToJson(new Sample2 { Foo = 10, Bar = 20 }));

// {"Foo":10}
Console.WriteLine(MessagePackSerializer.SerializeToJson(new Sample3 { Foo = 10, Bar = 20 }));'><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Sample1</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Foo</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Bar</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Sample2</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Foo</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
    [<span class="pl-en">Key</span>(<span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Bar</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

[<span class="pl-en">MessagePackObject</span>(<span class="pl-smi">keyAsPropertyName</span>: <span class="pl-c1">true</span>)]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Sample3</span>
{
    <span class="pl-c"><span class="pl-c">//</span> No need for a Key attribute</span>
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Foo</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }

    <span class="pl-c"><span class="pl-c">//</span> If want to ignore a public member, you can use the  IgnoreMember attribute</span>
    [<span class="pl-en">IgnoreMember</span>]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Bar</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

<span class="pl-c"><span class="pl-c">//</span> [10,20]</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">SerializeToJson</span>(<span class="pl-k">new</span> <span class="pl-en">Sample1</span> { <span class="pl-smi">Foo</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>, <span class="pl-smi">Bar</span> <span class="pl-k">=</span> <span class="pl-c1">20</span> }));

<span class="pl-c"><span class="pl-c">//</span> {"foo":10,"bar":20}</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">SerializeToJson</span>(<span class="pl-k">new</span> <span class="pl-en">Sample2</span> { <span class="pl-smi">Foo</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>, <span class="pl-smi">Bar</span> <span class="pl-k">=</span> <span class="pl-c1">20</span> }));

<span class="pl-c"><span class="pl-c">//</span> {"Foo":10}</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">SerializeToJson</span>(<span class="pl-k">new</span> <span class="pl-en">Sample3</span> { <span class="pl-smi">Foo</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>, <span class="pl-smi">Bar</span> <span class="pl-k">=</span> <span class="pl-c1">20</span> }));</pre></div>
<p dir="auto">All public instance members (fields as well as properties) will be serialized. If you want to ignore certain public members, annotate the member with a <code>[IgnoreMember]</code> attribute.</p>
<p dir="auto">Please note that any serializable struct or class must have public accessibility; private and internal structs and classes cannot be serialized!
The default of requiring <code>MessagePackObject</code> annotations is meant to enforce explicitness and therefore may help write more robust code.</p>
<p dir="auto">Should you use an indexed (<code>int</code>) key or a string key?
We recommend using indexed keys for faster serialization and a more compact binary representation than string keys.
However, the additional information in the strings of string keys can be quite useful when debugging.</p>
<p dir="auto">When classes change or are extended, be careful about versioning. <code>MessagePackSerializer</code> will initialize members to their <code>default</code> value if a key does not exist in the serialized binary blob, meaning members using reference types can be initialized to <code>null</code>.
If you use indexed (<code>int</code>) keys, the keys should start at 0 and should be sequential. If a later version stops using certain members, you should keep the obsolete members (C# provides an <code>Obsolete</code> attribute to annotate such members) until all other clients had a chance to update and remove their uses of these members as well. Also, when the values of indexed keys "jump" a lot, leaving gaps in the sequence, it will negatively affect the binary size, as <code>null</code> placeholders will be inserted into the resulting arrays. However, you shouldn't reuse indexes of removed members to avoid compatibility issues between clients or when trying to deserialize legacy blobs.</p>
<p dir="auto">Example of index gaps and resulting placeholders:</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[MessagePackObject]
public class IntKeySample
{
    [Key(3)]
    public int A { get; set; }
    [Key(10)]
    public int B { get; set; }
}

// [null,null,null,0,null,null,null,null,null,null,0]
Console.WriteLine(MessagePackSerializer.SerializeToJson(new IntKeySample()));"><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">IntKeySample</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">3</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">A</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
    [<span class="pl-en">Key</span>(<span class="pl-c1">10</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">B</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

<span class="pl-c"><span class="pl-c">//</span> [null,null,null,0,null,null,null,null,null,null,0]</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">SerializeToJson</span>(<span class="pl-k">new</span> <span class="pl-en">IntKeySample</span>()));</pre></div>
<p dir="auto">If you do not want to explicitly annotate with the <code>MessagePackObject</code>/<code>Key</code> attributes and instead want to use MessagePack for C# more like e.g. <a href="https://github.com/JamesNK/Newtonsoft.Json">Json.NET</a>, you can make use of the contractless resolver.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='public class ContractlessSample
{
    public int MyProperty1 { get; set; }
    public int MyProperty2 { get; set; }
}

var data = new ContractlessSample { MyProperty1 = 99, MyProperty2 = 9999 };
var bin = MessagePackSerializer.Serialize(
  data,
  MessagePack.Resolvers.ContractlessStandardResolver.Options);

// {"MyProperty1":99,"MyProperty2":9999}
Console.WriteLine(MessagePackSerializer.ConvertToJson(bin));

// You can also set ContractlessStandardResolver as the default.
// (Global state; Not recommended when writing library code)
MessagePackSerializer.DefaultOptions = MessagePack.Resolvers.ContractlessStandardResolver.Options;

// Now serializable...
var bin2 = MessagePackSerializer.Serialize(data);'><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">ContractlessSample</span>
{
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">MyProperty1</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">MyProperty2</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

<span class="pl-k">var</span> <span class="pl-en">data</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">ContractlessSample</span> { <span class="pl-smi">MyProperty1</span> <span class="pl-k">=</span> <span class="pl-c1">99</span>, <span class="pl-smi">MyProperty2</span> <span class="pl-k">=</span> <span class="pl-c1">9999</span> };
<span class="pl-k">var</span> <span class="pl-en">bin</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(
  <span class="pl-smi">data</span>,
  <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Options</span>);

<span class="pl-c"><span class="pl-c">//</span> {"MyProperty1":99,"MyProperty2":9999}</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">ConvertToJson</span>(<span class="pl-smi">bin</span>));

<span class="pl-c"><span class="pl-c">//</span> You can also set ContractlessStandardResolver as the default.</span>
<span class="pl-c"><span class="pl-c">//</span> (Global state; Not recommended when writing library code)</span>
<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-smi">DefaultOptions</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Options</span>;

<span class="pl-c"><span class="pl-c">//</span> Now serializable...</span>
<span class="pl-k">var</span> <span class="pl-en">bin2</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">data</span>);</pre></div>
<p dir="auto">If you want to serialize private members as well, you can use one of the <code>*AllowPrivate</code> resolvers.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[MessagePackObject]
public class PrivateSample
{
    [Key(0)]
    int x;

    public void SetX(int v)
    {
        x = v;
    }

    public int GetX()
    {
        return x;
    }
}

var data = new PrivateSample();
data.SetX(9999);

// You can choose either StandardResolverAllowPrivate
// or ContractlessStandardResolverAllowPrivate
var bin = MessagePackSerializer.Serialize(
  data,
  MessagePack.Resolvers.DynamicObjectResolverAllowPrivate.Options);"><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">PrivateSample</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">int</span> <span class="pl-en">x</span>;

    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">SetX</span>(<span class="pl-k">int</span> <span class="pl-en">v</span>)
    {
        <span class="pl-smi">x</span> <span class="pl-k">=</span> <span class="pl-smi">v</span>;
    }

    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">GetX</span>()
    {
        <span class="pl-k">return</span> <span class="pl-smi">x</span>;
    }
}

<span class="pl-k">var</span> <span class="pl-en">data</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">PrivateSample</span>();
<span class="pl-smi">data</span>.<span class="pl-en">SetX</span>(<span class="pl-c1">9999</span>);

<span class="pl-c"><span class="pl-c">//</span> You can choose either StandardResolverAllowPrivate</span>
<span class="pl-c"><span class="pl-c">//</span> or ContractlessStandardResolverAllowPrivate</span>
<span class="pl-k">var</span> <span class="pl-en">bin</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(
  <span class="pl-smi">data</span>,
  <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">DynamicObjectResolverAllowPrivate</span>.<span class="pl-smi">Options</span>);</pre></div>
<p dir="auto">If you want to use MessagePack for C# more like a BinaryFormatter with a typeless serialization API, use the typeless resolver and helpers. Please consult the <a href="#typeless">Typeless section</a>.</p>
<p dir="auto">Resolvers are the way to add specialized support for custom types to MessagePack for C#. Please refer to the <a href="#resolvers">Extension point section</a>.</p>
<h6 dir="auto">
<a id="user-content-datacontract-compatibility" class="anchor" aria-hidden="true" href="#datacontract-compatibility"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>DataContract compatibility</h6>
<p dir="auto">You can use <code>[DataContract]</code> annotations instead of <code>[MessagePackObject]</code> ones. If type is annotated with <code>DataContract</code>, you can use <code>[DataMember]</code> annotations instead of <code>[Key]</code> ones and <code>[IgnoreDataMember]</code> instead of <code>[IgnoreMember]</code>.</p>
<p dir="auto">Then <code>[DataMember(Order = int)]</code> will behave the same as <code>[Key(int)]</code>, <code>[DataMember(Name = string)]</code> the same as <code>[Key(string)]</code>, and <code>[DataMember]</code> the same as <code>[Key(nameof(member name)]</code>.</p>
<p dir="auto">Using <code>DataContract</code>, e.g. in shared libraries, makes your classes/structs independent from MessagePack for C# serialization. However, it is not supported by the analyzers nor in code generation by the <code>mpc</code> tool. Also, features like <code>UnionAttribute</code>, <code>MessagePackFormatter</code>, <code>SerializationConstructor</code>, etc can not be used. Due to this, we recommend that you use the specific MessagePack for C# annotations when possible.</p>
<h6 dir="auto">
<a id="user-content-serializing-readonlyimmutable-object-members--serializationconstructor" class="anchor" aria-hidden="true" href="#serializing-readonlyimmutable-object-members--serializationconstructor"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Serializing readonly/immutable object members  (SerializationConstructor)</h6>
<p dir="auto">MessagePack for C# supports serialization of readonly/immutable objects/members. For example, this struct can be serialized and deserialized.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[MessagePackObject]
public struct Point
{
    [Key(0)]
    public readonly int X;
    [Key(1)]
    public readonly int Y;

    public Point(int x, int y)
    {
        this.X = x;
        this.Y = y;
    }
}

var data = new Point(99, 9999);
var bin = MessagePackSerializer.Serialize(data);

// Okay to deserialize immutable object
var point = MessagePackSerializer.Deserialize&lt;Point&gt;(bin);"><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">struct</span> <span class="pl-en">Point</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">int</span> <span class="pl-en">X</span>;
    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">int</span> <span class="pl-en">Y</span>;

    <span class="pl-k">public</span> <span class="pl-en">Point</span>(<span class="pl-k">int</span> <span class="pl-en">x</span>, <span class="pl-k">int</span> <span class="pl-en">y</span>)
    {
        <span class="pl-k">this</span>.<span class="pl-smi">X</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>;
        <span class="pl-k">this</span>.<span class="pl-smi">Y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>;
    }
}

<span class="pl-k">var</span> <span class="pl-en">data</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Point</span>(<span class="pl-c1">99</span>, <span class="pl-c1">9999</span>);
<span class="pl-k">var</span> <span class="pl-en">bin</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">data</span>);

<span class="pl-c"><span class="pl-c">//</span> Okay to deserialize immutable object</span>
<span class="pl-k">var</span> <span class="pl-en">point</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">Point</span>&gt;(<span class="pl-smi">bin</span>);</pre></div>
<p dir="auto"><code>MessagePackSerializer</code> will choose the constructor with the best matched argument list, using argument indexes index for index keys, or parameter names for string keys. If it cannot determine an appropriate constructor, a <code>MessagePackDynamicObjectResolverException: can't find matched constructor parameter</code> exception will be thrown.
You can specify which constructor to use manually with a <code>[SerializationConstructor]</code> annotation.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[MessagePackObject]
public struct Point
{
    [Key(0)]
    public readonly int X;
    [Key(1)]
    public readonly int Y;

    [SerializationConstructor]
    public Point(int x)
    {
        this.X = x;
        this.Y = -1;
    }

    // If not marked attribute, used this(most matched argument)
    public Point(int x, int y)
    {
        this.X = x;
        this.Y = y;
    }
}"><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">struct</span> <span class="pl-en">Point</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">int</span> <span class="pl-en">X</span>;
    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">int</span> <span class="pl-en">Y</span>;

    [<span class="pl-en">SerializationConstructor</span>]
    <span class="pl-k">public</span> <span class="pl-en">Point</span>(<span class="pl-k">int</span> <span class="pl-en">x</span>)
    {
        <span class="pl-k">this</span>.<span class="pl-smi">X</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>;
        <span class="pl-k">this</span>.<span class="pl-smi">Y</span> <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>;
    }

    <span class="pl-c"><span class="pl-c">//</span> If not marked attribute, used this(most matched argument)</span>
    <span class="pl-k">public</span> <span class="pl-en">Point</span>(<span class="pl-k">int</span> <span class="pl-en">x</span>, <span class="pl-k">int</span> <span class="pl-en">y</span>)
    {
        <span class="pl-k">this</span>.<span class="pl-smi">X</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>;
        <span class="pl-k">this</span>.<span class="pl-smi">Y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>;
    }
}</pre></div>
<h7 dir="auto">
<a id="user-content-c-9-record-types" class="anchor" aria-hidden="true" href="#c-9-record-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>C# 9 <code>record</code> types</h7>
<p dir="auto">C# 9.0 record with primary constructor is similar immutable object, also supports serialize/deserialize.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// use key as property name
[MessagePackObject(true)]public record Point(int X, int Y);

// use property: to set KeyAttribute
[MessagePackObject] public record Point([property:Key(0)] int X, [property: Key(1)] int Y);

// Or use explicit properties
[MessagePackObject]
public record Person
{
    [Key(0)]
    public string FirstName { get; init; }

    [Key(1)]
    public string LastName { get; init; }
}"><pre><span class="pl-c"><span class="pl-c">//</span> use key as property name</span>
[<span class="pl-en">MessagePackObject</span>(<span class="pl-c1">true</span>)]<span class="pl-k">public</span> <span class="pl-k">record</span> <span class="pl-en">Point</span>(int X, int Y);

<span class="pl-c"><span class="pl-c">//</span> use property: to set KeyAttribute</span>
[MessagePackObject] public record Point([property:<span class="pl-en">Key</span>(0)] <span class="pl-k">int</span> <span class="pl-en">X</span>, [property: Key(1)] <span class="pl-k">int</span> <span class="pl-en">Y</span>);

<span class="pl-c"><span class="pl-c">//</span> Or use explicit properties</span>
[MessagePackObject]
<span class="pl-en">public</span> <span class="pl-en">record</span> <span class="pl-en">Person</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">string</span> <span class="pl-en">FirstName</span> { <span class="pl-k">get</span>; <span class="pl-k">init</span>; }

    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">string</span> <span class="pl-en">LastName</span> { <span class="pl-k">get</span>; <span class="pl-k">init</span>; }
}</pre></div>
<h7 dir="auto">
<a id="user-content-c-9-init-property-setter-limitations" class="anchor" aria-hidden="true" href="#c-9-init-property-setter-limitations"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>C# 9 <code>init</code> property setter limitations</h7>
<p dir="auto">When using <code>init</code> property setters in <em>generic</em> classes, <a href="https://github.com/neuecc/MessagePack-CSharp/issues/1134" data-hovercard-type="issue" data-hovercard-url="/neuecc/MessagePack-CSharp/issues/1134/hovercard">a CLR bug</a> prevents our most efficient code generation from invoking the property setter.
As a result, you should avoid using <code>init</code> on property setters in generic classes when using the public-only <code>DynamicObjectResolver</code>/<code>StandardResolver</code>.</p>
<p dir="auto">When using the <code>DynamicObjectResolverAllowPrivate</code>/<code>StandardResolverAllowPrivate</code> resolver the bug does not apply and you may use <code>init</code> without restriction.</p>
<h6 dir="auto">
<a id="user-content-serialization-callback" class="anchor" aria-hidden="true" href="#serialization-callback"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Serialization Callback</h6>
<p dir="auto">Objects implementing the <code>IMessagePackSerializationCallbackReceiver</code> interface will received <code>OnBeforeSerialize</code> and <code>OnAfterDeserialize</code> calls during serialization/deserialization.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='[MessagePackObject]
public class SampleCallback : IMessagePackSerializationCallbackReceiver
{
    [Key(0)]
    public int Key { get; set; }

    public void OnBeforeSerialize()
    {
        Console.WriteLine("OnBefore");
    }

    public void OnAfterDeserialize()
    {
        Console.WriteLine("OnAfter");
    }
}'><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SampleCallback</span> : <span class="pl-en">IMessagePackSerializationCallbackReceiver</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Key</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }

    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">OnBeforeSerialize</span>()
    {
        <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-s"><span class="pl-pds">"</span>OnBefore<span class="pl-pds">"</span></span>);
    }

    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">OnAfterDeserialize</span>()
    {
        <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-s"><span class="pl-pds">"</span>OnAfter<span class="pl-pds">"</span></span>);
    }
}</pre></div>
<h6 dir="auto">
<a id="user-content-union" class="anchor" aria-hidden="true" href="#union"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Union</h6>
<p dir="auto">MessagePack for C# supports serializing interface-typed and abstract class-typed objects. It behaves like <code>XmlInclude</code> or <code>ProtoInclude</code>. In MessagePack for C# these are called <code>Union</code>. Only interfaces and abstracts classes are allowed to be annotated with <code>Union</code> attributes. Unique union keys are required.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// Annotate inheritance types
[MessagePack.Union(0, typeof(FooClass))]
[MessagePack.Union(1, typeof(BarClass))]
public interface IUnionSample
{
}

[MessagePackObject]
public class FooClass : IUnionSample
{
    [Key(0)]
    public int XYZ { get; set; }
}

[MessagePackObject]
public class BarClass : IUnionSample
{
    [Key(0)]
    public string OPQ { get; set; }
}

// ---

IUnionSample data = new FooClass() { XYZ = 999 };

// Serialize interface-typed object.
var bin = MessagePackSerializer.Serialize(data);

// Deserialize again.
var reData = MessagePackSerializer.Deserialize&lt;IUnionSample&gt;(bin);

// Use with e.g. type-switching in C# 7.0
switch (reData)
{
    case FooClass x:
        Console.WriteLine(x.XYZ);
        break;
    case BarClass x:
        Console.WriteLine(x.OPQ);
        break;
    default:
        break;
}"><pre><span class="pl-c"><span class="pl-c">//</span> Annotate inheritance types</span>
[<span class="pl-en">MessagePack</span>.<span class="pl-en">Union</span>(<span class="pl-c1">0</span>, <span class="pl-k">typeof</span>(<span class="pl-en">FooClass</span>))]
[<span class="pl-en">MessagePack</span>.<span class="pl-en">Union</span>(<span class="pl-c1">1</span>, <span class="pl-k">typeof</span>(<span class="pl-en">BarClass</span>))]
<span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-en">IUnionSample</span>
{
}

[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">FooClass</span> : <span class="pl-en">IUnionSample</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">XYZ</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">BarClass</span> : <span class="pl-en">IUnionSample</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">string</span> <span class="pl-en">OPQ</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

<span class="pl-c"><span class="pl-c">//</span> ---</span>

<span class="pl-en">IUnionSample</span> <span class="pl-en">data</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">FooClass</span>() { <span class="pl-smi">XYZ</span> <span class="pl-k">=</span> <span class="pl-c1">999</span> };

<span class="pl-c"><span class="pl-c">//</span> Serialize interface-typed object.</span>
<span class="pl-k">var</span> <span class="pl-en">bin</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">data</span>);

<span class="pl-c"><span class="pl-c">//</span> Deserialize again.</span>
<span class="pl-k">var</span> <span class="pl-en">reData</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">IUnionSample</span>&gt;(<span class="pl-smi">bin</span>);

<span class="pl-c"><span class="pl-c">//</span> Use with e.g. type-switching in C# 7.0</span>
<span class="pl-k">switch</span> (<span class="pl-smi">reData</span>)
{
    <span class="pl-k">case</span> <span class="pl-smi">FooClass</span> <span class="pl-smi">x</span>:
        <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">x</span>.<span class="pl-smi">XYZ</span>);
        <span class="pl-k">break</span>;
    <span class="pl-k">case</span> <span class="pl-smi">BarClass</span> <span class="pl-smi">x</span>:
        <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">x</span>.<span class="pl-smi">OPQ</span>);
        <span class="pl-k">break</span>;
    <span class="pl-k">default</span>:
        <span class="pl-k">break</span>;
}</pre></div>
<p dir="auto">Unions are internally serialized to two-element arrays.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='IUnionSample data = new BarClass { OPQ = "FooBar" };

var bin = MessagePackSerializer.Serialize(data);

// Union is serialized to two-length array, [key, object]
// [1,["FooBar"]]
Console.WriteLine(MessagePackSerializer.ConvertToJson(bin));'><pre><span class="pl-en">IUnionSample</span> <span class="pl-en">data</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">BarClass</span> { <span class="pl-smi">OPQ</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>FooBar<span class="pl-pds">"</span></span> };

<span class="pl-k">var</span> <span class="pl-en">bin</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">data</span>);

<span class="pl-c"><span class="pl-c">//</span> Union is serialized to two-length array, [key, object]</span>
<span class="pl-c"><span class="pl-c">//</span> [1,["FooBar"]]</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">ConvertToJson</span>(<span class="pl-smi">bin</span>));</pre></div>
<p dir="auto">Using <code>Union</code> with abstract classes works the same way.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[Union(0, typeof(SubUnionType1))]
[Union(1, typeof(SubUnionType2))]
[MessagePackObject]
public abstract class ParentUnionType
{
    [Key(0)]
    public int MyProperty { get; set; }
}

[MessagePackObject]
public class SubUnionType1 : ParentUnionType
{
    [Key(1)]
    public int MyProperty1 { get; set; }
}

[MessagePackObject]
public class SubUnionType2 : ParentUnionType
{
    [Key(1)]
    public int MyProperty2 { get; set; }
}"><pre>[<span class="pl-en">Union</span>(<span class="pl-c1">0</span>, <span class="pl-k">typeof</span>(<span class="pl-en">SubUnionType1</span>))]
[<span class="pl-en">Union</span>(<span class="pl-c1">1</span>, <span class="pl-k">typeof</span>(<span class="pl-en">SubUnionType2</span>))]
[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">abstract</span> <span class="pl-k">class</span> <span class="pl-en">ParentUnionType</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">MyProperty</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SubUnionType1</span> : <span class="pl-en">ParentUnionType</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">MyProperty1</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SubUnionType2</span> : <span class="pl-en">ParentUnionType</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">MyProperty2</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}</pre></div>
<p dir="auto">Please be mindful that you cannot reuse the same keys in derived types that are already present in the parent type, as internally a single flat array or map will be used and thus cannot have duplicate indexes/keys.</p>
<h6 dir="auto">
<a id="user-content-dynamic-untyped-deserialization" class="anchor" aria-hidden="true" href="#dynamic-untyped-deserialization"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Dynamic (Untyped) Deserialization</h6>
<p dir="auto">When calling <code>MessagePackSerializer.Deserialize&lt;object&gt;</code> or <code>MessagePackSerializer.Deserialize&lt;dynamic&gt;</code>, any values present in the blob will be converted to primitive values, i.e. <code>bool</code>, <code>char</code>, <code>sbyte</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code>, <code>ushort</code>, <code>uint</code>, <code>ulong</code>, <code>float</code>, <code>double</code>, <code>DateTime</code>, <code>string</code>, <code>byte[]</code>, <code>object[]</code>, <code>IDictionary&lt;object, object&gt;</code>.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='// Sample blob.
var model = new DynamicModel { Name = "foobar", Items = new[] { 1, 10, 100, 1000 } };
var blob = MessagePackSerializer.Serialize(model, ContractlessStandardResolver.Options);

// Dynamic ("untyped")
var dynamicModel = MessagePackSerializer.Deserialize&lt;dynamic&gt;(blob, ContractlessStandardResolver.Options);

// You can access the data using array/dictionary indexers, as shown above
Console.WriteLine(dynamicModel["Name"]); // foobar
Console.WriteLine(dynamicModel["Items"][2]); // 100'><pre><span class="pl-c"><span class="pl-c">//</span> Sample blob.</span>
<span class="pl-k">var</span> <span class="pl-en">model</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">DynamicModel</span> { <span class="pl-smi">Name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>foobar<span class="pl-pds">"</span></span>, <span class="pl-smi">Items</span> <span class="pl-k">=</span> <span class="pl-k">new</span>[] { <span class="pl-c1">1</span>, <span class="pl-c1">10</span>, <span class="pl-c1">100</span>, <span class="pl-c1">1000</span> } };
<span class="pl-k">var</span> <span class="pl-en">blob</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">model</span>, <span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Options</span>);

<span class="pl-c"><span class="pl-c">//</span> Dynamic ("untyped")</span>
<span class="pl-k">var</span> <span class="pl-en">dynamicModel</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-k">dynamic</span>&gt;(<span class="pl-smi">blob</span>, <span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Options</span>);

<span class="pl-c"><span class="pl-c">//</span> You can access the data using array/dictionary indexers, as shown above</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">dynamicModel</span>[<span class="pl-s"><span class="pl-pds">"</span>Name<span class="pl-pds">"</span></span>]); <span class="pl-c"><span class="pl-c">//</span> foobar</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">dynamicModel</span>[<span class="pl-s"><span class="pl-pds">"</span>Items<span class="pl-pds">"</span></span>][<span class="pl-c1">2</span>]); <span class="pl-c"><span class="pl-c">//</span> 100</span></pre></div>
<p dir="auto">Exploring object trees using the dictionary indexer syntax is the fastest option for untyped deserialization, but it is tedious to read and write.
Where performance is not as important as code readability, consider deserializing with <a href="/neuecc/MessagePack-CSharp/blob/master/doc/ExpandoObject.md">ExpandoObject</a>.</p>
<h6 dir="auto">
<a id="user-content-object-type-serialization" class="anchor" aria-hidden="true" href="#object-type-serialization"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Object Type Serialization</h6>
<p dir="auto"><code>StandardResolver</code> and <code>ContractlessStandardResolver</code> can serialize <code>object</code>/anonymous typed objects.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='var objects = new object[] { 1, "aaa", new ObjectFieldType { Anything = 9999 } };
var bin = MessagePackSerializer.Serialize(objects);

// [1,"aaa",[9999]]
Console.WriteLine(MessagePackSerializer.ConvertToJson(bin));

// Support anonymous Type Serialize
var anonType = new { Foo = 100, Bar = "foobar" };
var bin2 = MessagePackSerializer.Serialize(anonType, MessagePack.Resolvers.ContractlessStandardResolver.Options);

// {"Foo":100,"Bar":"foobar"}
Console.WriteLine(MessagePackSerializer.ConvertToJson(bin2));'><pre><span class="pl-k">var</span> <span class="pl-en">objects</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">object</span>[] { <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">"</span>aaa<span class="pl-pds">"</span></span>, <span class="pl-k">new</span> <span class="pl-en">ObjectFieldType</span> { <span class="pl-smi">Anything</span> <span class="pl-k">=</span> <span class="pl-c1">9999</span> } };
<span class="pl-k">var</span> <span class="pl-en">bin</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">objects</span>);

<span class="pl-c"><span class="pl-c">//</span> [1,"aaa",[9999]]</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">ConvertToJson</span>(<span class="pl-smi">bin</span>));

<span class="pl-c"><span class="pl-c">//</span> Support anonymous Type Serialize</span>
<span class="pl-k">var</span> <span class="pl-en">anonType</span> <span class="pl-k">=</span> <span class="pl-k">new</span> { <span class="pl-smi">Foo</span> <span class="pl-k">=</span> <span class="pl-c1">100</span>, <span class="pl-smi">Bar</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>foobar<span class="pl-pds">"</span></span> };
<span class="pl-k">var</span> <span class="pl-en">bin2</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">anonType</span>, <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Options</span>);

<span class="pl-c"><span class="pl-c">//</span> {"Foo":100,"Bar":"foobar"}</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">ConvertToJson</span>(<span class="pl-smi">bin2</span>));</pre></div>
<blockquote>
<p dir="auto">Unity supports is limited.</p>
</blockquote>
<p dir="auto">When deserializing, the behavior will be the same as Dynamic (Untyped) Deserialization.</p>
<h6 dir="auto">
<a id="user-content-typeless" class="anchor" aria-hidden="true" href="#typeless"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Typeless</h6>
<p dir="auto">The typeless API is similar to <code>BinaryFormatter</code>, as it will embed type information into the blobs, so no types need to be specified explicitly when calling the API.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='object mc = new Sandbox.MyClass()
{
    Age = 10,
    FirstName = "hoge",
    LastName = "huga"
};

// Serialize with the typeless API
var blob = MessagePackSerializer.Typeless.Serialize(mc);

// Blob has embedded type-assembly information.
// ["Sandbox.MyClass, Sandbox",10,"hoge","huga"]
Console.WriteLine(MessagePackSerializer.ConvertToJson(bin));

// You can deserialize to MyClass again with the typeless API
// Note that no type has to be specified explicitly in the Deserialize call
// as type information is embedded in the binary blob
var objModel = MessagePackSerializer.Typeless.Deserialize(bin) as MyClass;'><pre><span class="pl-k">object</span> <span class="pl-en">mc</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Sandbox</span>.<span class="pl-en">MyClass</span>()
{
    <span class="pl-smi">Age</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>,
    <span class="pl-smi">FirstName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>hoge<span class="pl-pds">"</span></span>,
    <span class="pl-smi">LastName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>huga<span class="pl-pds">"</span></span>
};

<span class="pl-c"><span class="pl-c">//</span> Serialize with the typeless API</span>
<span class="pl-k">var</span> <span class="pl-en">blob</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-smi">Typeless</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">mc</span>);

<span class="pl-c"><span class="pl-c">//</span> Blob has embedded type-assembly information.</span>
<span class="pl-c"><span class="pl-c">//</span> ["Sandbox.MyClass, Sandbox",10,"hoge","huga"]</span>
<span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">ConvertToJson</span>(<span class="pl-smi">bin</span>));

<span class="pl-c"><span class="pl-c">//</span> You can deserialize to MyClass again with the typeless API</span>
<span class="pl-c"><span class="pl-c">//</span> Note that no type has to be specified explicitly in the Deserialize call</span>
<span class="pl-c"><span class="pl-c">//</span> as type information is embedded in the binary blob</span>
<span class="pl-k">var</span> <span class="pl-en">objModel</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-smi">Typeless</span>.<span class="pl-en">Deserialize</span>(<span class="pl-smi">bin</span>) <span class="pl-k">as</span> <span class="pl-en">MyClass</span>;</pre></div>
<p dir="auto">Type information is represented by the MessagePack <code>ext</code> format, type code <code>100</code>.</p>
<p dir="auto"><code>MessagePackSerializer.Typeless</code> is a shortcut of <code>Serialize/Deserialize&lt;object&gt;(TypelessContractlessStandardResolver.Instance)</code>.
If you want to configure it as the default resolver, you can use <code>MessagePackSerializer.Typeless.RegisterDefaultResolver</code>.</p>
<p dir="auto"><code>TypelessFormatter</code> can used standalone or combined with other resolvers.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// Replaced `object` uses the typeless resolver
var resolver = MessagePack.Resolvers.CompositeResolver.Create(
    new[] { MessagePack.Formatters.TypelessFormatter.Instance },
    new[] { MessagePack.Resolvers.StandardResolver.Instance });

public class Foo
{
    // use Typeless(this field only)
    [MessagePackFormatter(typeof(TypelessFormatter))]
    public object Bar;
}"><pre><span class="pl-c"><span class="pl-c">//</span> Replaced `object` uses the typeless resolver</span>
<span class="pl-k">var</span> <span class="pl-en">resolver</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">CompositeResolver</span>.<span class="pl-en">Create</span>(
    <span class="pl-k">new</span>[] { <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Formatters</span>.<span class="pl-smi">TypelessFormatter</span>.<span class="pl-smi">Instance</span> },
    <span class="pl-k">new</span>[] { <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">StandardResolver</span>.<span class="pl-smi">Instance</span> });

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Foo</span>
{
    <span class="pl-c"><span class="pl-c">//</span> use Typeless(this field only)</span>
    [<span class="pl-en">MessagePackFormatter</span>(<span class="pl-k">typeof</span>(<span class="pl-en">TypelessFormatter</span>))]
    <span class="pl-k">public</span> <span class="pl-k">object</span> <span class="pl-en">Bar</span>;
}</pre></div>
<p dir="auto">If a type's name is changed later, you can no longer deserialize old blobs. But you can specify a fallback name in such cases, providing a <code>TypelessFormatter.BindToType</code> function of your own.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='MessagePack.Formatters.TypelessFormatter.BindToType = typeName =&gt;
{
    if (typeName.StartsWith("SomeNamespace"))
    {
        typeName = typeName.Replace("SomeNamespace", "AnotherNamespace");
    }

    return Type.GetType(typeName, false);
};'><pre><span class="pl-smi">MessagePack</span>.<span class="pl-smi">Formatters</span>.<span class="pl-smi">TypelessFormatter</span>.<span class="pl-smi">BindToType</span> <span class="pl-k">=</span> <span class="pl-en">typeName</span> <span class="pl-k">=&gt;</span>
{
    <span class="pl-k">if</span> (<span class="pl-smi">typeName</span>.<span class="pl-en">StartsWith</span>(<span class="pl-s"><span class="pl-pds">"</span>SomeNamespace<span class="pl-pds">"</span></span>))
    {
        <span class="pl-smi">typeName</span> <span class="pl-k">=</span> <span class="pl-smi">typeName</span>.<span class="pl-en">Replace</span>(<span class="pl-s"><span class="pl-pds">"</span>SomeNamespace<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>AnotherNamespace<span class="pl-pds">"</span></span>);
    }

    <span class="pl-k">return</span> <span class="pl-smi">Type</span>.<span class="pl-en">GetType</span>(<span class="pl-smi">typeName</span>, <span class="pl-c1">false</span>);
};</pre></div>
<h6 dir="auto">
<a id="user-content-security" class="anchor" aria-hidden="true" href="#security"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a name="user-content-security"></a>Security</h6>
<p dir="auto">Deserializing data from an untrusted source can introduce security vulnerabilities in your application.
Depending on the settings used during deserialization, <strong>untrusted data may be able to execute arbitrary code</strong> or cause a denial of service attack.
Untrusted data might come from over the network from an untrusted source (e.g. any and every networked client) or can be tampered with by an intermediary when transmitted over an unauthenticated connection, or from a local storage that might have been tampered with, or many other sources. MessagePack for C# does not provide any means to authenticate data or make it tamper-resistant. Please use an appropriate method of authenticating data before deserialization - such as a <a href="https://en.wikipedia.org/wiki/Message_authentication_code" rel="nofollow"><code>MAC</code></a> .</p>
<p dir="auto">Please be very mindful of these attack scenarios; many projects and companies, and serialization library users in general, have been bitten by untrusted user data deserialization in the past.</p>
<p dir="auto">When deserializing untrusted data, put MessagePack into a more secure mode by configuring your <code>MessagePackSerializerOptions.Security</code> property:</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="var options = MessagePackSerializerOptions.Standard
    .WithSecurity(MessagePackSecurity.UntrustedData);

// Pass the options explicitly for the greatest control.
T object = MessagePackSerializer.Deserialize&lt;T&gt;(data, options);

// Or set the security level as the default.
MessagePackSerializer.DefaultOptions = options;"><pre><span class="pl-k">var</span> <span class="pl-en">options</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializerOptions</span>.<span class="pl-smi">Standard</span>
    .<span class="pl-en">WithSecurity</span>(<span class="pl-smi">MessagePackSecurity</span>.<span class="pl-smi">UntrustedData</span>);

<span class="pl-c"><span class="pl-c">//</span> Pass the options explicitly for the greatest control.</span>
<span class="pl-en">T</span> <span class="pl-en">object</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">T</span>&gt;(<span class="pl-smi">data</span>, <span class="pl-smi">options</span>);

<span class="pl-c"><span class="pl-c">//</span> Or set the security level as the default.</span>
<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-smi">DefaultOptions</span> <span class="pl-k">=</span> <span class="pl-smi">options</span>;</pre></div>
<p dir="auto">You should also avoid the Typeless serializer/formatters/resolvers for untrusted data as that opens the door for the untrusted data to potentially deserialize unanticipated types that can compromise security.</p>
<p dir="auto">The <code>UntrustedData</code> mode merely hardens against some common attacks, but is no fully secure solution in itself.</p>
<h6 dir="auto">
<a id="user-content-performance" class="anchor" aria-hidden="true" href="#performance"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Performance</h6>
<p dir="auto">Benchmarks comparing MessagePack For C# to other serializers were run on <code>Windows 10 Pro x64 Intel Core i7-6700K 4.00GHz, 32GB RAM</code>. Benchmark code is <a href="https://github.com/neuecc/ZeroFormatter/tree/master/sandbox/PerformanceComparison">available here</a> - and their <a href="https://github.com/neuecc/ZeroFormatter/blob/bc63cb925d/sandbox/PerformanceComparison/packages.config">version info</a>.
<a href="https://github.com/neuecc/ZeroFormatter/">ZeroFormatter</a> and <a href="https://google.github.io/flatbuffers/" rel="nofollow">FlatBuffers</a> have infinitely fast deserializers, so ignore their deserialization performance.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/46207/23835765/55fe494e-07b0-11e7-98be-5e7a9411da40.png"><img src="https://cloud.githubusercontent.com/assets/46207/23835765/55fe494e-07b0-11e7-98be-5e7a9411da40.png" alt="image" style="max-width: 100%;"></a></p>
<p dir="auto">MessagePack for C# uses many techniques to improve performance.</p>
<ul dir="auto">
<li>The serializer uses <code>IBufferWriter&lt;byte&gt;</code> rather than <code>System.IO.Stream</code> to reduce memory overhead.</li>
<li>Buffers are rented from pools to reduce allocations, keeping throughput high through reduced GC pressure.</li>
<li>Don't create intermediate utility instances (<code>*Writer/*Reader</code>, <code>*Context</code>, etc...)</li>
<li>Utilize dynamic code generation and JIT to avoid boxing value types. Use AOT generation on platforms that prohibit JITs.</li>
<li>Cached generated formatters on static generic fields (don't use dictionary-cache because dictionary lookup is overhead). See <a href="https://github.com/neuecc/MessagePack-CSharp/tree/209f301e2e595ed366408624011ba2e856d23429/src/MessagePack/Resolvers">Resolvers</a>
</li>
<li>Heavily tuned dynamic IL code generation and JIT to avoid boxing value types. See <a href="https://github.com/neuecc/MessagePack-CSharp/blob/209f301e2e595ed366408624011ba2e856d23429/src/MessagePack/Resolvers/DynamicObjectResolver.cs#L142-L754">DynamicObjectTypeBuilder</a>. Use AOT generation on platforms that prohibit JIT.</li>
<li>Call the Primitive API directly when IL code generation determines target types to be  primitive.</li>
<li>Reduce branching of variable length formats when IL code generation knows the target type (integer/string) ranges</li>
<li>Don't use the <code>IEnumerable&lt;T&gt;</code> abstraction to iterate over collections when possible, <a href="https://github.com/neuecc/MessagePack-CSharp/blob/209f301e2e595ed366408624011ba2e856d23429/src/MessagePack/Formatters/CollectionFormatter.cs#L192-L355">see: CollectionFormatterBase</a> and derived collection formatters</li>
<li>Use pre-generated lookup tables to reduce checks of mgpack type constraints, <a href="https://github.com/neuecc/MessagePack-CSharp/blob/209f301e2e595ed366408624011ba2e856d23429/src/MessagePack/MessagePackBinary.cs#L15-L212">see: MessagePackBinary</a>
</li>
<li>Uses optimized type key dictionary for non-generic methods, <a href="https://github.com/neuecc/MessagePack-CSharp/blob/91312921cb7fe987f48336768c898a76ac7dbb40/src/MessagePack/Internal/ThreadsafeTypeKeyHashTable.cs">see: ThreadsafeTypeKeyHashTable</a>
</li>
<li>Avoid string key decoding for lookup maps (string key and use automata based name lookup with inlined IL code generation, see: <a href="https://github.com/neuecc/MessagePack-CSharp/blob/bcedbce3fd98cb294210d6b4a22bdc4c75ccd916/src/MessagePack/Internal/AutomataDictionary.cs">AutomataDictionary</a>
</li>
<li>To encode string keys, use pre-generated member name bytes and fixed sized byte array copies in IL, see: <a href="https://github.com/neuecc/MessagePack-CSharp/blob/f17ddc5d107d3a2f66f60398b214ef87919ff892/src/MessagePack/Internal/UnsafeMemory.cs">UnsafeMemory.cs</a>
</li>
</ul>
<p dir="auto">Before creating this library, I implemented a fast fast serializer with <a href="https://github.com/neuecc/ZeroFormatter#performance">ZeroFormatter#Performance</a>. This is a further evolved implementation. MessagePack for C# is always fast and optimized for all types (primitive, small struct, large object, any collections).</p>
<h7 dir="auto">
<a id="user-content-deserialization-performance-for-different-options" class="anchor" aria-hidden="true" href="#deserialization-performance-for-different-options"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a name="user-content-deserialize-performance"></a>Deserialization Performance for different options</h7>
<p dir="auto">Performance varies depending on the options used. This is a micro benchmark with <a href="https://github.com/dotnet/BenchmarkDotNet">BenchmarkDotNet</a>. The target object has 9 members (<code>MyProperty1</code> ~ <code>MyProperty9</code>), values are zero.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th align="right">Mean</th>
<th align="right">Error</th>
<th align="right">Scaled</th>
<th align="right">Gen 0</th>
<th align="right">Allocated</th>
</tr>
</thead>
<tbody>
<tr>
<td>M IntKey</td>
<td align="right">72.67 ns</td>
<td align="right">NA</td>
<td align="right">1.00</td>
<td align="right">0.0132</td>
<td align="right">56 B</td>
</tr>
<tr>
<td>M StringKey</td>
<td align="right">217.95 ns</td>
<td align="right">NA</td>
<td align="right">3.00</td>
<td align="right">0.0131</td>
<td align="right">56 B</td>
</tr>
<tr>
<td>M Typeless_IntKey</td>
<td align="right">176.71 ns</td>
<td align="right">NA</td>
<td align="right">2.43</td>
<td align="right">0.0131</td>
<td align="right">56 B</td>
</tr>
<tr>
<td>M Typeless_StringKey</td>
<td align="right">378.64 ns</td>
<td align="right">NA</td>
<td align="right">5.21</td>
<td align="right">0.0129</td>
<td align="right">56 B</td>
</tr>
<tr>
<td>MsgPackCliMap</td>
<td align="right">1,355.26 ns</td>
<td align="right">NA</td>
<td align="right">18.65</td>
<td align="right">0.1431</td>
<td align="right">608 B</td>
</tr>
<tr>
<td>MsgPackCliArray</td>
<td align="right">455.28 ns</td>
<td align="right">NA</td>
<td align="right">6.26</td>
<td align="right">0.0415</td>
<td align="right">176 B</td>
</tr>
<tr>
<td>ProtobufNet</td>
<td align="right">265.85 ns</td>
<td align="right">NA</td>
<td align="right">3.66</td>
<td align="right">0.0319</td>
<td align="right">136 B</td>
</tr>
<tr>
<td>Hyperion</td>
<td align="right">366.47 ns</td>
<td align="right">NA</td>
<td align="right">5.04</td>
<td align="right">0.0949</td>
<td align="right">400 B</td>
</tr>
<tr>
<td>JsonNetString</td>
<td align="right">2,783.39 ns</td>
<td align="right">NA</td>
<td align="right">38.30</td>
<td align="right">0.6790</td>
<td align="right">2864 B</td>
</tr>
<tr>
<td>JsonNetStreamReader</td>
<td align="right">3,297.90 ns</td>
<td align="right">NA</td>
<td align="right">45.38</td>
<td align="right">1.4267</td>
<td align="right">6000 B</td>
</tr>
<tr>
<td>JilString</td>
<td align="right">553.65 ns</td>
<td align="right">NA</td>
<td align="right">7.62</td>
<td align="right">0.0362</td>
<td align="right">152 B</td>
</tr>
<tr>
<td>JilStreamReader</td>
<td align="right">1,408.46 ns</td>
<td align="right">NA</td>
<td align="right">19.38</td>
<td align="right">0.8450</td>
<td align="right">3552 B</td>
</tr>
</tbody>
</table>
<p dir="auto"><code>ÌntKey</code>, <code>StringKey</code>, <code>Typeless_IntKey</code>, <code>Typeless_StringKey</code> are MessagePack for C# options. All MessagePack for C# options achieve zero memory allocations in the deserialization process. <code>JsonNetString</code>/<code>JilString</code> is deserialized from strings. <code>JsonNetStreamReader</code>/<code>JilStreamReader</code> is deserialized from UTF-8 byte arrays using <code>StreamReader</code>. Deserialization is normally read from Stream. Thus, it will be restored from byte arrays (or Stream) instead of strings.</p>
<p dir="auto">MessagePack for C# <code>IntKey</code> is the fastest. <code>StringKey</code> is slower than <code>IntKey</code> because matching the character string of property names is required. <code>IntKey</code> works by reading the array length, then <code>for (array length) { binary decode }</code>. <code>StringKey</code> works by reading map length, <code>for (map length) { decode key, lookup key, binary decode }</code>, so it requires an additional two steps (decoding of keys and lookups of keys).</p>
<p dir="auto">String key is often a useful, contractless, simple replacement of JSON, interoperability with other languages, and more robust versioning. MessagePack for C# is also optimized for string keys as much a possible. First of all, it does not decode UTF-8 byte arrays to full string for matching with the member name; instead it will look up the byte arrays as it is (to avoid decoding costs and extra memory allocations).</p>
<p dir="auto">And It will try to match each <code>long type</code> (per 8 character, if it is not enough, pad with 0) using <a href="https://en.wikipedia.org/wiki/Automata_theory" rel="nofollow">automata</a> and inline it when generating IL code.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/46207/29754771-216b40e2-8bc7-11e7-8310-1c3602e80a08.png"><img src="https://user-images.githubusercontent.com/46207/29754771-216b40e2-8bc7-11e7-8310-1c3602e80a08.png" alt="image" style="max-width: 100%;"></a></p>
<p dir="auto">This also avoids calculating the hash code of byte arrays, and the comparison can be made several times faster using the long type.</p>
<p dir="auto">This is the sample of decompiled generated deserializer code, decompiled using <a href="http://ilspy.net/" rel="nofollow">ILSpy</a>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/46207/29754804-b5ba0f44-8bc7-11e7-9f6b-0c8f3c041237.png"><img src="https://user-images.githubusercontent.com/46207/29754804-b5ba0f44-8bc7-11e7-9f6b-0c8f3c041237.png" alt="image" style="max-width: 100%;"></a></p>
<p dir="auto">If the number of nodes is large, searches will use an embedded binary search.</p>
<p dir="auto">Extra note, this is serialization benchmark result.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th align="right">Mean</th>
<th align="right">Error</th>
<th align="right">Scaled</th>
<th align="right">Gen 0</th>
<th align="right">Allocated</th>
</tr>
</thead>
<tbody>
<tr>
<td>IntKey</td>
<td align="right">84.11 ns</td>
<td align="right">NA</td>
<td align="right">1.00</td>
<td align="right">0.0094</td>
<td align="right">40 B</td>
</tr>
<tr>
<td>StringKey</td>
<td align="right">126.75 ns</td>
<td align="right">NA</td>
<td align="right">1.51</td>
<td align="right">0.0341</td>
<td align="right">144 B</td>
</tr>
<tr>
<td>Typeless_IntKey</td>
<td align="right">183.31 ns</td>
<td align="right">NA</td>
<td align="right">2.18</td>
<td align="right">0.0265</td>
<td align="right">112 B</td>
</tr>
<tr>
<td>Typeless_StringKey</td>
<td align="right">193.95 ns</td>
<td align="right">NA</td>
<td align="right">2.31</td>
<td align="right">0.0513</td>
<td align="right">216 B</td>
</tr>
<tr>
<td>MsgPackCliMap</td>
<td align="right">967.68 ns</td>
<td align="right">NA</td>
<td align="right">11.51</td>
<td align="right">0.1297</td>
<td align="right">552 B</td>
</tr>
<tr>
<td>MsgPackCliArray</td>
<td align="right">284.20 ns</td>
<td align="right">NA</td>
<td align="right">3.38</td>
<td align="right">0.1006</td>
<td align="right">424 B</td>
</tr>
<tr>
<td>ProtobufNet</td>
<td align="right">176.43 ns</td>
<td align="right">NA</td>
<td align="right">2.10</td>
<td align="right">0.0665</td>
<td align="right">280 B</td>
</tr>
<tr>
<td>Hyperion</td>
<td align="right">280.14 ns</td>
<td align="right">NA</td>
<td align="right">3.33</td>
<td align="right">0.1674</td>
<td align="right">704 B</td>
</tr>
<tr>
<td>ZeroFormatter</td>
<td align="right">149.95 ns</td>
<td align="right">NA</td>
<td align="right">1.78</td>
<td align="right">0.1009</td>
<td align="right">424 B</td>
</tr>
<tr>
<td>JsonNetString</td>
<td align="right">1,432.55 ns</td>
<td align="right">NA</td>
<td align="right">17.03</td>
<td align="right">0.4616</td>
<td align="right">1944 B</td>
</tr>
<tr>
<td>JsonNetStreamWriter</td>
<td align="right">1,775.72 ns</td>
<td align="right">NA</td>
<td align="right">21.11</td>
<td align="right">1.5526</td>
<td align="right">6522 B</td>
</tr>
<tr>
<td>JilString</td>
<td align="right">547.51 ns</td>
<td align="right">NA</td>
<td align="right">6.51</td>
<td align="right">0.3481</td>
<td align="right">1464 B</td>
</tr>
<tr>
<td>JilStreamWriter</td>
<td align="right">778.78 ns</td>
<td align="right">NA</td>
<td align="right">9.26</td>
<td align="right">1.4448</td>
<td align="right">6066 B</td>
</tr>
</tbody>
</table>
<p dir="auto">Of course, <code>IntKey</code> is fastest but <code>StringKey</code> also performs reasonably well.</p>
<h6 dir="auto">
<a id="user-content-lz4-compression" class="anchor" aria-hidden="true" href="#lz4-compression"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>LZ4 Compression</h6>
<p dir="auto">MessagePack is a fast and <em>compact</em> format but it is not compression. <a href="https://github.com/lz4/lz4">LZ4</a> is an extremely fast compression algorithm, and using it MessagePack for C# can achieve extremely fast performance as well as extremely compact binary sizes!</p>
<p dir="auto">MessagePack for C# has built-in LZ4 support. You can activate it using a modified options object and passing it into an API like this:</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="var lz4Options = MessagePackSerializerOptions.Standard.WithCompression(MessagePackCompression.Lz4BlockArray);
MessagePackSerializer.Serialize(obj, lz4Options);"><pre><span class="pl-k">var</span> <span class="pl-en">lz4Options</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializerOptions</span>.<span class="pl-smi">Standard</span>.<span class="pl-en">WithCompression</span>(<span class="pl-smi">MessagePackCompression</span>.<span class="pl-smi">Lz4BlockArray</span>);
<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">obj</span>, <span class="pl-smi">lz4Options</span>);</pre></div>
<p dir="auto"><code>MessagePackCompression</code> has two modes, <code>Lz4Block</code> and <code>Lz4BlockArray</code>. Neither is a simple binary LZ4 compression, but a special compression integrated into the serialization pipeline, using MessagePack <code>ext</code> code (<code>Lz4BlockArray (98)</code> or <code>Lz4Block (99)</code>). Therefore, it is not readily compatible with compression offered in other languages.</p>
<p dir="auto"><code>Lz4Block</code> compresses an entire MessagePack sequence as a single LZ4 block. This is the simple compression that achieves best compression ratio, at the cost of copying the entire sequence when necessary to get contiguous memory.</p>
<p dir="auto"><code>Lz4BlockArray</code> compresses an entire MessagePack sequence as a array of LZ4 blocks. Compressed/decompressed blocks are  chunked and thus do not enter the GC's Large-Object-Heap, but the compression ratio is slightly worse.</p>
<p dir="auto">We recommend to use <code>Lz4BlockArray</code> as the default when using compression.
For compatibility with MessagePack v1.x, use <code>Lz4Block</code>.</p>
<p dir="auto">Regardless of which LZ4 option is set at the deserialization, both methods can be deserialized. For example, when the <code>Lz4BlockArray</code> option was used, binary data using either <code>Lz4Block</code> and <code>Lz4BlockArray</code> can be deserialized. Neither can be decompressed and hence deserialized when the compression option is set to <code>None</code>.</p>
<h7 dir="auto">
<a id="user-content-attributions" class="anchor" aria-hidden="true" href="#attributions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Attributions</h7>
<p dir="auto">LZ4 compression support is using Milosz Krajewski's <a href="https://github.com/MiloszKrajewski/lz4net">lz4net</a> code with some modifications.</p>
<h6 dir="auto">
<a id="user-content-comparison-with-protobuf-json-zeroformatter" class="anchor" aria-hidden="true" href="#comparison-with-protobuf-json-zeroformatter"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a name="user-content-comparison"></a>Comparison with protobuf, JSON, ZeroFormatter</h6>
<p dir="auto"><a href="https://github.com/mgravell/protobuf-net">protobuf-net</a> is major, widely used binary-format library on .NET. I love protobuf-net and respect their great work. But when you use protobuf-net as a general purpose serialization format, you may encounter an annoying issue.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[ProtoContract]
public class Parent
{
    [ProtoMember(1)]
    public int Primitive { get; set; }
    [ProtoMember(2)]
    public Child Prop { get; set; }
    [ProtoMember(3)]
    public int[] Array { get; set; }
}

[ProtoContract]
public class Child
{
    [ProtoMember(1)]
    public int Number { get; set; }
}

using (var ms = new MemoryStream())
{
    // serialize null.
    ProtoBuf.Serializer.Serialize&lt;Parent&gt;(ms, null);

    ms.Position = 0;
    var result = ProtoBuf.Serializer.Deserialize&lt;Parent&gt;(ms);

    Console.WriteLine(result != null); // True, not null. but all property are zero formatted.
    Console.WriteLine(result.Primitive); // 0
    Console.WriteLine(result.Prop); // null
    Console.WriteLine(result.Array); // null
}

using (var ms = new MemoryStream())
{
    // serialize empty array.
    ProtoBuf.Serializer.Serialize&lt;Parent&gt;(ms, new Parent { Array = System.Array.Empty&lt;int&gt;() });

    ms.Position = 0;
    var result = ProtoBuf.Serializer.Deserialize&lt;Parent&gt;(ms);

    Console.WriteLine(result.Array == null); // True, null!
}"><pre>[<span class="pl-en">ProtoContract</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Parent</span>
{
    [<span class="pl-en">ProtoMember</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Primitive</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
    [<span class="pl-en">ProtoMember</span>(<span class="pl-c1">2</span>)]
    <span class="pl-k">public</span> <span class="pl-en">Child</span> <span class="pl-en">Prop</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
    [<span class="pl-en">ProtoMember</span>(<span class="pl-c1">3</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span>[] <span class="pl-en">Array</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

[<span class="pl-en">ProtoContract</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Child</span>
{
    [<span class="pl-en">ProtoMember</span>(<span class="pl-c1">1</span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Number</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}

<span class="pl-k">using</span> (<span class="pl-en">var</span> <span class="pl-en">ms</span> <span class="pl-k">=</span> <span class="pl-en">new</span> <span class="pl-en">MemoryStream</span>())
{
    <span class="pl-c"><span class="pl-c">//</span> serialize null.</span>
    <span class="pl-en">ProtoBuf</span>.<span class="pl-en">Serializer</span>.<span class="pl-en">Serialize</span>&lt;<span class="pl-en">Parent</span>&gt;(<span class="pl-en">ms</span>, <span class="pl-en">null</span>);

    <span class="pl-smi">ms</span>.<span class="pl-smi">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
    <span class="pl-k">var</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-smi">ProtoBuf</span>.<span class="pl-smi">Serializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">Parent</span>&gt;(<span class="pl-smi">ms</span>);

    <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">result</span> <span class="pl-k">!=</span> <span class="pl-c1">null</span>); <span class="pl-c"><span class="pl-c">//</span> True, not null. but all property are zero formatted.</span>
    <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">result</span>.<span class="pl-smi">Primitive</span>); <span class="pl-c"><span class="pl-c">//</span> 0</span>
    <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">result</span>.<span class="pl-smi">Prop</span>); <span class="pl-c"><span class="pl-c">//</span> null</span>
    <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">result</span>.<span class="pl-smi">Array</span>); <span class="pl-c"><span class="pl-c">//</span> null</span>
}

<span class="pl-k">using</span> (<span class="pl-en">var</span> <span class="pl-en">ms</span> <span class="pl-k">=</span> <span class="pl-en">new</span> <span class="pl-en">MemoryStream</span>())
{
    <span class="pl-c"><span class="pl-c">//</span> serialize empty array.</span>
    <span class="pl-en">ProtoBuf</span>.<span class="pl-en">Serializer</span>.<span class="pl-en">Serialize</span>&lt;<span class="pl-en">Parent</span>&gt;(<span class="pl-en">ms</span>, <span class="pl-en">new</span> <span class="pl-en">Parent</span> { <span class="pl-en">Array</span> <span class="pl-k">=</span> <span class="pl-en">System</span>.<span class="pl-en">Array</span>.<span class="pl-en">Empty</span>&lt;<span class="pl-en">int</span>&gt;() });

    <span class="pl-smi">ms</span>.<span class="pl-smi">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
    <span class="pl-k">var</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-smi">ProtoBuf</span>.<span class="pl-smi">Serializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">Parent</span>&gt;(<span class="pl-smi">ms</span>);

    <span class="pl-smi">Console</span>.<span class="pl-en">WriteLine</span>(<span class="pl-smi">result</span>.<span class="pl-smi">Array</span> <span class="pl-k">==</span> <span class="pl-c1">null</span>); <span class="pl-c"><span class="pl-c">//</span> True, null!</span>
}</pre></div>
<p dir="auto">protobuf(-net) cannot handle null and empty collection correctly, because protobuf has no <code>null</code> representation (see <a href="https://stackoverflow.com/questions/21631428/protobuf-net-deserializes-empty-collection-to-null-when-the-collection-is-a-prop/21632160#21632160" rel="nofollow">this SO answer from a protobuf-net author</a>).</p>
<p dir="auto"><a href="https://github.com/msgpack/msgpack/blob/master/spec.md#type-system">MessagePack's type system</a> can correctly serialize the entire C# type system. This is a strong reason to recommend MessagePack over protobuf.</p>
<p dir="auto">Protocol Buffers have good IDL and <a href="https://www.grpc.io/" rel="nofollow">gRPC</a> support. If you want to use IDL, I recommend <a href="https://github.com/google/protobuf/tree/master/csharp/src/Google.Protobuf">Google.Protobuf</a> over MessagePack.</p>
<p dir="auto">JSON is good general-purpose format. It is simple, human-readable and thoroughly-enough specified. <a href="https://github.com/neuecc/Utf8Json">Utf8Json</a> - which I created as well - adopts same architecture as MessagePack for C# and avoids encoding/decoding costs as much as possible just like this library does. If you want to know more about binary vs text formats, see <a href="https://github.com/neuecc/Utf8Json#which-serializer-should-be-used">Utf8Json/which serializer should be used</a>.</p>
<p dir="auto"><a href="https://github.com/neuecc/ZeroFormatter/">ZeroFormatter</a> is similar as <a href="https://google.github.io/flatbuffers/" rel="nofollow">FlatBuffers</a> but specialized to C#, and special in that regard. Deserialization is infinitely fast but the produced binary size is larger. And ZeroFormatter's caching algorithm requires additional memory.</p>
<p dir="auto">For many common uses, MessagePack for C# would be a better fit.</p>
<h6 dir="auto">
<a id="user-content-hints-to-achieve-maximum-performance-when-using-messagepack-for-c" class="anchor" aria-hidden="true" href="#hints-to-achieve-maximum-performance-when-using-messagepack-for-c"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Hints to achieve maximum performance when using MessagePack for C#</h6>
<p dir="auto">MessagePack for C# prioritizes maximum performance by default. However, there are also some options that sacrifice performance for convenience.</p>
<h7 dir="auto">
<a id="user-content-use-indexed-keys-instead-of-string-keys-contractless" class="anchor" aria-hidden="true" href="#use-indexed-keys-instead-of-string-keys-contractless"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use indexed keys instead of string keys (Contractless)</h7>
<p dir="auto">The <a href="https://github.com/neuecc/MessagePack-CSharp#deserialize-performance">Deserialization Performance for different options</a> section shows the results of indexed keys (<code>IntKey</code>) vs string keys (<code>StringKey</code>) performance. Indexed keys serialize the object graph as a MessagePack array. String keys serializes the object graph as a MessagePack map.</p>
<p dir="auto">For example this type is serialized to</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='[MessagePackObject]
public class Person
{
    [Key(0)] or [Key("name")]
    public string Name { get; set;}
    [Key(1)] or [Key("age")]
    public int Age { get; set;}
}

new Person { Name = "foobar", Age = 999 }'><pre>[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Person</span>
{
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)] or [<span class="pl-en">Key</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)]
    <span class="pl-k">public</span> <span class="pl-k">string</span> <span class="pl-en">Name</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>;}
    [<span class="pl-en">Key</span>(<span class="pl-c1">1</span>)] or [<span class="pl-en">Key</span>(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>)]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Age</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>;}
}

<span class="pl-k">new</span> <span class="pl-smi">Person</span> { <span class="pl-smi">Name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>foobar<span class="pl-pds">"</span></span>, <span class="pl-smi">Age</span> <span class="pl-k">=</span> <span class="pl-c1">999</span> }</pre></div>
<ul dir="auto">
<li>
<code>IntKey</code>: <code>["foobar", 999]</code>
</li>
<li>
<code>StringKey</code>: <code>{"name:"foobar","age":999}</code>.</li>
</ul>
<p dir="auto"><code>IntKey</code> is always fast in both serialization and deserialization because it does not have to handle and lookup key names, and always has the smaller binary size.</p>
<p dir="auto"><code>StringKey</code> is often a useful, contractless, simple replacement for JSON, interoperability with other languages with MessagePack support, and less error prone versioning. But to achieve maximum performance, use <code>IntKey</code>.</p>
<h7 dir="auto">
<a id="user-content-create-own-custom-composite-resolver" class="anchor" aria-hidden="true" href="#create-own-custom-composite-resolver"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Create own custom composite resolver</h7>
<p dir="auto"><code>CompositeResolver.Create</code> is an easy way to create composite resolvers. But formatter lookups have some overhead. If you create a custom resolver (or use <code>StaticCompositeResolver.Instance</code>), you can avoid this overhead.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="public class MyApplicationResolver : IFormatterResolver
{
    public static readonly IFormatterResolver Instance = new MyApplicationResolver();

    // configure your custom resolvers.
    private static readonly IFormatterResolver[] Resolvers = new IFormatterResolver[]
    {
    };

    private MyApplicationResolver() { }

    public IMessagePackFormatter&lt;T&gt; GetFormatter&lt;T&gt;()
    {
        return Cache&lt;T&gt;.Formatter;
    }

    private static class Cache&lt;T&gt;
    {
        public static IMessagePackFormatter&lt;T&gt; Formatter;

        static Cache()
        {
            // configure your custom formatters.
            if (typeof(T) == typeof(XXX))
            {
                Formatter = new ICustomFormatter();
                return;
            }

            foreach (var resolver in Resolvers)
            {
                var f = resolver.GetFormatter&lt;T&gt;();
                if (f != null)
                {
                    Formatter = f;
                    return;
                }
            }
        }
    }
}"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">MyApplicationResolver</span> : <span class="pl-en">IFormatterResolver</span>
{
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">readonly</span> <span class="pl-en">IFormatterResolver</span> <span class="pl-en">Instance</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">MyApplicationResolver</span>();

    <span class="pl-c"><span class="pl-c">//</span> configure your custom resolvers.</span>
    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">readonly</span> <span class="pl-en">IFormatterResolver</span>[] <span class="pl-en">Resolvers</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">IFormatterResolver</span>[]
    {
    };

    <span class="pl-k">private</span> <span class="pl-en">MyApplicationResolver</span>() { }

    <span class="pl-k">public</span> <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">T</span>&gt; <span class="pl-en">GetFormatter</span>&lt;<span class="pl-en">T</span>&gt;()
    {
        <span class="pl-k">return</span> <span class="pl-smi">Cache</span>&lt;<span class="pl-en">T</span>&gt;.<span class="pl-smi">Formatter</span>;
    }

    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">Cache</span>&lt;<span class="pl-en">T</span>&gt;
    {
        <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">T</span>&gt; <span class="pl-en">Formatter</span>;

        <span class="pl-k">static</span> <span class="pl-en">Cache</span>()
        {
            <span class="pl-c"><span class="pl-c">//</span> configure your custom formatters.</span>
            <span class="pl-k">if</span> (<span class="pl-k">typeof</span>(<span class="pl-en">T</span>) <span class="pl-k">==</span> <span class="pl-k">typeof</span>(<span class="pl-en">XXX</span>))
            {
                <span class="pl-smi">Formatter</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">ICustomFormatter</span>();
                <span class="pl-k">return</span>;
            }

            <span class="pl-k">foreach</span> (<span class="pl-k">var</span> <span class="pl-en">resolver</span> <span class="pl-k">in</span> <span class="pl-smi">Resolvers</span>)
            {
                <span class="pl-k">var</span> <span class="pl-en">f</span> <span class="pl-k">=</span> <span class="pl-smi">resolver</span>.<span class="pl-en">GetFormatter</span>&lt;<span class="pl-en">T</span>&gt;();
                <span class="pl-k">if</span> (<span class="pl-smi">f</span> <span class="pl-k">!=</span> <span class="pl-c1">null</span>)
                {
                    <span class="pl-smi">Formatter</span> <span class="pl-k">=</span> <span class="pl-smi">f</span>;
                    <span class="pl-k">return</span>;
                }
            }
        }
    }
}</pre></div>
<blockquote>
<p dir="auto">NOTE: If you are creating a library, recommend using the above custom resolver instead of <code>CompositeResolver.Create</code>. Also, libraries must not use <code>StaticCompositeResolver</code> - as it is global state - to avoid compatibility issues.</p>
</blockquote>
<h7 dir="auto">
<a id="user-content-use-native-resolvers" class="anchor" aria-hidden="true" href="#use-native-resolvers"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use native resolvers</h7>
<p dir="auto">By default, MessagePack for C# serializes GUID as string. This is much slower than the native .NET format GUID. The same applies to Decimal. If your application makes heavy use of GUID or Decimal and you don't have to worry about interoperability with other languages, you can replace them with the native serializers <code>NativeGuidResolver</code> and <code>NativeDecimalResolver</code> respectively.</p>
<p dir="auto">Also, <code>DateTime</code> is serialized using the MessagePack timestamp format. By using the <code>NativeDateTimeResolver</code>, it is possible to maintain Kind and perform faster serialization.</p>
<h7 dir="auto">
<a id="user-content-be-careful-when-copying-buffers" class="anchor" aria-hidden="true" href="#be-careful-when-copying-buffers"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Be careful when copying buffers</h7>
<p dir="auto"><code>MessagePackSerializer.Serialize</code> returns <code>byte[]</code> in default. The final <code>byte[]</code> is copied from an internal buffer pool. That is an extra cost.  You can use <code>IBufferWriter&lt;T&gt;</code> or the <code>Stream</code> API to write to buffers directly. If you want to use a buffer pool outside of the serializer, you should implement custom <code>IBufferWriter&lt;byte&gt;</code> or use an existing one such as <a href="https://github.com/AArnott/Nerdbank.Streams/blob/master/doc/Sequence.md"><code>Sequence&lt;T&gt;</code></a> from the <a href="https://nuget.org/packages/Nerdbank.Streams" rel="nofollow">Nerdbank.Streams</a> package.</p>
<p dir="auto">During deserialization, <code>MessagePackSerializer.Deserialize(ReadOnlyMemory&lt;byte&gt; buffer)</code> is better than the <code>Deserialize(Stream stream)</code> overload. This is because the Stream API version starts by reading the data, generating a <code>ReadOnlySequence&lt;byte&gt;</code>, and only then starts the deserialization.</p>
<h7 dir="auto">
<a id="user-content-choosing-compression" class="anchor" aria-hidden="true" href="#choosing-compression"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Choosing compression</h7>
<p dir="auto">Compression is generally effective when there is duplicate data. In MessagePack, arrays containing objects using string keys (Contractless) can be compressed efficiently because compression can be applied to many duplicate property names. Indexed keys compression is not as effectively compressed as string keys, but indexed keys are smaller in the first place.</p>
<p dir="auto">This is some example benchmark performance data;</p>
<table>
<thead>
<tr>
<th>Serializer</th>
<th align="right">Mean</th>
<th align="right">DataSize</th>
</tr>
</thead>
<tbody>
<tr>
<td>IntKey</td>
<td align="right">2.941 us</td>
<td align="right">469.00 B</td>
</tr>
<tr>
<td>IntKey(Lz4)</td>
<td align="right">3.449 us</td>
<td align="right">451.00 B</td>
</tr>
<tr>
<td>StringKey</td>
<td align="right">4.340 us</td>
<td align="right">1023.00 B</td>
</tr>
<tr>
<td>StringKey(Lz4)</td>
<td align="right">5.469 us</td>
<td align="right">868.00 B</td>
</tr>
</tbody>
</table>
<p dir="auto"><code>IntKey(Lz4)</code> is not as effectively compressed, but performance is still somewhat degraded. On the other hand, <code>StringKey</code> can be expected to have a sufficient effect on the binary size. However, this is just an example. Compression can be quite effective depending on the data, too, or have little effect other than slowing down your program. There are also cases in which well-compressible data exists in the values (such as long strings, e.g. containing HTML data with many repeated HTML tags). It is important to verify the actual effects of compression on a case by case basis.</p>
<h6 dir="auto">
<a id="user-content-extensions" class="anchor" aria-hidden="true" href="#extensions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Extensions</h6>
<p dir="auto">MessagePack for C# has extension points that enable you to provide optimal serialization support for custom types. There are official extension support packages.</p>
<div class="highlight highlight-source-powershell position-relative overflow-auto" data-snippet-clipboard-copy-content="Install-Package MessagePack.ReactiveProperty
Install-Package MessagePack.UnityShims
Install-Package MessagePack.AspNetCoreMvcFormatter"><pre><span class="pl-c1">Install-Package</span> MessagePack.ReactiveProperty
<span class="pl-c1">Install-Package</span> MessagePack.UnityShims
<span class="pl-c1">Install-Package</span> MessagePack.AspNetCoreMvcFormatter</pre></div>
<p dir="auto">The <code>MessagePack.ReactiveProperty</code> package adds support for types of the <a href="https://github.com/runceel/ReactiveProperty">ReactiveProperty</a> library. It adds <code>ReactiveProperty&lt;&gt;</code>, <code>IReactiveProperty&lt;&gt;</code>, <code>IReadOnlyReactiveProperty&lt;&gt;</code>, <code>ReactiveCollection&lt;&gt;</code>, <code>Unit</code> serialization support. It is useful for save viewmodel state.</p>
<p dir="auto">The <code>MessagePack.UnityShims</code> package provides shims for <a href="https://unity3d.com/" rel="nofollow">Unity</a>'s standard structs (<code>Vector2</code>, <code>Vector3</code>, <code>Vector4</code>, <code>Quaternion</code>, <code>Color</code>, <code>Bounds</code>, <code>Rect</code>, <code>AnimationCurve</code>, <code>Keyframe</code>, <code>Matrix4x4</code>, <code>Gradient</code>, <code>Color32</code>, <code>RectOffset</code>, <code>LayerMask</code>, <code>Vector2Int</code>, <code>Vector3Int</code>, <code>RangeInt</code>, <code>RectInt</code>, <code>BoundsInt</code>) and corresponding formatters. It can enable proper communication between servers and Unity clients.</p>
<p dir="auto">After installation, extension packages must be enabled, by creating composite resolvers. Here is an example showing how to enable all extensions.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// Set extensions to default resolver.
var resolver = MessagePack.Resolvers.CompositeResolver.Create(
    // enable extension packages first
    ReactivePropertyResolver.Instance,
    MessagePack.Unity.Extension.UnityBlitResolver.Instance,
    MessagePack.Unity.UnityResolver.Instance,

    // finally use standard (default) resolver
    StandardResolver.Instance
);
var options = MessagePackSerializerOptions.Standard.WithResolver(resolver);

// Pass options every time or set as default
MessagePackSerializer.DefaultOptions = options;"><pre><span class="pl-c"><span class="pl-c">//</span> Set extensions to default resolver.</span>
<span class="pl-k">var</span> <span class="pl-en">resolver</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">CompositeResolver</span>.<span class="pl-en">Create</span>(
    <span class="pl-c"><span class="pl-c">//</span> enable extension packages first</span>
    <span class="pl-smi">ReactivePropertyResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Unity</span>.<span class="pl-smi">Extension</span>.<span class="pl-smi">UnityBlitResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Unity</span>.<span class="pl-smi">UnityResolver</span>.<span class="pl-smi">Instance</span>,

    <span class="pl-c"><span class="pl-c">//</span> finally use standard (default) resolver</span>
    <span class="pl-smi">StandardResolver</span>.<span class="pl-smi">Instance</span>
);
<span class="pl-k">var</span> <span class="pl-en">options</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializerOptions</span>.<span class="pl-smi">Standard</span>.<span class="pl-en">WithResolver</span>(<span class="pl-smi">resolver</span>);

<span class="pl-c"><span class="pl-c">//</span> Pass options every time or set as default</span>
<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-smi">DefaultOptions</span> <span class="pl-k">=</span> <span class="pl-smi">options</span>;</pre></div>
<p dir="auto">For configuration details, see: <a href="#resolvers">Extension Point section</a>.</p>
<p dir="auto">The <code>MessagePack.AspNetCoreMvcFormatter</code> is add-on for <a href="https://github.com/aspnet/Mvc">ASP.NET Core MVC</a>'s serialization to boost up performance. This is configuration sample.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc().AddMvcOptions(option =&gt;
    {
        option.OutputFormatters.Clear();
        option.OutputFormatters.Add(new MessagePackOutputFormatter(ContractlessStandardResolver.Options));
        option.InputFormatters.Clear();
        option.InputFormatters.Add(new MessagePackInputFormatter(ContractlessStandardResolver.Options));
    });
}"><pre><span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">ConfigureServices</span>(<span class="pl-en">IServiceCollection</span> <span class="pl-en">services</span>)
{
    <span class="pl-smi">services</span>.<span class="pl-en">AddMvc</span>().<span class="pl-en">AddMvcOptions</span>(<span class="pl-en">option</span> <span class="pl-k">=&gt;</span>
    {
        <span class="pl-smi">option</span>.<span class="pl-smi">OutputFormatters</span>.<span class="pl-en">Clear</span>();
        <span class="pl-smi">option</span>.<span class="pl-smi">OutputFormatters</span>.<span class="pl-en">Add</span>(<span class="pl-k">new</span> <span class="pl-en">MessagePackOutputFormatter</span>(<span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Options</span>));
        <span class="pl-smi">option</span>.<span class="pl-smi">InputFormatters</span>.<span class="pl-en">Clear</span>();
        <span class="pl-smi">option</span>.<span class="pl-smi">InputFormatters</span>.<span class="pl-en">Add</span>(<span class="pl-k">new</span> <span class="pl-en">MessagePackInputFormatter</span>(<span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Options</span>));
    });
}</pre></div>
<p dir="auto">Other authors are creating extension packages, too.</p>
<ul dir="auto">
<li>
<a href="https://github.com/Cysharp/MagicOnion">MagicOnion</a> - gRPC based HTTP/2 RPC Streaming Framework</li>
<li>
<a href="https://github.com/Cysharp/MasterMemory">MasterMemory</a> - Embedded Readonly In-Memory Document Database</li>
</ul>
<p dir="auto">You can make your own extension serializers or integrate with frameworks. Let's create and share!</p>
<ul dir="auto">
<li>
<a href="https://github.com/pocketberserker/MessagePack.FSharpExtensions">MessagePack.FSharpExtensions</a> - supports F# list, set, map, unit, option, discriminated union</li>
<li>
<a href="https://github.com/ARKlab/MessagePack">MessagePack.NodaTime</a> - Support for NodaTime types to MessagePack C#</li>
<li>
<a href="https://github.com/WebApiContrib/WebAPIContrib.Core#formatters">WebApiContrib.Core.Formatter.MessagePack</a> - supports ASP.NET Core MVC (<a href="https://www.strathweb.com/2017/06/using-messagepack-with-asp-net-core-mvc/" rel="nofollow">details in blog post</a>)</li>
<li>
<a href="https://github.com/sketch7/MessagePack.MediaTypeFormatter">MessagePack.MediaTypeFormatter</a> - MessagePack MediaTypeFormatter</li>
</ul>
<h6 dir="auto">
<a id="user-content-experimental-features" class="anchor" aria-hidden="true" href="#experimental-features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Experimental Features</h6>
<p dir="auto">MessagePack for C# has experimental features which provides you with very performant formatters. There is an official package.</p>
<div class="highlight highlight-source-powershell position-relative overflow-auto" data-snippet-clipboard-copy-content="Install-Package MessagePack.Experimental"><pre><span class="pl-c1">Install-Package</span> MessagePack.Experimental</pre></div>
<p dir="auto">For detailed information, see: <a href="/neuecc/MessagePack-CSharp/blob/master/src/MessagePack.Experimental/Experimental.md">Experimental.md</a></p>
<h5 dir="auto">
<a id="user-content-api" class="anchor" aria-hidden="true" href="#api"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>API</h5>
<h6 dir="auto">
<a id="user-content-high-level-api-messagepackserializer" class="anchor" aria-hidden="true" href="#high-level-api-messagepackserializer"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>High-Level API (<code>MessagePackSerializer</code>)</h6>
<p dir="auto">The <code>MessagePackSerializer</code> class is the entry point of MessagePack for C#. Static methods make up the main API of MessagePack for C#.</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Serialize&lt;T&gt;</code></td>
<td>Serializes an object graph to a MessagePack binary blob. Async variant for Stream available. Non-generic overloads available.</td>
</tr>
<tr>
<td><code>Deserialize&lt;T&gt;</code></td>
<td>Deserializes a MessagePack binary to an object graph. Async variant for Stream available. Non-generic overloads available.</td>
</tr>
<tr>
<td><code>SerializeToJson</code></td>
<td>Serialize a MessagePack-compatible object graph to JSON instead of MessagePack. Useful for debugging.</td>
</tr>
<tr>
<td><code>ConvertToJson</code></td>
<td>Convert MessagePack binary to JSON. Useful for debugging.</td>
</tr>
<tr>
<td><code>ConvertFromJson</code></td>
<td>Convert JSON to a MessagePack binary.</td>
</tr>
</tbody>
</table>
<p dir="auto">The <code>MessagePackSerializer.Typeless</code> class offers most of the same APIs as above, but removes all type arguments from the API, forcing serialization to include the full type name of the root object. It uses the <code>TypelessContractlessStandardResolver</code>. Consider the result to be a .NET-specific MessagePack binary that isn't readily compatible with MessagePack deserializers in other runtimes.</p>
<p dir="auto">MessagePack for C# fundamentally serializes using <code>IBufferWriter&lt;byte&gt;</code> and deserializes using <code>ReadOnlySequence&lt;byte&gt;</code> or <code>Memory&lt;byte&gt;</code>. Method overloads are provided to conveniently use it with common buffer types and the .NET <code>Stream</code> class, but some of these convenience overloads require copying buffers once and therefore have a certain overhead.</p>
<p dir="auto">The high-level API uses a memory pool internally to avoid unnecessary memory allocation. If result size is under 64K, it allocates GC memory only for the return bytes.</p>
<p dir="auto">Each serialize/deserialize method takes an optional <code>MessagePackSerializerOptions</code> parameter which can be used to specify a custom <code>IFormatterResolver</code> to use or to activate LZ4 compression support.</p>
<h7 dir="auto">
<a id="user-content-multiple-messagepack-structures-on-a-single-stream" class="anchor" aria-hidden="true" href="#multiple-messagepack-structures-on-a-single-stream"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Multiple MessagePack structures on a single <code>Stream</code>
</h7>
<p dir="auto">To deserialize a <code>Stream</code> that contains multiple consecutive MessagePack data structures,
you can use the <code>MessagePackStreamReader</code> class to efficiently identify the <code>ReadOnlySequence&lt;byte&gt;</code>
for each data structure and deserialize it. For example:</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="static async Task&lt;List&lt;T&gt;&gt; DeserializeListFromStreamAsync&lt;T&gt;(Stream stream, CancellationToken cancellationToken)
{
    var dataStructures = new List&lt;T&gt;();
    using (var streamReader = new MessagePackStreamReader(stream))
    {
        while (await streamReader.ReadAsync(cancellationToken) is ReadOnlySequence&lt;byte&gt; msgpack)
        {
            dataStructures.Add(MessagePackSerializer.Deserialize&lt;T&gt;(msgpack, cancellationToken: cancellationToken));
        }
    }

    return dataStructures;
}"><pre><span class="pl-k">static</span> <span class="pl-k">async</span> <span class="pl-en">Task</span>&lt;<span class="pl-en">List</span>&lt;<span class="pl-en">T</span>&gt;&gt; <span class="pl-en">DeserializeListFromStreamAsync</span>&lt;<span class="pl-en">T</span>&gt;(<span class="pl-en">Stream</span> <span class="pl-en">stream</span>, <span class="pl-en">CancellationToken</span> <span class="pl-en">cancellationToken</span>)
{
    <span class="pl-k">var</span> <span class="pl-en">dataStructures</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">List</span>&lt;<span class="pl-en">T</span>&gt;();
    <span class="pl-k">using</span> (<span class="pl-k">var</span> <span class="pl-en">streamReader</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">MessagePackStreamReader</span>(<span class="pl-smi">stream</span>))
    {
        <span class="pl-k">while</span> (<span class="pl-k">await</span> <span class="pl-smi">streamReader</span>.<span class="pl-en">ReadAsync</span>(<span class="pl-smi">cancellationToken</span>) <span class="pl-k">is</span> <span class="pl-en">ReadOnlySequence</span>&lt;<span class="pl-k">byte</span>&gt; <span class="pl-smi">msgpack</span>)
        {
            <span class="pl-smi">dataStructures</span>.<span class="pl-en">Add</span>(<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">T</span>&gt;(<span class="pl-smi">msgpack</span>, <span class="pl-en">cancellationToken</span>: <span class="pl-smi">cancellationToken</span>));
        }
    }

    <span class="pl-k">return</span> <span class="pl-smi">dataStructures</span>;
}</pre></div>
<h6 dir="auto">
<a id="user-content-low-level-api-imessagepackformattert" class="anchor" aria-hidden="true" href="#low-level-api-imessagepackformattert"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Low-Level API (<code>IMessagePackFormatter&lt;T&gt;</code>)</h6>
<p dir="auto">The <code>IMessagePackFormatter&lt;T&gt;</code> interface is responsible for serializing a unique type. For example <code>Int32Formatter : IMessagePackFormatter&lt;Int32&gt;</code> represents Int32 MessagePack serializer.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="public interface IMessagePackFormatter&lt;T&gt;
{
    void Serialize(ref MessagePackWriter writer, T value, MessagePackSerializerOptions options);
    T Deserialize(ref MessagePackReader reader, MessagePackSerializerOptions options);
}"><pre><span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">T</span>&gt;
{
    <span class="pl-k">void</span> <span class="pl-en">Serialize</span>(<span class="pl-k">ref</span> <span class="pl-en">MessagePackWriter</span> <span class="pl-en">writer</span>, <span class="pl-en">T</span> <span class="pl-en">value</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>);
    <span class="pl-en">T</span> <span class="pl-en">Deserialize</span>(<span class="pl-k">ref</span> <span class="pl-en">MessagePackReader</span> <span class="pl-en">reader</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>);
}</pre></div>
<p dir="auto">Many built-in formatters exists under <code>MessagePack.Formatters</code>. Your custom types are usually automatically supported with the built-in type resolvers that generate new <code>IMessagePackFormatter&lt;T&gt;</code> types on-the-fly using dynamic code generation. See our <a href="#aot">AOT code generation</a> support for platforms that do not support this.</p>
<p dir="auto">However, some types - especially those provided by third party libraries or the runtime itself - cannot be appropriately annotated, and contractless serialization would produce inefficient or even wrong results.
To take more control over the serialization of such custom types, write your own <code>IMessagePackFormatter&lt;T&gt;</code> implementation.
Here is an example of such a custom formatter implementation. Note its use of the primitive API that is described in the next section.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content='/// &lt;summary&gt;Serializes a &lt;see cref="FileInfo" /&gt; by its full path as a string.&lt;/summary&gt;
public class FileInfoFormatter : IMessagePackFormatter&lt;FileInfo&gt;
{
    public void Serialize(
      ref MessagePackWriter writer, FileInfo value, MessagePackSerializerOptions options)
    {
        if (value == null)
        {
            writer.WriteNil();
            return;
        }

        writer.WriteString(value.FullName);
    }

    public FileInfo Deserialize(
      ref MessagePackReader reader, MessagePackSerializerOptions options)
    {
        if (reader.TryReadNil())
        {
            return null;
        }

        options.Security.DepthStep(ref reader);

        var path = reader.ReadString();

        reader.Depth--;
        return new FileInfo(path);
    }
}'><pre><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;Serializes a &lt;<span class="pl-ent"><span class="pl-ent">see</span></span> <span class="pl-e"><span class="pl-e">cref</span></span>=<span class="pl-s"><span class="pl-pds">"</span>FileInfo<span class="pl-pds">"</span></span> /&gt; by its full path as a string.&lt;/<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">FileInfoFormatter</span> : <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">FileInfo</span>&gt;
{
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">Serialize</span>(
      <span class="pl-k">ref</span> <span class="pl-en">MessagePackWriter</span> <span class="pl-en">writer</span>, <span class="pl-en">FileInfo</span> <span class="pl-en">value</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
    {
        <span class="pl-k">if</span> (<span class="pl-smi">value</span> <span class="pl-k">==</span> <span class="pl-c1">null</span>)
        {
            <span class="pl-smi">writer</span>.<span class="pl-en">WriteNil</span>();
            <span class="pl-k">return</span>;
        }

        <span class="pl-smi">writer</span>.<span class="pl-en">WriteString</span>(<span class="pl-smi">value</span>.<span class="pl-smi">FullName</span>);
    }

    <span class="pl-k">public</span> <span class="pl-en">FileInfo</span> <span class="pl-en">Deserialize</span>(
      <span class="pl-k">ref</span> <span class="pl-en">MessagePackReader</span> <span class="pl-en">reader</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
    {
        <span class="pl-k">if</span> (<span class="pl-smi">reader</span>.<span class="pl-en">TryReadNil</span>())
        {
            <span class="pl-k">return</span> <span class="pl-c1">null</span>;
        }

        <span class="pl-smi">options</span>.<span class="pl-smi">Security</span>.<span class="pl-en">DepthStep</span>(<span class="pl-k">ref</span> <span class="pl-smi">reader</span>);

        <span class="pl-k">var</span> <span class="pl-en">path</span> <span class="pl-k">=</span> <span class="pl-smi">reader</span>.<span class="pl-en">ReadString</span>();

        <span class="pl-smi">reader</span>.<span class="pl-smi">Depth</span><span class="pl-k">--</span>;
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-en">FileInfo</span>(<span class="pl-smi">path</span>);
    }
}</pre></div>
<p dir="auto">The <code>DepthStep</code> and <code>Depth--</code> statements provide a level of security while deserializing untrusted data
that might otherwise be able to execute a denial of service attack by sending MessagePack data that would
deserialize into a very deep object graph leading to a <code>StackOverflowException</code> that would crash the process.
This pair of statements should surround the bulk of any <code>IMessagePackFormatter&lt;T&gt;.Deserialize</code> method.</p>
<p dir="auto"><strong>Important</strong>: A message pack formatter must <em>read or write exactly one data structure</em>.
In the above example we just read/write a string. If you have more than one element to write out,
you must precede it with a map or array header. You must read the entire map/array when deserializing.
For example:</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="public class MySpecialObjectFormatter : IMessagePackFormatter&lt;MySpecialObject&gt;
{
    public void Serialize(
      ref MessagePackWriter writer, MySpecialObject value, MessagePackSerializerOptions options)
    {
        if (value == null)
        {
            writer.WriteNil();
            return;
        }

        writer.WriteArrayHeader(2);
        writer.WriteString(value.FullName);
        writer.WriteString(value.Age);
    }

    public MySpecialObject Deserialize(
      ref MessagePackReader reader, MessagePackSerializerOptions options)
    {
        if (reader.TryReadNil())
        {
            return null;
        }

        options.Security.DepthStep(ref reader);

        string fullName = null;
        int age = 0;

        // Loop over *all* array elements independently of how many we expect,
        // since if we're serializing an older/newer version of this object it might
        // vary in number of elements that were serialized, but the contract of the formatter
        // is that exactly one data structure must be read, regardless.
        // Alternatively, we could check that the size of the array/map is what we expect
        // and throw if it is not.
        int count = reader.ReadArrayHeader();
        for (int i = 0; i &lt; count; i++)
        {
            switch (i)
            {
                case 0:
                    fullName = reader.ReadString();
                    break;
                case 1:
                    age = reader.ReadInt32();
                    break;
                default:
                    reader.Skip();
                    break;
            }
        }

        reader.Depth--;
        return new MySpecialObject(fullName, age);
    }
}"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">MySpecialObjectFormatter</span> : <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">MySpecialObject</span>&gt;
{
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">Serialize</span>(
      <span class="pl-k">ref</span> <span class="pl-en">MessagePackWriter</span> <span class="pl-en">writer</span>, <span class="pl-en">MySpecialObject</span> <span class="pl-en">value</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
    {
        <span class="pl-k">if</span> (<span class="pl-smi">value</span> <span class="pl-k">==</span> <span class="pl-c1">null</span>)
        {
            <span class="pl-smi">writer</span>.<span class="pl-en">WriteNil</span>();
            <span class="pl-k">return</span>;
        }

        <span class="pl-smi">writer</span>.<span class="pl-en">WriteArrayHeader</span>(<span class="pl-c1">2</span>);
        <span class="pl-smi">writer</span>.<span class="pl-en">WriteString</span>(<span class="pl-smi">value</span>.<span class="pl-smi">FullName</span>);
        <span class="pl-smi">writer</span>.<span class="pl-en">WriteString</span>(<span class="pl-smi">value</span>.<span class="pl-smi">Age</span>);
    }

    <span class="pl-k">public</span> <span class="pl-en">MySpecialObject</span> <span class="pl-en">Deserialize</span>(
      <span class="pl-k">ref</span> <span class="pl-en">MessagePackReader</span> <span class="pl-en">reader</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
    {
        <span class="pl-k">if</span> (<span class="pl-smi">reader</span>.<span class="pl-en">TryReadNil</span>())
        {
            <span class="pl-k">return</span> <span class="pl-c1">null</span>;
        }

        <span class="pl-smi">options</span>.<span class="pl-smi">Security</span>.<span class="pl-en">DepthStep</span>(<span class="pl-k">ref</span> <span class="pl-smi">reader</span>);

        <span class="pl-k">string</span> <span class="pl-en">fullName</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
        <span class="pl-k">int</span> <span class="pl-en">age</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;

        <span class="pl-c"><span class="pl-c">//</span> Loop over *all* array elements independently of how many we expect,</span>
        <span class="pl-c"><span class="pl-c">//</span> since if we're serializing an older/newer version of this object it might</span>
        <span class="pl-c"><span class="pl-c">//</span> vary in number of elements that were serialized, but the contract of the formatter</span>
        <span class="pl-c"><span class="pl-c">//</span> is that exactly one data structure must be read, regardless.</span>
        <span class="pl-c"><span class="pl-c">//</span> Alternatively, we could check that the size of the array/map is what we expect</span>
        <span class="pl-c"><span class="pl-c">//</span> and throw if it is not.</span>
        <span class="pl-k">int</span> <span class="pl-en">count</span> <span class="pl-k">=</span> <span class="pl-smi">reader</span>.<span class="pl-en">ReadArrayHeader</span>();
        <span class="pl-k">for</span> (<span class="pl-k">int</span> <span class="pl-en">i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">i</span> <span class="pl-k">&lt;</span> <span class="pl-smi">count</span>; <span class="pl-smi">i</span><span class="pl-k">++</span>)
        {
            <span class="pl-k">switch</span> (<span class="pl-smi">i</span>)
            {
                <span class="pl-k">case</span> <span class="pl-c1">0</span>:
                    <span class="pl-smi">fullName</span> <span class="pl-k">=</span> <span class="pl-smi">reader</span>.<span class="pl-en">ReadString</span>();
                    <span class="pl-k">break</span>;
                <span class="pl-k">case</span> <span class="pl-c1">1</span>:
                    <span class="pl-smi">age</span> <span class="pl-k">=</span> <span class="pl-smi">reader</span>.<span class="pl-en">ReadInt32</span>();
                    <span class="pl-k">break</span>;
                <span class="pl-k">default</span>:
                    <span class="pl-smi">reader</span>.<span class="pl-en">Skip</span>();
                    <span class="pl-k">break</span>;
            }
        }

        <span class="pl-smi">reader</span>.<span class="pl-smi">Depth</span><span class="pl-k">--</span>;
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-en">MySpecialObject</span>(<span class="pl-smi">fullName</span>, <span class="pl-smi">age</span>);
    }
}</pre></div>
<p dir="auto">Your custom formatters must be discoverable via some <code>IFormatterResolver</code>. Learn more in our <a href="#resolvers">resolvers</a> section.</p>
<p dir="auto">You can see many other samples from <a href="https://github.com/neuecc/MessagePack-CSharp/tree/master/src/MessagePack/Formatters">builtin formatters</a>.</p>
<h6 dir="auto">
<a id="user-content-primitive-api-messagepackwriter-messagepackreader" class="anchor" aria-hidden="true" href="#primitive-api-messagepackwriter-messagepackreader"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Primitive API (<code>MessagePackWriter</code>, <code>MessagePackReader</code>)</h6>
<p dir="auto">The <code>MessagePackWriter</code> and <code>MessagePackReader</code> structs make up the lowest-level API. They read and write the primitives types defined in the MessagePack specification.</p>
<h7 dir="auto">
<a id="user-content-messagepackreader" class="anchor" aria-hidden="true" href="#messagepackreader"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>MessagePackReader</code>
</h7>
<p dir="auto">A <code>MessagePackReader</code> can efficiently read from <code>ReadOnlyMemory&lt;byte&gt;</code> or <code>ReadOnlySequence&lt;byte&gt;</code> without any allocations, except to allocate a new <code>string</code> as required by the <code>ReadString()</code> method. All other methods return either value structs or <code>ReadOnlySequence&lt;byte&gt;</code> slices for extensions/arrays.
Reading directly from <code>ReadOnlySequence&lt;byte&gt;</code> means the reader can directly consume some modern high performance APIs such as <code>PipeReader</code>.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Skip</code></td>
<td>Advances the reader's position past the current value. If the value is complex (e.g. map, array) the entire structure is skipped.</td>
</tr>
<tr>
<td><code>Read*</code></td>
<td>Read and return a value whose type is named by the method name from the current reader position. Throws if the expected type does not match the actual type. When reading numbers, the type need not match the binary-specified type exactly. The numeric value will be coerced into the desired type or throw if the integer type is too small for a large value.</td>
</tr>
<tr>
<td><code>TryReadNil</code></td>
<td>Advances beyond the current value if the current value is <code>nil</code> and returns <code>true</code>; otherwise leaves the reader's position unchanged and returns <code>false</code>.</td>
</tr>
<tr>
<td><code>ReadBytes</code></td>
<td>Returns a slice of the input sequence representing the contents of a <code>byte[]</code>, and advances the reader.</td>
</tr>
<tr>
<td><code>ReadStringSequence</code></td>
<td>Returns a slice of the input sequence representing the contents of a <code>string</code> without decoding it, and advances the reader.</td>
</tr>
<tr>
<td><code>Clone</code></td>
<td>Creates a new <code>MessagePackReader</code> with the specified input sequence and the same settings as the original reader.</td>
</tr>
<tr>
<td><code>CreatePeekReader</code></td>
<td>Creates a new reader with the same position as this one, allowing the caller to "read ahead" without impacting the original reader's position.</td>
</tr>
<tr>
<td><code>NextCode</code></td>
<td>Reads the low-level MessagePack <code>byte</code> that describes the type of the next value. Does not advance the reader. See <a href="https://github.com/msgpack/msgpack/blob/master/spec.md#overview">MessagePack format of first byte</a>. Its static class has <code>ToMessagePackType</code> and <code>ToFormatName</code> utility methods. <code>MessagePackRange</code> means Min-Max fix range of MessagePack format.</td>
</tr>
<tr>
<td><code>NextMessagePackType</code></td>
<td>Describes the <code>NextCode</code> value as a higher level category. Does not advance the reader. See <a href="https://github.com/msgpack/msgpack/blob/master/spec.md#serialization-type-to-format-conversion">MessagePack spec of source types</a>.</td>
</tr>
<tr>
<td>(others)</td>
<td>Other methods and properties as described by the .xml doc comment file and Intellisense.</td>
</tr>
</tbody>
</table>
<p dir="auto">The <code>MessagePackReader</code> is capable of automatically interpreting both the old and new MessagePack spec.</p>
<h7 dir="auto">
<a id="user-content-messagepackwriter" class="anchor" aria-hidden="true" href="#messagepackwriter"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>MessagePackWriter</code>
</h7>
<p dir="auto">A <code>MessagePackWriter</code> writes to a given instance of <code>IBufferWriter&lt;byte&gt;</code>. Several common implementations of this exist, allowing zero allocations and minimal buffer copies while writing directly to several I/O APIs including <code>PipeWriter</code>.</p>
<p dir="auto">The <code>MessagePackWriter</code> writes the new MessagePack spec by default, but can write MessagePack compatible with the old spec by setting the <code>OldSpec</code> property to <code>true</code>.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Clone</code></td>
<td>Creates a new <code>MessagePackWriter</code> with the specified underlying <code>IBufferWriter&lt;byte&gt;</code> and the same settings as the original writer.</td>
</tr>
<tr>
<td><code>Flush</code></td>
<td>Writes any buffered bytes to the underlying <code>IBufferWriter&lt;byte&gt;</code>.</td>
</tr>
<tr>
<td><code>WriteNil</code></td>
<td>Writes the MessagePack equivalent of .NET's <code>null</code> value.</td>
</tr>
<tr>
<td><code>Write</code></td>
<td>Writes any MessagePack primitive value in the most compact form possible. Has overloads for every primitive type defined by the MessagePack spec.</td>
</tr>
<tr>
<td><code>Write*IntType*</code></td>
<td>Writes an integer value in exactly the MessagePack type specified, even if a more compact format exists.</td>
</tr>
<tr>
<td><code>WriteMapHeader</code></td>
<td>Introduces a map by specifying the number of key=value pairs it contains.</td>
</tr>
<tr>
<td><code>WriteArrayHeader</code></td>
<td>Introduces an array by specifying the number of elements it contains.</td>
</tr>
<tr>
<td><code>WriteExtensionFormat</code></td>
<td>Writes the full content of an extension value including length, type code and content.</td>
</tr>
<tr>
<td><code>WriteExtensionFormatHeader</code></td>
<td>Writes just the header (length and type code) of an extension value.</td>
</tr>
<tr>
<td><code>WriteRaw</code></td>
<td>Copies the specified bytes directly to the underlying <code>IBufferWriter&lt;byte&gt;</code> without any validation.</td>
</tr>
<tr>
<td>(others)</td>
<td>Other methods and properties as described by the .xml doc comment file and Intellisense.</td>
</tr>
</tbody>
</table>
<p dir="auto"><code>DateTime</code> is serialized to <a href="https://github.com/msgpack/msgpack/blob/master/spec.md#formats-timestamp">MessagePack Timestamp format</a>, it serialize/deserialize UTC and loses <code>Kind</code> info and requires that <code>MessagePackWriter.OldSpec == false</code>.
If you use the <code>NativeDateTimeResolver</code>, <code>DateTime</code> values will be serialized using .NET's native <code>Int64</code> representation, which preserves <code>Kind</code> info but may not be interoperable with non-.NET platforms.</p>
<h6 dir="auto">
<a id="user-content-main-extension-point-iformatterresolver" class="anchor" aria-hidden="true" href="#main-extension-point-iformatterresolver"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a name="user-content-resolvers"></a>Main Extension Point (<code>IFormatterResolver</code>)</h6>
<p dir="auto">An <code>IFormatterResolver</code> is storage of typed serializers. The <code>MessagePackSerializer</code> API accepts a <code>MessagePackSerializerOptions</code> object which specifies the <code>IFormatterResolver</code> to use, allowing customization of the serialization of complex types.</p>
<table>
<thead>
<tr>
<th>Resolver Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>BuiltinResolver</td>
<td>Builtin primitive and standard classes resolver. It includes primitive(int, bool, string...) and there nullable, array and list. and some extra builtin types(<code>Guid</code>, <code>Uri</code>, <code>BigInteger</code>, etc...).</td>
</tr>
<tr>
<td>StandardResolver</td>
<td>Composited resolver. It resolves in the following order <code>builtin -&gt; attribute -&gt; dynamic enum -&gt; dynamic generic -&gt; dynamic union -&gt; dynamic object -&gt; dynamic object fallback</code>. This is the default of MessagePackSerializer.</td>
</tr>
<tr>
<td>ContractlessStandardResolver</td>
<td>Composited <code>StandardResolver</code>(except dynamic object fallback) -&gt; <code>DynamicContractlessObjectResolver</code> -&gt; <code>DynamicObjectTypeFallbackResolver</code>. It enables contractless serialization.</td>
</tr>
<tr>
<td>StandardResolverAllowPrivate</td>
<td>Same as StandardResolver but allow serialize/deserialize private members.</td>
</tr>
<tr>
<td>ContractlessStandardResolverAllowPrivate</td>
<td>Same as ContractlessStandardResolver but allow serialize/deserialize private members.</td>
</tr>
<tr>
<td>PrimitiveObjectResolver</td>
<td>MessagePack primitive object resolver. It is used fallback in <code>object</code> type and supports <code>bool</code>, <code>char</code>, <code>sbyte</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code>, <code>ushort</code>, <code>uint</code>, <code>ulong</code>, <code>float</code>, <code>double</code>, <code>DateTime</code>, <code>string</code>, <code>byte[]</code>, <code>ICollection</code>, <code>IDictionary</code>.</td>
</tr>
<tr>
<td>DynamicObjectTypeFallbackResolver</td>
<td>Serialize is used type in from <code>object</code> type, deserialize is used PrimitiveObjectResolver.</td>
</tr>
<tr>
<td>AttributeFormatterResolver</td>
<td>Get formatter from <code>[MessagePackFormatter]</code> attribute.</td>
</tr>
<tr>
<td>CompositeResolver</td>
<td>Composes several resolvers and/or formatters together in an ordered list, allowing reuse and overriding of behaviors of existing resolvers and formatters.</td>
</tr>
<tr>
<td>NativeDateTimeResolver</td>
<td>Serialize by .NET native DateTime binary format. It keeps <code>DateTime.Kind</code> that loses by standard(MessagePack timestamp) format.</td>
</tr>
<tr>
<td>NativeGuidResolver</td>
<td>Serialize by .NET native Guid binary representation. It is faster than standard(string) representation.</td>
</tr>
<tr>
<td>NativeDecimalResolver</td>
<td>Serialize by .NET native decimal binary representation. It is faster than standard(string) representation.</td>
</tr>
<tr>
<td>DynamicEnumResolver</td>
<td>Resolver of enum and there nullable, serialize there underlying type. It uses dynamic code generation to avoid boxing and boostup performance serialize there name.</td>
</tr>
<tr>
<td>DynamicEnumAsStringResolver</td>
<td>Resolver of enum and there nullable.  It uses reflection call for resolve nullable at first time.</td>
</tr>
<tr>
<td>DynamicGenericResolver</td>
<td>Resolver of generic type(<code>Tuple&lt;&gt;</code>, <code>List&lt;&gt;</code>, <code>Dictionary&lt;,&gt;</code>, <code>Array</code>, etc). It uses reflection call for resolve generic argument at first time.</td>
</tr>
<tr>
<td>DynamicUnionResolver</td>
<td>Resolver of interface marked by UnionAttribute. It uses dynamic code generation to create dynamic formatter.</td>
</tr>
<tr>
<td>DynamicObjectResolver</td>
<td>Resolver of class and struct made by MessagePackObjectAttribute. It uses dynamic code generation to create dynamic formatter.</td>
</tr>
<tr>
<td>DynamicContractlessObjectResolver</td>
<td>Resolver of all classes and structs. It does not needs <code>MessagePackObjectAttribute</code> and serialized key as string(same as marked <code>[MessagePackObject(true)]</code>).</td>
</tr>
<tr>
<td>DynamicObjectResolverAllowPrivate</td>
<td>Same as DynamicObjectResolver but allow serialize/deserialize private members.</td>
</tr>
<tr>
<td>DynamicContractlessObjectResolverAllowPrivate</td>
<td>Same as DynamicContractlessObjectResolver but allow serialize/deserialize private members.</td>
</tr>
<tr>
<td>TypelessObjectResolver</td>
<td>Used for <code>object</code>, embed .NET type in binary by <code>ext(100)</code> format so no need to pass type in deserialization.</td>
</tr>
<tr>
<td>TypelessContractlessStandardResolver</td>
<td>Composited resolver. It resolves in the following order <code>nativedatetime -&gt; builtin -&gt; attribute -&gt; dynamic enum -&gt; dynamic generic -&gt; dynamic union -&gt; dynamic object -&gt; dynamiccontractless -&gt; typeless</code>. This is the default of <code>MessagePackSerializer.Typeless</code>
</td>
</tr>
</tbody>
</table>
<p dir="auto">Each instance of <code>MessagePackSerializer</code> accepts only a single resolver. Most object graphs will need more than one for serialization, so composing a single resolver made up of several is often required, and can be done with the <code>CompositeResolver</code> as shown below:</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// Do this once and store it for reuse.
var resolver = MessagePack.Resolvers.CompositeResolver.Create(
    // resolver custom types first
    ReactivePropertyResolver.Instance,
    MessagePack.Unity.Extension.UnityBlitResolver.Instance,
    MessagePack.Unity.UnityResolver.Instance,

    // finally use standard resolver
    StandardResolver.Instance
);
var options = MessagePackSerializerOptions.Standard.WithResolver(resolver);

// Each time you serialize/deserialize, specify the options:
byte[] msgpackBytes = MessagePackSerializer.Serialize(myObject, options);
T myObject2 = MessagePackSerializer.Deserialize&lt;MyObject&gt;(msgpackBytes, options);"><pre><span class="pl-c"><span class="pl-c">//</span> Do this once and store it for reuse.</span>
<span class="pl-k">var</span> <span class="pl-en">resolver</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">CompositeResolver</span>.<span class="pl-en">Create</span>(
    <span class="pl-c"><span class="pl-c">//</span> resolver custom types first</span>
    <span class="pl-smi">ReactivePropertyResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Unity</span>.<span class="pl-smi">Extension</span>.<span class="pl-smi">UnityBlitResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Unity</span>.<span class="pl-smi">UnityResolver</span>.<span class="pl-smi">Instance</span>,

    <span class="pl-c"><span class="pl-c">//</span> finally use standard resolver</span>
    <span class="pl-smi">StandardResolver</span>.<span class="pl-smi">Instance</span>
);
<span class="pl-k">var</span> <span class="pl-en">options</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializerOptions</span>.<span class="pl-smi">Standard</span>.<span class="pl-en">WithResolver</span>(<span class="pl-smi">resolver</span>);

<span class="pl-c"><span class="pl-c">//</span> Each time you serialize/deserialize, specify the options:</span>
<span class="pl-k">byte</span>[] <span class="pl-en">msgpackBytes</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Serialize</span>(<span class="pl-smi">myObject</span>, <span class="pl-smi">options</span>);
<span class="pl-en">T</span> <span class="pl-en">myObject2</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-en">Deserialize</span>&lt;<span class="pl-en">MyObject</span>&gt;(<span class="pl-smi">msgpackBytes</span>, <span class="pl-smi">options</span>);</pre></div>
<p dir="auto">A resolver can be set as default with <code>MessagePackSerializer.DefaultOptions = options</code>, but <strong>WARNING</strong>:
When developing an application where you control all MessagePack-related code it may be safe to rely on this mutable static to control behavior.
For all other libraries or multi-purpose applications that use <code>MessagePackSerializer</code> you should explicitly specify the <code>MessagePackSerializerOptions</code> to use with each method invocation to guarantee your code behaves as you expect even when sharing an <code>AppDomain</code> or process with other MessagePack users that may change this static property.</p>
<p dir="auto">Here is sample of use <code>DynamicEnumAsStringResolver</code> with <code>DynamicContractlessObjectResolver</code> (It is Json.NET-like lightweight setting.)</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// composite same as StandardResolver
var resolver = MessagePack.Resolvers.CompositeResolver.Create(
    MessagePack.Resolvers.BuiltinResolver.Instance,
    MessagePack.Resolvers.AttributeFormatterResolver.Instance,

    // replace enum resolver
    MessagePack.Resolvers.DynamicEnumAsStringResolver.Instance,

    MessagePack.Resolvers.DynamicGenericResolver.Instance,
    MessagePack.Resolvers.DynamicUnionResolver.Instance,
    MessagePack.Resolvers.DynamicObjectResolver.Instance,

    MessagePack.Resolvers.PrimitiveObjectResolver.Instance,

    // final fallback(last priority)
    MessagePack.Resolvers.DynamicContractlessObjectResolver.Instance
);"><pre><span class="pl-c"><span class="pl-c">//</span> composite same as StandardResolver</span>
<span class="pl-k">var</span> <span class="pl-en">resolver</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">CompositeResolver</span>.<span class="pl-en">Create</span>(
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">BuiltinResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">AttributeFormatterResolver</span>.<span class="pl-smi">Instance</span>,

    <span class="pl-c"><span class="pl-c">//</span> replace enum resolver</span>
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">DynamicEnumAsStringResolver</span>.<span class="pl-smi">Instance</span>,

    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">DynamicGenericResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">DynamicUnionResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">DynamicObjectResolver</span>.<span class="pl-smi">Instance</span>,

    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">PrimitiveObjectResolver</span>.<span class="pl-smi">Instance</span>,

    <span class="pl-c"><span class="pl-c">//</span> final fallback(last priority)</span>
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">DynamicContractlessObjectResolver</span>.<span class="pl-smi">Instance</span>
);</pre></div>
<p dir="auto">If you want to make an extension package, you should write both a formatter and resolver
for easier consumption.
Here is sample of a resolver:</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="public class SampleCustomResolver : IFormatterResolver
{
    // Resolver should be singleton.
    public static readonly IFormatterResolver Instance = new SampleCustomResolver();

    private SampleCustomResolver()
    {
    }

    // GetFormatter&lt;T&gt;'s get cost should be minimized so use type cache.
    public IMessagePackFormatter&lt;T&gt; GetFormatter&lt;T&gt;()
    {
        return FormatterCache&lt;T&gt;.Formatter;
    }

    private static class FormatterCache&lt;T&gt;
    {
        public static readonly IMessagePackFormatter&lt;T&gt; Formatter;

        // generic's static constructor should be minimized for reduce type generation size!
        // use outer helper method.
        static FormatterCache()
        {
            Formatter = (IMessagePackFormatter&lt;T&gt;)SampleCustomResolverGetFormatterHelper.GetFormatter(typeof(T));
        }
    }
}

internal static class SampleCustomResolverGetFormatterHelper
{
    // If type is concrete type, use type-formatter map
    static readonly Dictionary&lt;Type, object&gt; formatterMap = new Dictionary&lt;Type, object&gt;()
    {
        {typeof(FileInfo), new FileInfoFormatter()}
        // add more your own custom serializers.
    };

    internal static object GetFormatter(Type t)
    {
        object formatter;
        if (formatterMap.TryGetValue(t, out formatter))
        {
            return formatter;
        }

        // If type can not get, must return null for fallback mechanism.
        return null;
    }
}"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SampleCustomResolver</span> : <span class="pl-en">IFormatterResolver</span>
{
    <span class="pl-c"><span class="pl-c">//</span> Resolver should be singleton.</span>
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">readonly</span> <span class="pl-en">IFormatterResolver</span> <span class="pl-en">Instance</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">SampleCustomResolver</span>();

    <span class="pl-k">private</span> <span class="pl-en">SampleCustomResolver</span>()
    {
    }

    <span class="pl-c"><span class="pl-c">//</span> GetFormatter&lt;T&gt;'s get cost should be minimized so use type cache.</span>
    <span class="pl-k">public</span> <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">T</span>&gt; <span class="pl-en">GetFormatter</span>&lt;<span class="pl-en">T</span>&gt;()
    {
        <span class="pl-k">return</span> <span class="pl-smi">FormatterCache</span>&lt;<span class="pl-en">T</span>&gt;.<span class="pl-smi">Formatter</span>;
    }

    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">FormatterCache</span>&lt;<span class="pl-en">T</span>&gt;
    {
        <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">readonly</span> <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">T</span>&gt; <span class="pl-en">Formatter</span>;

        <span class="pl-c"><span class="pl-c">//</span> generic's static constructor should be minimized for reduce type generation size!</span>
        <span class="pl-c"><span class="pl-c">//</span> use outer helper method.</span>
        <span class="pl-k">static</span> <span class="pl-en">FormatterCache</span>()
        {
            <span class="pl-smi">Formatter</span> <span class="pl-k">=</span> (<span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">T</span>&gt;)<span class="pl-smi">SampleCustomResolverGetFormatterHelper</span>.<span class="pl-en">GetFormatter</span>(<span class="pl-k">typeof</span>(<span class="pl-en">T</span>));
        }
    }
}

<span class="pl-k">internal</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">SampleCustomResolverGetFormatterHelper</span>
{
    <span class="pl-c"><span class="pl-c">//</span> If type is concrete type, use type-formatter map</span>
    <span class="pl-k">static</span> <span class="pl-k">readonly</span> <span class="pl-en">Dictionary</span>&lt;<span class="pl-en">Type</span>, <span class="pl-k">object</span>&gt; <span class="pl-en">formatterMap</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Dictionary</span>&lt;<span class="pl-en">Type</span>, <span class="pl-k">object</span>&gt;()
    {
        {<span class="pl-k">typeof</span>(<span class="pl-en">FileInfo</span>), <span class="pl-k">new</span> <span class="pl-en">FileInfoFormatter</span>()}
        <span class="pl-c"><span class="pl-c">//</span> add more your own custom serializers.</span>
    };

    <span class="pl-k">internal</span> <span class="pl-k">static</span> <span class="pl-k">object</span> <span class="pl-en">GetFormatter</span>(<span class="pl-en">Type</span> <span class="pl-en">t</span>)
    {
        <span class="pl-k">object</span> <span class="pl-en">formatter</span>;
        <span class="pl-k">if</span> (<span class="pl-smi">formatterMap</span>.<span class="pl-en">TryGetValue</span>(<span class="pl-smi">t</span>, <span class="pl-k">out</span> <span class="pl-smi">formatter</span>))
        {
            <span class="pl-k">return</span> <span class="pl-smi">formatter</span>;
        }

        <span class="pl-c"><span class="pl-c">//</span> If type can not get, must return null for fallback mechanism.</span>
        <span class="pl-k">return</span> <span class="pl-c1">null</span>;
    }
}</pre></div>
<h6 dir="auto">
<a id="user-content-messagepackformatterattribute" class="anchor" aria-hidden="true" href="#messagepackformatterattribute"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePackFormatterAttribute</h6>
<p dir="auto">MessagePackFormatterAttribute is a lightweight extension point of class, struct, interface, enum and property/field. This is like Json.NET's JsonConverterAttribute. For example, serialize private field, serialize x10 formatter.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="[MessagePackFormatter(typeof(CustomObjectFormatter))]
public class CustomObject
{
    string internalId;

    public CustomObject()
    {
        this.internalId = Guid.NewGuid().ToString();
    }

    // serialize/deserialize internal field.
    class CustomObjectFormatter : IMessagePackFormatter&lt;CustomObject&gt;
    {
        public void Serialize(ref MessagePackWriter writer, CustomObject value, MessagePackSerializerOptions options)
        {
            options.Resolver.GetFormatterWithVerify&lt;string&gt;().Serialize(ref writer, value.internalId, options);
        }

        public CustomObject Deserialize(ref MessagePackReader reader, MessagePackSerializerOptions options)
        {
            var id = options.Resolver.GetFormatterWithVerify&lt;string&gt;().Deserialize(ref reader, options);
            return new CustomObject { internalId = id };
        }
    }
}

// per field, member

public class Int_x10Formatter : IMessagePackFormatter&lt;int&gt;
{
    public int Deserialize(ref MessagePackReader reader, MessagePackSerializerOptions options)
    {
        return reader.ReadInt32() * 10;
    }

    public void Serialize(ref MessagePackWriter writer, int value, MessagePackSerializerOptions options)
    {
        writer.WriteInt32(value * 10);
    }
}

[MessagePackObject]
public class MyClass
{
    // You can attach custom formatter per member.
    [Key(0)]
    [MessagePackFormatter(typeof(Int_x10Formatter))]
    public int MyProperty1 { get; set; }
}"><pre>[<span class="pl-en">MessagePackFormatter</span>(<span class="pl-k">typeof</span>(<span class="pl-en">CustomObjectFormatter</span>))]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">CustomObject</span>
{
    <span class="pl-k">string</span> <span class="pl-en">internalId</span>;

    <span class="pl-k">public</span> <span class="pl-en">CustomObject</span>()
    {
        <span class="pl-k">this</span>.<span class="pl-smi">internalId</span> <span class="pl-k">=</span> <span class="pl-smi">Guid</span>.<span class="pl-en">NewGuid</span>().<span class="pl-en">ToString</span>();
    }

    <span class="pl-c"><span class="pl-c">//</span> serialize/deserialize internal field.</span>
    <span class="pl-k">class</span> <span class="pl-en">CustomObjectFormatter</span> : <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-en">CustomObject</span>&gt;
    {
        <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">Serialize</span>(<span class="pl-k">ref</span> <span class="pl-en">MessagePackWriter</span> <span class="pl-en">writer</span>, <span class="pl-en">CustomObject</span> <span class="pl-en">value</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
        {
            <span class="pl-smi">options</span>.<span class="pl-smi">Resolver</span>.<span class="pl-en">GetFormatterWithVerify</span>&lt;<span class="pl-k">string</span>&gt;().<span class="pl-en">Serialize</span>(<span class="pl-k">ref</span> <span class="pl-smi">writer</span>, <span class="pl-smi">value</span>.<span class="pl-smi">internalId</span>, <span class="pl-smi">options</span>);
        }

        <span class="pl-k">public</span> <span class="pl-en">CustomObject</span> <span class="pl-en">Deserialize</span>(<span class="pl-k">ref</span> <span class="pl-en">MessagePackReader</span> <span class="pl-en">reader</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
        {
            <span class="pl-k">var</span> <span class="pl-en">id</span> <span class="pl-k">=</span> <span class="pl-smi">options</span>.<span class="pl-smi">Resolver</span>.<span class="pl-en">GetFormatterWithVerify</span>&lt;<span class="pl-k">string</span>&gt;().<span class="pl-en">Deserialize</span>(<span class="pl-k">ref</span> <span class="pl-smi">reader</span>, <span class="pl-smi">options</span>);
            <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-en">CustomObject</span> { <span class="pl-smi">internalId</span> <span class="pl-k">=</span> <span class="pl-smi">id</span> };
        }
    }
}

<span class="pl-c"><span class="pl-c">//</span> per field, member</span>

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Int_x10Formatter</span> : <span class="pl-en">IMessagePackFormatter</span>&lt;<span class="pl-k">int</span>&gt;
{
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">Deserialize</span>(<span class="pl-k">ref</span> <span class="pl-en">MessagePackReader</span> <span class="pl-en">reader</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
    {
        <span class="pl-k">return</span> <span class="pl-smi">reader</span>.<span class="pl-en">ReadInt32</span>() <span class="pl-k">*</span> <span class="pl-c1">10</span>;
    }

    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">Serialize</span>(<span class="pl-k">ref</span> <span class="pl-en">MessagePackWriter</span> <span class="pl-en">writer</span>, <span class="pl-k">int</span> <span class="pl-en">value</span>, <span class="pl-en">MessagePackSerializerOptions</span> <span class="pl-en">options</span>)
    {
        <span class="pl-smi">writer</span>.<span class="pl-en">WriteInt32</span>(<span class="pl-smi">value</span> <span class="pl-k">*</span> <span class="pl-c1">10</span>);
    }
}

[<span class="pl-en">MessagePackObject</span>]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">MyClass</span>
{
    <span class="pl-c"><span class="pl-c">//</span> You can attach custom formatter per member.</span>
    [<span class="pl-en">Key</span>(<span class="pl-c1">0</span>)]
    [<span class="pl-en">MessagePackFormatter</span>(<span class="pl-k">typeof</span>(<span class="pl-en">Int_x10Formatter</span>))]
    <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">MyProperty1</span> { <span class="pl-k">get</span>; <span class="pl-k">set</span>; }
}</pre></div>
<p dir="auto">Formatter is retrieved by <code>AttributeFormatterResolver</code>, it is included in <code>StandardResolver</code>.</p>
<h6 dir="auto">
<a id="user-content-ignoreformatter" class="anchor" aria-hidden="true" href="#ignoreformatter"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>IgnoreFormatter</h6>
<p dir="auto"><code>IgnoreFormatter&lt;T&gt;</code> is lightweight extension point of class and struct. If there exists types that can't be serialized, you can register <code>IgnoreFormatter&lt;T&gt;</code> that serializes those to nil/null.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="// CompositeResolver can set custom formatter.
var resolver = MessagePack.Resolvers.CompositeResolver.Create(
    new IMessagePackFormatter[]
    {
        // for example, register reflection infos (can not serialize)
        new IgnoreFormatter&lt;MethodBase&gt;(),
        new IgnoreFormatter&lt;MethodInfo&gt;(),
        new IgnoreFormatter&lt;PropertyInfo&gt;(),
        new IgnoreFormatter&lt;FieldInfo&gt;()
    },
    new IFormatterResolver[]
    {
        ContractlessStandardResolver.Instance
    });"><pre><span class="pl-c"><span class="pl-c">//</span> CompositeResolver can set custom formatter.</span>
<span class="pl-k">var</span> <span class="pl-en">resolver</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">CompositeResolver</span>.<span class="pl-en">Create</span>(
    <span class="pl-k">new</span> <span class="pl-en">IMessagePackFormatter</span>[]
    {
        <span class="pl-c"><span class="pl-c">//</span> for example, register reflection infos (can not serialize)</span>
        <span class="pl-k">new</span> <span class="pl-en">IgnoreFormatter</span>&lt;<span class="pl-en">MethodBase</span>&gt;(),
        <span class="pl-k">new</span> <span class="pl-en">IgnoreFormatter</span>&lt;<span class="pl-en">MethodInfo</span>&gt;(),
        <span class="pl-k">new</span> <span class="pl-en">IgnoreFormatter</span>&lt;<span class="pl-en">PropertyInfo</span>&gt;(),
        <span class="pl-k">new</span> <span class="pl-en">IgnoreFormatter</span>&lt;<span class="pl-en">FieldInfo</span>&gt;()
    },
    <span class="pl-k">new</span> <span class="pl-en">IFormatterResolver</span>[]
    {
        <span class="pl-smi">ContractlessStandardResolver</span>.<span class="pl-smi">Instance</span>
    });</pre></div>
<h6 dir="auto">
<a id="user-content-reserved-extension-types" class="anchor" aria-hidden="true" href="#reserved-extension-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Reserved Extension Types</h6>
<p dir="auto">MessagePack for C# already used some MessagePack extension type codes, be careful to use same ext code.</p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Type</th>
<th>Use by</th>
</tr>
</thead>
<tbody>
<tr>
<td>-1</td>
<td>DateTime</td>
<td>MessagePack-spec reserved for timestamp</td>
</tr>
<tr>
<td>30</td>
<td>Vector2[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>31</td>
<td>Vector3[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>32</td>
<td>Vector4[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>33</td>
<td>Quaternion[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>34</td>
<td>Color[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>35</td>
<td>Bounds[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>36</td>
<td>Rect[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>37</td>
<td>Int[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>38</td>
<td>Float[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>39</td>
<td>Double[]</td>
<td>for Unity, UnsafeBlitFormatter</td>
</tr>
<tr>
<td>98</td>
<td>All</td>
<td>MessagePackCompression.Lz4BlockArray</td>
</tr>
<tr>
<td>99</td>
<td>All</td>
<td>MessagePackCompression.Lz4Block</td>
</tr>
<tr>
<td>100</td>
<td>object</td>
<td>TypelessFormatter</td>
</tr>
</tbody>
</table>
<h6 dir="auto">
<a id="user-content-unity-support" class="anchor" aria-hidden="true" href="#unity-support"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Unity support</h6>
<p dir="auto">Unity lowest supported version is <code>2018.3</code>, API Compatibility Level supports both <code>.NET 4.x</code> and <code>.NET Standard 2.0</code>.</p>
<p dir="auto">You can install the <code>unitypackage</code> from the <a href="https://github.com/neuecc/MessagePack-CSharp/releases">releases</a> page.
If your build targets .NET Framework 4.x and runs on mono, you can use it as is.
But if your build targets IL2CPP, you can not use <code>Dynamic***Resolver</code>, so it is required to use pre-code generation. Please see <a href="#aot">pre-code generation section</a>.</p>
<p dir="auto">MessagePack for C# includes some additional <code>System.*.dll</code> libraries that originally provides in NuGet. They are located under <code>Plugins</code>. If other packages use these libraries (e.g. Unity Collections package using <code>System.Runtime.CompilerServices.Unsafe.dll</code>), to avoid conflicts, please delete the DLL under <code>Plugins</code>.</p>
<p dir="auto">Currently <code>CompositeResolver.Create</code> does not work on IL2CPP, so it is recommended to use <code>StaticCompositeResolver.Instance.Register</code> instead.</p>
<p dir="auto">In Unity, MessagePackSerializer can serialize <code>Vector2</code>, <code>Vector3</code>, <code>Vector4</code>, <code>Quaternion</code>, <code>Color</code>, <code>Bounds</code>, <code>Rect</code>, <code>AnimationCurve</code>, <code>Keyframe</code>, <code>Matrix4x4</code>, <code>Gradient</code>, <code>Color32</code>, <code>RectOffset</code>, <code>LayerMask</code>, <code>Vector2Int</code>, <code>Vector3Int</code>, <code>RangeInt</code>, <code>RectInt</code>, <code>BoundsInt</code> and their nullable, array and list types with the built-in extension <code>UnityResolver</code>. It is included in StandardResolver by default.</p>
<p dir="auto">MessagePack for C# has an additional unsafe extension.  <code>UnsafeBlitResolver</code> is special resolver for extremely fast but unsafe serialization/deserialization of struct arrays.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/46207/23837633/76589924-07ce-11e7-8b26-e50eab548938.png"><img src="https://cloud.githubusercontent.com/assets/46207/23837633/76589924-07ce-11e7-8b26-e50eab548938.png" alt="image" style="max-width: 100%;"></a></p>
<p dir="auto">x20 faster Vector3[] serialization than native JsonUtility. If use <code>UnsafeBlitResolver</code>, serialization uses a special format (ext:typecode 30~39)  for <code>Vector2[]</code>, <code>Vector3[]</code>, <code>Quaternion[]</code>, <code>Color[]</code>, <code>Bounds[]</code>, <code>Rect[]</code>. If use <code>UnityBlitWithPrimitiveArrayResolver</code>, it supports <code>int[]</code>, <code>float[]</code>, <code>double[]</code> too. This special feature is useful for serializing Mesh (many <code>Vector3[]</code>) or many transform positions.</p>
<p dir="auto">If you want to use unsafe resolver, register <code>UnityBlitResolver</code> or <code>UnityBlitWithPrimitiveArrayResolver</code>.</p>
<p dir="auto">Here is sample of configuration.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="StaticCompositeResolver.Instance.Register(
    MessagePack.Unity.UnityResolver.Instance,
    MessagePack.Unity.Extension.UnityBlitWithPrimitiveArrayResolver.Instance,
    MessagePack.Resolvers.StandardResolver.Instance
);

var options = MessagePackSerializerOptions.Standard.WithResolver(StaticCompositeResolver.Instance);
MessagePackSerializer.DefaultOptions = options;"><pre><span class="pl-smi">StaticCompositeResolver</span>.<span class="pl-smi">Instance</span>.<span class="pl-en">Register</span>(
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Unity</span>.<span class="pl-smi">UnityResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Unity</span>.<span class="pl-smi">Extension</span>.<span class="pl-smi">UnityBlitWithPrimitiveArrayResolver</span>.<span class="pl-smi">Instance</span>,
    <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">StandardResolver</span>.<span class="pl-smi">Instance</span>
);

<span class="pl-k">var</span> <span class="pl-en">options</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializerOptions</span>.<span class="pl-smi">Standard</span>.<span class="pl-en">WithResolver</span>(<span class="pl-smi">StaticCompositeResolver</span>.<span class="pl-smi">Instance</span>);
<span class="pl-smi">MessagePackSerializer</span>.<span class="pl-smi">DefaultOptions</span> <span class="pl-k">=</span> <span class="pl-smi">options</span>;</pre></div>
<p dir="auto">The <code>MessagePack.UnityShims</code> NuGet package is for .NET server-side serialization support to communicate with Unity. It includes shims for Vector3 etc and the Safe/Unsafe serialization extension.</p>
<p dir="auto">If you want to share a class between Unity and a server, you can use <code>SharedProject</code> or <code>Reference as Link</code> or a glob reference (with <code>LinkBase</code>), etc. Anyway, you need to share at source-code level. This is a sample project structure using a glob reference (recommended).</p>
<ul dir="auto">
<li>ServerProject(.NET 4.6/.NET Core/.NET Standard)
<ul dir="auto">
<li>[<code>&lt;Compile Include="..\UnityProject\Assets\Scripts\Shared\**\*.cs" LinkBase="Shared" /&gt;</code>]</li>
<li>[MessagePack]</li>
<li>[MessagePack.UnityShims]</li>
</ul>
</li>
<li>UnityProject
<ul dir="auto">
<li>[Concrete SharedCodes]</li>
<li>[MessagePack](not dll/NuGet, use MessagePack.Unity.unitypackage's sourcecode)</li>
</ul>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-aot-code-generation-support-for-unityxamarin" class="anchor" aria-hidden="true" href="#aot-code-generation-support-for-unityxamarin"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a name="user-content-aot"></a>AOT Code Generation (support for Unity/Xamarin)</h6>
<p dir="auto">By default, MessagePack for C# serializes custom objects by <a href="https://msdn.microsoft.com/en-us/library/system.reflection.emit.ilgenerator.aspx" rel="nofollow">generating IL</a> on the fly at runtime to create custom, highly tuned formatters for each type. This code generation has a minor upfront performance cost.
Because strict-AOT environments such as Xamarin and Unity IL2CPP forbid runtime code generation, MessagePack provides a way for you to run a code generator ahead of time as well.</p>
<blockquote>
<p dir="auto">Note: When using Unity, dynamic code generation only works when targeting .NET Framework 4.x + mono runtime.
For all other Unity targets, AOT is required.</p>
</blockquote>
<p dir="auto">If you want to avoid the upfront dynamic generation cost or you need to run on Xamarin or Unity, you need AOT code generation. <code>mpc</code> (MessagePackCompiler) is the code generator of MessagePack for C#. mpc uses <a href="https://github.com/dotnet/roslyn">Roslyn</a> to analyze source code.</p>
<p dir="auto">First of all, mpc requires <a href="https://dotnet.microsoft.com/download" rel="nofollow">.NET Core 3 Runtime</a>. The easiest way to acquire and run mpc is as a dotnet tool.</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="dotnet tool install --global MessagePack.Generator"><pre><code>dotnet tool install --global MessagePack.Generator
</code></pre></div>
<p dir="auto">Installing it as a local tool allows you to include the tools and versions that you use in your source control system. Run these commands in the root of your repo:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="dotnet new tool-manifest
dotnet tool install MessagePack.Generator"><pre><code>dotnet new tool-manifest
dotnet tool install MessagePack.Generator
</code></pre></div>
<p dir="auto">Check in your <code>.config\dotnet-tools.json</code> file. On another machine you can "restore" your tool using the <code>dotnet tool restore</code> command.</p>
<p dir="auto">Once you have the tool installed, simply invoke using <code>dotnet mpc</code> within your repo:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="dotnet mpc --help"><pre><code>dotnet mpc --help
</code></pre></div>
<p dir="auto">Alternatively, you can download mpc from the <a href="https://github.com/neuecc/MessagePack-CSharp/releases">releases</a> page, that includes platform native binaries (that don't require a separate dotnet runtime).</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="Usage: mpc [options...]

Options:
  -i, -input &lt;String&gt;                                Input path to MSBuild project file or the directory containing Unity source files. (Required)
  -o, -output &lt;String&gt;                               Output file path(.cs) or directory(multiple generate file). (Required)
  -c, -conditionalSymbol &lt;String&gt;                    Conditional compiler symbols, split with ','. (Default: null)
  -r, -resolverName &lt;String&gt;                         Set resolver name. (Default: GeneratedResolver)
  -n, -namespace &lt;String&gt;                            Set namespace root name. (Default: MessagePack)
  -m, -useMapMode &lt;Boolean&gt;                          Force use map mode serialization. (Default: False)
  -ms, -multipleIfDirectiveOutputSymbols &lt;String&gt;    Generate #if-- files by symbols, split with ','. (Default: null)"><pre><code>Usage: mpc [options...]

Options:
  -i, -input &lt;String&gt;                                Input path to MSBuild project file or the directory containing Unity source files. (Required)
  -o, -output &lt;String&gt;                               Output file path(.cs) or directory(multiple generate file). (Required)
  -c, -conditionalSymbol &lt;String&gt;                    Conditional compiler symbols, split with ','. (Default: null)
  -r, -resolverName &lt;String&gt;                         Set resolver name. (Default: GeneratedResolver)
  -n, -namespace &lt;String&gt;                            Set namespace root name. (Default: MessagePack)
  -m, -useMapMode &lt;Boolean&gt;                          Force use map mode serialization. (Default: False)
  -ms, -multipleIfDirectiveOutputSymbols &lt;String&gt;    Generate #if-- files by symbols, split with ','. (Default: null)
</code></pre></div>
<p dir="auto"><code>mpc</code> targets C# code with <code>[MessagePackObject]</code> or <code>[Union]</code> annotations.</p>
<div class="highlight highlight-source-batchfile position-relative overflow-auto" data-snippet-clipboard-copy-content='// Simple Sample:
dotnet mpc -i "..\src\Sandbox.Shared.csproj" -o "MessagePackGenerated.cs"

// Use force map simulate DynamicContractlessObjectResolver
dotnet mpc -i "..\src\Sandbox.Shared.csproj" -o "MessagePackGenerated.cs" -m'><pre>// Simple Sample:
dotnet mpc -i <span class="pl-s"><span class="pl-pds">"</span>..\src\Sandbox.Shared.csproj<span class="pl-pds">"</span></span> -o <span class="pl-s"><span class="pl-pds">"</span>MessagePackGenerated.cs<span class="pl-pds">"</span></span>

// Use force map simulate DynamicContractlessObjectResolver
dotnet mpc -i <span class="pl-s"><span class="pl-pds">"</span>..\src\Sandbox.Shared.csproj<span class="pl-pds">"</span></span> -o <span class="pl-s"><span class="pl-pds">"</span>MessagePackGenerated.cs<span class="pl-pds">"</span></span> -m</pre></div>
<p dir="auto">By default, <code>mpc</code> generates the resolver as <code>MessagePack.Resolvers.GeneratedResolver</code> and formatters as<code>MessagePack.Formatters.*</code>.</p>
<p dir="auto">Here is the full sample code to register a generated resolver in Unity.</p>
<div class="highlight highlight-source-cs position-relative overflow-auto" data-snippet-clipboard-copy-content="using MessagePack;
using MessagePack.Resolvers;
using UnityEngine;

public class Startup
{
    static bool serializerRegistered = false;

    [RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.BeforeSceneLoad)]
    static void Initialize()
    {
        if (!serializerRegistered)
        {
            StaticCompositeResolver.Instance.Register(
                 MessagePack.Resolvers.GeneratedResolver.Instance,
                 MessagePack.Resolvers.StandardResolver.Instance
            );

            var option = MessagePackSerializerOptions.Standard.WithResolver(StaticCompositeResolver.Instance);

            MessagePackSerializer.DefaultOptions = option;
            serializerRegistered = true;
        }
    }

#if UNITY_EDITOR


    [UnityEditor.InitializeOnLoadMethod]
    static void EditorInitialize()
    {
        Initialize();
    }

#endif
}"><pre><span class="pl-k">using</span> <span class="pl-en">MessagePack</span>;
<span class="pl-k">using</span> <span class="pl-en">MessagePack</span>.<span class="pl-en">Resolvers</span>;
<span class="pl-k">using</span> <span class="pl-en">UnityEngine</span>;

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Startup</span>
{
    <span class="pl-k">static</span> <span class="pl-k">bool</span> <span class="pl-en">serializerRegistered</span> <span class="pl-k">=</span> <span class="pl-c1">false</span>;

    [<span class="pl-en">RuntimeInitializeOnLoadMethod</span>(<span class="pl-smi">RuntimeInitializeLoadType</span>.<span class="pl-smi">BeforeSceneLoad</span>)]
    <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">Initialize</span>()
    {
        <span class="pl-k">if</span> (<span class="pl-k">!</span><span class="pl-smi">serializerRegistered</span>)
        {
            <span class="pl-smi">StaticCompositeResolver</span>.<span class="pl-smi">Instance</span>.<span class="pl-en">Register</span>(
                 <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">GeneratedResolver</span>.<span class="pl-smi">Instance</span>,
                 <span class="pl-smi">MessagePack</span>.<span class="pl-smi">Resolvers</span>.<span class="pl-smi">StandardResolver</span>.<span class="pl-smi">Instance</span>
            );

            <span class="pl-k">var</span> <span class="pl-en">option</span> <span class="pl-k">=</span> <span class="pl-smi">MessagePackSerializerOptions</span>.<span class="pl-smi">Standard</span>.<span class="pl-en">WithResolver</span>(<span class="pl-smi">StaticCompositeResolver</span>.<span class="pl-smi">Instance</span>);

            <span class="pl-smi">MessagePackSerializer</span>.<span class="pl-smi">DefaultOptions</span> <span class="pl-k">=</span> <span class="pl-smi">option</span>;
            <span class="pl-smi">serializerRegistered</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;
        }
    }

#<span class="pl-k">if</span> <span class="pl-en">UNITY_EDITOR</span>


    [<span class="pl-en">UnityEditor</span>.<span class="pl-en">InitializeOnLoadMethod</span>]
    <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">EditorInitialize</span>()
    {
        <span class="pl-en">Initialize</span>();
    }

#<span class="pl-k">endif</span>
}</pre></div>
<p dir="auto">In Unity, you can use MessagePack CodeGen windows at <code>Windows -&gt; MessagePack -&gt; CodeGenerator</code>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/46207/69414381-f14da400-0d55-11ea-9f8d-9af448d347dc.png"><img src="https://user-images.githubusercontent.com/46207/69414381-f14da400-0d55-11ea-9f8d-9af448d347dc.png" alt="" style="max-width: 100%;"></a></p>
<p dir="auto">Install the .NET Core runtime, install mpc (as a .NET Core Tool as described above), and execute <code>dotnet mpc</code>. Currently this tool is experimental so please tell me your opinion.</p>
<p dir="auto">In Xamarin, you can install the <a href="/neuecc/MessagePack-CSharp/blob/master/doc/msbuildtask.md">the <code>MessagePack.MSBuild.Tasks</code> NuGet package</a> into your projects to pre-compile fast serialization code and run in environments where JIT compilation is not allowed.</p>
<h6 dir="auto">
<a id="user-content-rpc" class="anchor" aria-hidden="true" href="#rpc"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>RPC</h6>
<p dir="auto">MessagePack advocated <a href="https://github.com/msgpack-rpc/msgpack-rpc">MessagePack RPC</a>, but work on it has stopped and it is not widely used.</p>
<h7 dir="auto">
<a id="user-content-magiconion" class="anchor" aria-hidden="true" href="#magiconion"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MagicOnion</h7>
<p dir="auto">I've created a gRPC based MessagePack HTTP/2 RPC streaming framework called <a href="https://github.com/Cysharp/MagicOnion">MagicOnion</a>. gRPC usually communicates with Protocol Buffers using IDL. But MagicOnion uses MessagePack for C# and does not need IDL. When communicating C# to C#, schemaless (or rather C# classes as schema) is better than using IDL.</p>
<h7 dir="auto">
<a id="user-content-streamjsonrpc" class="anchor" aria-hidden="true" href="#streamjsonrpc"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>StreamJsonRpc</h7>
<p dir="auto">The StreamJsonRpc library is based on <a href="https://www.jsonrpc.org/" rel="nofollow">JSON-RPC</a> and includes <a href="https://github.com/microsoft/vs-streamjsonrpc/blob/master/doc/extensibility.md#alternative-formatters">a pluggable formatter architecture</a> and as of v2.3 includes <a href="https://github.com/microsoft/vs-streamjsonrpc/blob/master/doc/extensibility.md#message-formatterss">MessagePack support</a>.</p>
<h6 dir="auto">
<a id="user-content-how-to-build" class="anchor" aria-hidden="true" href="#how-to-build"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to build</h6>
<p dir="auto">See our <a href="/neuecc/MessagePack-CSharp/blob/master/CONTRIBUTING.md">contributor's guide</a>.</p>
<h6 dir="auto">
<a id="user-content-author-info" class="anchor" aria-hidden="true" href="#author-info"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Author Info</h6>
<p dir="auto">Yoshifumi Kawai (a.k.a. neuecc) is a software developer in Japan.
He is the Director/CTO at Grani, Inc.
Grani is a mobile game developer company in Japan and well known for using C#.
He is awarding Microsoft MVP for Visual C# since 2011.
He is known as the creator of <a href="https://github.com/neuecc/UniRx/">UniRx</a> (Reactive Extensions for Unity)</p>
<ul dir="auto">
<li>Blog: <a href="https://medium.com/@neuecc" rel="nofollow">https://medium.com/@neuecc</a> (English)</li>
<li>Blog: <a href="http://neue.cc/" rel="nofollow">http://neue.cc/</a> (Japanese)</li>
<li>Twitter: <a href="https://twitter.com/neuecc" rel="nofollow">https://twitter.com/neuecc</a> (Japanese)</li>
</ul>
</article>
  </div>
        </div>
        
        <div id="qs-Lichtso-netLink" class="qs"><h4><a href="https://github.com/Lichtso/netLink" target="_blank">Lichtso/netLink <span class="qs-url">https://github.com/Lichtso/netLink</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-msgpack-v5-implementation-for-c-11" class="anchor" aria-hidden="true" href="#msgpack-v5-implementation-for-c-11"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MsgPack v5 implementation for C++ 11</h5>
<p dir="auto"><a href="https://travis-ci.org/Lichtso/netLink" rel="nofollow"><img src="https://camo.githubusercontent.com/0000adf70ed2b9378d3a21b5b1d84de3ebe95e55f5716be88ef0808c009f824c/68747470733a2f2f7472617669732d63692e6f72672f4c69636874736f2f6e65744c696e6b2e737667" alt="Build Status" data-canonical-src="https://travis-ci.org/Lichtso/netLink.svg" style="max-width: 100%;"></a>
<a href="http://en.wikipedia.org/wiki/Zlib_License" rel="nofollow"><img src="https://camo.githubusercontent.com/603f6337b80fa50a1f2e435415435a2b210462e656662376dedea7c94f92eb5e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d5a4c49422d627269676874677265656e2e737667" alt="License" data-canonical-src="https://img.shields.io/badge/License-ZLIB-brightgreen.svg" style="max-width: 100%;"></a></p>
<h6 dir="auto">
<a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h6>
<ul dir="auto">
<li>std::streambuf serializer and deserializer</li>
<li>hierarchy or token stream</li>
<li>push and pull parser</li>
<li>byte wise data flow control</li>
</ul>
<h6 dir="auto">
<a id="user-content-small-example" class="anchor" aria-hidden="true" href="#small-example"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Small Example</h6>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='MsgPack::Serializer serializer(socket);  
std::vector&lt;std::unique_ptr&lt;MsgPack::Element&gt;&gt; arrayWithoutElements, arrayWith3Elements;
arrayWith3Elements.push_back(MsgPack::Factory(true));
arrayWith3Elements.push_back(MsgPack__Factory(Array(std::move(arrayWithoutElements))));
arrayWith3Elements.push_back(MsgPack::Factory("Hello World!"));  
serializer &lt;&lt; MsgPack__Factory(Array(std::move(arrayWith3Elements)));

MsgPack::Deserializer deserializer(socket);  
deserializer.deserialize([](std::unique_ptr&lt;MsgPack::Element&gt; parsed) {
    std::cout &lt;&lt; "Parsed: " &lt;&lt; *parsed &lt;&lt; "\n";
    return false;
}, true);'><pre><code>MsgPack::Serializer serializer(socket);  
std::vector&lt;std::unique_ptr&lt;MsgPack::Element&gt;&gt; arrayWithoutElements, arrayWith3Elements;
arrayWith3Elements.push_back(MsgPack::Factory(true));
arrayWith3Elements.push_back(MsgPack__Factory(Array(std::move(arrayWithoutElements))));
arrayWith3Elements.push_back(MsgPack::Factory("Hello World!"));  
serializer &lt;&lt; MsgPack__Factory(Array(std::move(arrayWith3Elements)));

MsgPack::Deserializer deserializer(socket);  
deserializer.deserialize([](std::unique_ptr&lt;MsgPack::Element&gt; parsed) {
    std::cout &lt;&lt; "Parsed: " &lt;&lt; *parsed &lt;&lt; "\n";
    return false;
}, true);
</code></pre></div>
<h6 dir="auto">
<a id="user-content-read-more" class="anchor" aria-hidden="true" href="#read-more"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Read More</h6>
<p dir="auto"><a href="https://github.com/Lichtso/netLink/wiki/MsgPack">Tutorial</a></p>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-c" class="qs"><h4><a href="https://github.com/msgpack/msgpack-c" target="_blank">msgpack/msgpack-c <span class="qs-url">https://github.com/msgpack/msgpack-c</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-msgpack-for-cc" class="anchor" aria-hidden="true" href="#msgpack-for-cc"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>msgpack</code> for C/C++</h5>
<p dir="auto">It's like JSON but smaller and faster.</p>
<h6 dir="auto">
<a id="user-content-overview" class="anchor" aria-hidden="true" href="#overview"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Overview</h6>
<p dir="auto"><a href="http://msgpack.org/" rel="nofollow">MessagePack</a> is an efficient binary serialization
format, which lets you exchange data among multiple languages like JSON,
except that it's faster and smaller. Small integers are encoded into a
single byte and short strings require only one extra byte in
addition to the strings themselves.</p>
<h7 dir="auto">
<a id="user-content-c-library" class="anchor" aria-hidden="true" href="#c-library"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>C Library</h7>
<p dir="auto">See <a href="https://github.com/msgpack/msgpack-c/tree/c_master">c_master</a></p>
<h7 dir="auto">
<a id="user-content-c-library-1" class="anchor" aria-hidden="true" href="#c-library-1"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>C++ Library</h7>
<p dir="auto">See <a href="https://github.com/msgpack/msgpack-c/tree/cpp_master">cpp_master</a></p>
<h7 dir="auto">
<a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Documentation</h7>
<p dir="auto">You can get additional information including the tutorial on the
<a href="https://github.com/msgpack/msgpack-c/wiki">wiki</a>.</p>
<h6 dir="auto">
<a id="user-content-contributing" class="anchor" aria-hidden="true" href="#contributing"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Contributing</h6>
<p dir="auto"><code>msgpack-c</code> is developed on GitHub at <a href="https://github.com/msgpack/msgpack-c">msgpack/msgpack-c</a>.
To report an issue or send a pull request, use the
<a href="https://github.com/msgpack/msgpack-c/issues">issue tracker</a>.</p>
<p dir="auto">Here's the list of <a href="https://github.com/msgpack/msgpack-c/graphs/contributors">great contributors</a>.</p>
<h6 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h6>
<p dir="auto"><code>msgpack-c</code> is licensed under the Boost Software License, Version 1.0. See
the <a href="/msgpack/msgpack-c/blob/master/LICENSE_1_0.txt"><code>LICENSE_1_0.txt</code></a> file for details.</p>
</article>
  </div>
        </div>
        
        <div id="qs-crystal-community-msgpack-crystal" class="qs"><h4><a href="https://github.com/crystal-community/msgpack-crystal" target="_blank">crystal-community/msgpack-crystal <span class="qs-url">https://github.com/crystal-community/msgpack-crystal</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack" class="anchor" aria-hidden="true" href="#messagepack"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack</h5>
<p dir="auto"><a href="https://github.com/crystal-community/msgpack-crystal/actions/workflows/ci.yml?query=branch%3Amaster+event%3Apush"><img src="https://github.com/crystal-community/msgpack-crystal/actions/workflows/ci.yml/badge.svg" alt="Build Status" style="max-width: 100%;"></a></p>
<p dir="auto">MessagePack implementation in Crystal.</p>
<h6 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h6>
<p dir="auto">Add this to your application's <code>shard.yml</code>:</p>
<div class="highlight highlight-source-yaml position-relative overflow-auto" data-snippet-clipboard-copy-content="dependencies:
  msgpack:
    github: crystal-community/msgpack-crystal"><pre><span class="pl-ent">dependencies</span>:
  <span class="pl-ent">msgpack</span>:
    <span class="pl-ent">github</span>: <span class="pl-s">crystal-community/msgpack-crystal</span></pre></div>
<h6 dir="auto">
<a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h6>
<div class="highlight highlight-source-crystal position-relative overflow-auto" data-snippet-clipboard-copy-content='require "msgpack"

class Location
  include MessagePack::Serializable

  property lat : Float64
  property lng : Float64
end

class House
  include MessagePack::Serializable

  property address : String
  property location : Location?
end

house = House.from_msgpack({address: "Road12", location: {lat: 12.3, lng: 34.5}}.to_msgpack)
p house
# =&gt; &lt;House:0x1b06de0 @address="Road12", @location=#&lt;Location:0x1b06dc0 @lat=12.3, @lng=34.5&gt;&gt;

p house.to_msgpack
# =&gt; Bytes[130, 167, 97, 100, 100, 114, 101, 115, 115, 166, 82, 111, 97, 100, ...

house.address = "Something"
house = House.from_msgpack(house.to_msgpack)
p house
# =&gt; #&lt;House:0x13f0d80 @address="Something", @location=#&lt;Location:0x13f0d60 @lat=12.3, @lng=34.5&gt;&gt;

house = House.from_msgpack({"address" =&gt; "Crystal Road 1234"}.to_msgpack)
p house
# =&gt; &lt;House:0x1b06d80 @address="Crystal Road 1234", @location=nil&gt;'><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">"</span>msgpack<span class="pl-pds">"</span></span>

<span class="pl-k">class</span> <span class="pl-en">Location</span>
  <span class="pl-k">include</span> <span class="pl-c1">MessagePack</span>::<span class="pl-c1">Serializable</span>

  <span class="pl-k">property</span> lat : <span class="pl-c1">Float64</span>
  <span class="pl-k">property</span> lng : <span class="pl-c1">Float64</span>
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">House</span>
  <span class="pl-k">include</span> <span class="pl-c1">MessagePack</span>::<span class="pl-c1">Serializable</span>

  <span class="pl-k">property</span> address : <span class="pl-c1">String</span>
  <span class="pl-k">property</span> location : <span class="pl-c1">Location</span>?
<span class="pl-k">end</span>

house <span class="pl-k">=</span> <span class="pl-c1">House</span>.from_msgpack({<span class="pl-c1">address:</span> <span class="pl-s"><span class="pl-pds">"</span>Road12<span class="pl-pds">"</span></span>, <span class="pl-c1">location:</span> {<span class="pl-c1">lat:</span> <span class="pl-c1">12.3</span>, <span class="pl-c1">lng:</span> <span class="pl-c1">34.5</span>}}.to_msgpack)
<span class="pl-c1">p</span> house
<span class="pl-c"><span class="pl-c">#</span> =&gt; &lt;House:0x1b06de0 @address="Road12", @location=#&lt;Location:0x1b06dc0 @lat=12.3, @lng=34.5&gt;&gt;</span>

<span class="pl-c1">p</span> house.to_msgpack
<span class="pl-c"><span class="pl-c">#</span> =&gt; Bytes[130, 167, 97, 100, 100, 114, 101, 115, 115, 166, 82, 111, 97, 100, ...</span>

house.address <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Something<span class="pl-pds">"</span></span>
house <span class="pl-k">=</span> <span class="pl-c1">House</span>.from_msgpack(house.to_msgpack)
<span class="pl-c1">p</span> house
<span class="pl-c"><span class="pl-c">#</span> =&gt; #&lt;House:0x13f0d80 @address="Something", @location=#&lt;Location:0x13f0d60 @lat=12.3, @lng=34.5&gt;&gt;</span>

house <span class="pl-k">=</span> <span class="pl-c1">House</span>.from_msgpack({<span class="pl-s"><span class="pl-pds">"</span>address<span class="pl-pds">"</span></span> =&gt; <span class="pl-s"><span class="pl-pds">"</span>Crystal Road 1234<span class="pl-pds">"</span></span>}.to_msgpack)
<span class="pl-c1">p</span> house
<span class="pl-c"><span class="pl-c">#</span> =&gt; &lt;House:0x1b06d80 @address="Crystal Road 1234", @location=nil&gt;</span></pre></div>
<h6 dir="auto">
<a id="user-content-more-examples" class="anchor" aria-hidden="true" href="#more-examples"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>More Examples</h6>
<p dir="auto"><a href="https://github.com/benoist/msgpack-crystal/tree/master/examples">examples</a></p>
<h6 dir="auto">
<a id="user-content-msgpack-rpc" class="anchor" aria-hidden="true" href="#msgpack-rpc"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Msgpack-RPC</h6>
<p dir="auto"><a href="https://github.com/kostya/simple_rpc">implemented by simple_rpc shard</a></p>
<h6 dir="auto">
<a id="user-content-copyright" class="anchor" aria-hidden="true" href="#copyright"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Copyright</h6>
<p dir="auto">Copyright 2015 Benoist Claassen</p>
<p dir="auto"><em>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License You may obtain a copy of the License at</em></p>
<p dir="auto"><a href="http://www.apache.org/licenses/LICENSE-2.0" rel="nofollow">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p dir="auto"><em>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</em></p>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-d" class="qs"><h4><a href="https://github.com/msgpack/msgpack-d" target="_blank">msgpack/msgpack-d <span class="qs-url">https://github.com/msgpack/msgpack-d</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><p dir="auto"><a href="https://travis-ci.org/msgpack/msgpack-d" rel="nofollow"><img src="https://camo.githubusercontent.com/bb42a4cb1694bafb4c7a3eefe07c5746379a835d9a25fad31aa1ed0295eccc37/68747470733a2f2f7472617669732d63692e6f72672f6d73677061636b2f6d73677061636b2d642e706e67" alt="Build Status" data-canonical-src="https://travis-ci.org/msgpack/msgpack-d.png" style="max-width: 100%;"></a></p>
<h5 dir="auto">
<a id="user-content-messagepack-for-d" class="anchor" aria-hidden="true" href="#messagepack-for-d"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for D</h5>
<p dir="auto">MessagePack is a binary-based JSON-like serialization library.</p>
<p dir="auto">MessagePack for D is a pure D implementation of MessagePack.</p>
<h5 dir="auto">
<a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h5>
<ul dir="auto">
<li>Small size and High performance</li>
<li>Zero copy serialization / deserialization</li>
<li>Streaming deserializer for non-contiguous IO situation</li>
<li>Supports D features (Ranges, Tuples, real type)</li>
</ul>
<p dir="auto">Note: The <code>real</code> type is only supported in D.
Don't use the <code>real</code> type when communicating with other programming languages.
Note that <code>Unpacker</code> will raise an exception if a loss of precision occurs.</p>
<h6 dir="auto">
<a id="user-content-current-limitations" class="anchor" aria-hidden="true" href="#current-limitations"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Current Limitations</h6>
<ul dir="auto">
<li>No circular references support</li>
<li>If you want to use the LDC compiler, you need at least version 0.15.2 beta2</li>
</ul>
<h5 dir="auto">
<a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install</h5>
<p dir="auto">Use dub to add it as a dependency:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="% dub install msgpack-d"><pre>% dub install msgpack-d</pre></div>
<h5 dir="auto">
<a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h5>
<p dir="auto">Example code can be found in the <code>example</code> directory.</p>
<p dir="auto">The documentation can be found <a href="http://msgpack.github.io/msgpack-d/" rel="nofollow">here</a></p>
<h6 dir="auto">
<a id="user-content-pack--unpack" class="anchor" aria-hidden="true" href="#pack--unpack"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>pack / unpack</h6>
<p dir="auto">msgpack-d is very simple to use. Use <code>pack</code> for serialization, and <code>unpack</code> for deserialization:</p>
<div class="highlight highlight-source-d position-relative overflow-auto" data-snippet-clipboard-copy-content='import std.file;
import msgpack;

struct S { int x; float y; string z; }

void main()
{
    S input = S(10, 25.5, "message");

    // serialize data
    ubyte[] inData = pack(input);

    // write data to a file
    write("file.dat", inData);

    // read data from a file
    ubyte[] outData = cast(ubyte[])read("file.dat");

    // unserialize the data
    S target = outData.unpack!S();

    // verify data is the same
    assert(target.x == input.x);
    assert(target.y == input.y);
    assert(target.z == input.z);
}'><pre><span class="pl-k">import</span> <span class="pl-c1">std.file</span>;
<span class="pl-k">import</span> msgpack;

<span class="pl-k">struct</span> <span class="pl-en">S</span> { <span class="pl-k">int</span> x; <span class="pl-k">float</span> y; <span class="pl-c1">string</span> z; }

<span class="pl-k">void</span> <span class="pl-en">main</span>()
{
    S input = S(<span class="pl-c1">10</span>, <span class="pl-c1">25.5</span>, <span class="pl-s"><span class="pl-pds">"</span>message<span class="pl-pds">"</span></span>);

    <span class="pl-c"><span class="pl-c">//</span> serialize data</span>
    <span class="pl-k">ubyte</span>[] inData = pack(input);

    <span class="pl-c"><span class="pl-c">//</span> write data to a file</span>
    write(<span class="pl-s"><span class="pl-pds">"</span>file.dat<span class="pl-pds">"</span></span>, inData);

    <span class="pl-c"><span class="pl-c">//</span> read data from a file</span>
    <span class="pl-k">ubyte</span>[] outData = <span class="pl-k">cast</span>(<span class="pl-k">ubyte</span>[])read(<span class="pl-s"><span class="pl-pds">"</span>file.dat<span class="pl-pds">"</span></span>);

    <span class="pl-c"><span class="pl-c">//</span> unserialize the data</span>
    S target = outData.unpack<span class="pl-k">!</span>S();

    <span class="pl-c"><span class="pl-c">//</span> verify data is the same</span>
    <span class="pl-k">assert</span>(target.x <span class="pl-k">==</span> input.x);
    <span class="pl-k">assert</span>(target.y <span class="pl-k">==</span> input.y);
    <span class="pl-k">assert</span>(target.z <span class="pl-k">==</span> input.z);
}</pre></div>
<h7 dir="auto">
<a id="user-content-feature-skip-serializationdeserialization-of-a-specific-field" class="anchor" aria-hidden="true" href="#feature-skip-serializationdeserialization-of-a-specific-field"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Feature: Skip serialization/deserialization of a specific field.</h7>
<p dir="auto">Use the <code>@nonPacked</code> attribute:</p>
<div class="highlight highlight-source-d position-relative overflow-auto" data-snippet-clipboard-copy-content="struct User
{
    string name;
    @nonPacked int level;  // pack / unpack will ignore the 'level' field
}"><pre><span class="pl-k">struct</span> <span class="pl-en">User</span>
{
    <span class="pl-c1">string</span> name;
    @nonPacked <span class="pl-k">int</span> level;  <span class="pl-c"><span class="pl-c">//</span> pack / unpack will ignore the 'level' field</span>
}</pre></div>
<h7 dir="auto">
<a id="user-content-feature-use-your-own-serializationdeserialization-routines-for-custom-class-and-struct-types" class="anchor" aria-hidden="true" href="#feature-use-your-own-serializationdeserialization-routines-for-custom-class-and-struct-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Feature: Use your own serialization/deserialization routines for custom class and struct types.</h7>
<p dir="auto">msgpack-d provides the functions <code>registerPackHandler</code> / <code>registerUnpackHandler</code> to allow you
to use custom routines during the serialization or deserialization of user-defined class and struct types.
This feature is especially useful when serializing a derived class object when that object is statically
typed as a base class object.</p>
<p dir="auto">For example:</p>
<div class="highlight highlight-source-d position-relative overflow-auto" data-snippet-clipboard-copy-content="class Document { }
class XmlDocument : Document
{
    this() { }
    this(string name) { this.name = name; }
    string name;
}

void xmlPackHandler(ref Packer p, ref XmlDocument xml)
{
    p.pack(xml.name);
}

void xmlUnpackHandler(ref Unpacker u, ref XmlDocument xml)
{
    u.unpack(xml.name);
}

void main()
{
    /// Register the 'xmlPackHandler' and 'xmlUnpackHandler' routines for
    /// XmlDocument object instances.
    registerPackHandler!(XmlDocument, xmlPackHandler);
    registerUnpackHandler!(XmlDocument, xmlUnpackHandler);

    /// Now we can serialize/deserialize XmlDocument object instances via a
    /// base class reference.
    Document doc = new XmlDocument(&quot;test.xml&quot;);
    auto data = pack(doc);
    XmlDocument xml = unpack!XmlDocument(data);
    assert(xml.name == &quot;test.xml&quot;);  // xml.name is &quot;test.xml&quot;
}"><pre><span class="pl-k">class</span> <span class="pl-en">Document</span> { }
<span class="pl-k">class</span> <span class="pl-en">XmlDocument</span> : <span class="pl-e">Document</span>
{
    <span class="pl-en">this</span>() { }
    <span class="pl-en">this</span>(<span class="pl-c1">string</span> name) { <span class="pl-c1">this</span>.name = name; }
    <span class="pl-c1">string</span> name;
}

<span class="pl-k">void</span> <span class="pl-en">xmlPackHandler</span>(<span class="pl-k">ref</span> Packer p, <span class="pl-k">ref</span> XmlDocument xml)
{
    p.pack(xml.name);
}

<span class="pl-k">void</span> <span class="pl-en">xmlUnpackHandler</span>(<span class="pl-k">ref</span> Unpacker u, <span class="pl-k">ref</span> XmlDocument xml)
{
    u.unpack(xml.name);
}

<span class="pl-k">void</span> <span class="pl-en">main</span>()
{
    <span class="pl-c"><span class="pl-c">//</span>/ Register the 'xmlPackHandler' and 'xmlUnpackHandler' routines for</span>
    <span class="pl-c"><span class="pl-c">//</span>/ XmlDocument object instances.</span>
    registerPackHandler<span class="pl-k">!</span>(XmlDocument, xmlPackHandler);
    registerUnpackHandler<span class="pl-k">!</span>(XmlDocument, xmlUnpackHandler);

    <span class="pl-c"><span class="pl-c">//</span>/ Now we can serialize/deserialize XmlDocument object instances via a</span>
    <span class="pl-c"><span class="pl-c">//</span>/ base class reference.</span>
    <span class="pl-c1">Document</span> doc = <span class="pl-k">new</span> XmlDocument(<span class="pl-s"><span class="pl-pds">"</span>test.xml<span class="pl-pds">"</span></span>);
    <span class="pl-k">auto</span> data = pack(doc);
    XmlDocument xml = unpack<span class="pl-k">!</span>XmlDocument(data);
    <span class="pl-k">assert</span>(xml.name <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>test.xml<span class="pl-pds">"</span></span>);  <span class="pl-c"><span class="pl-c">//</span> xml.name is "test.xml"</span>
}</pre></div>
<p dir="auto">In addition, here is also a method using <code>@serializedAs</code> attribute:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='import std.datetime: Clock, SysTime;
static struct SysTimePackProxy
{
    static void serialize(ref Packer p, ref in SysTime tim)
    {
        p.pack(tim.toISOExtString());
    }

    static void deserialize(ref Unpacker u, ref SysTime tim)
    {
        string tmp;
        u.unpack(tmp);
        tim = SysTime.fromISOExtString(tmp);
    }
}
static struct LogData
{
    string msg;
    string file;
    ulong  line;
    @serializedAs!SysTimePackProxy SysTime timestamp;

    this(string message, string file = __FILE__, ulong line = __LINE__)
    {
        this.msg = message;
        this.file = file;
        this.line = line;
        this.timestamp = Clock.currTime();
    }
}

void main()
{
    /// Now we can serialize/deserialize LogData
    LogData[] logs;
    logs ~= LogData("MessagePack is nice!");
    auto data = pack(logs);
    LogData[] datas = unpack!(LogData[])(data);
    assert(datas[0].timestamp.toString() == datas[0].timestamp.toString());
}'><pre><code>import std.datetime: Clock, SysTime;
static struct SysTimePackProxy
{
    static void serialize(ref Packer p, ref in SysTime tim)
    {
        p.pack(tim.toISOExtString());
    }

    static void deserialize(ref Unpacker u, ref SysTime tim)
    {
        string tmp;
        u.unpack(tmp);
        tim = SysTime.fromISOExtString(tmp);
    }
}
static struct LogData
{
    string msg;
    string file;
    ulong  line;
    @serializedAs!SysTimePackProxy SysTime timestamp;

    this(string message, string file = __FILE__, ulong line = __LINE__)
    {
        this.msg = message;
        this.file = file;
        this.line = line;
        this.timestamp = Clock.currTime();
    }
}

void main()
{
    /// Now we can serialize/deserialize LogData
    LogData[] logs;
    logs ~= LogData("MessagePack is nice!");
    auto data = pack(logs);
    LogData[] datas = unpack!(LogData[])(data);
    assert(datas[0].timestamp.toString() == datas[0].timestamp.toString());
}
</code></pre></div>
<h6 dir="auto">
<a id="user-content-the-packerimpl--unpacker--streamingunpacker-types" class="anchor" aria-hidden="true" href="#the-packerimpl--unpacker--streamingunpacker-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The PackerImpl / Unpacker / StreamingUnpacker types</h6>
<p dir="auto">These types are used by the <code>pack</code> and <code>unpack</code> functions.</p>
<p dir="auto">See the documentation of <a href="http://msgpack.github.io/msgpack-d/#PackerImpl" rel="nofollow">PackerImpl</a>, <a href="http://msgpack.github.io/msgpack-d/#Unpacker" rel="nofollow">Unpacker</a> and <a href="http://msgpack.github.io/msgpack-d/#StreamingUnpacker" rel="nofollow">StreamingUnpacker</a> for more details.</p>
<h5 dir="auto">
<a id="user-content-links" class="anchor" aria-hidden="true" href="#links"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Links</h5>
<ul dir="auto">
<li>
<p dir="auto"><a href="http://msgpack.org/" rel="nofollow">The MessagePack Project</a></p>
<p dir="auto">The official MessagePack protocol website.</p>
</li>
<li>
<p dir="auto"><a href="https://github.com/msgpack/msgpack-d/issues">msgpack-d's issue tracker</a></p>
<p dir="auto">Use this issue tracker to review and file bugs in msgpack-d.</p>
</li>
<li>
<p dir="auto"><a href="http://github.com/msgpack/">MessagePack's Github</a></p>
<p dir="auto">Other language bindings and implementations of the msgpack protocol can be found here.</p>
</li>
</ul>
<h5 dir="auto">
<a id="user-content-copyright" class="anchor" aria-hidden="true" href="#copyright"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Copyright</h5>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="Copyright (c) 2010- Masahiro Nakagawa"><pre><code>Copyright (c) 2010- Masahiro Nakagawa
</code></pre></div>
<h5 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h5>
<p dir="auto">Distributed under the <a href="http://www.boost.org/users/license.html" rel="nofollow">Boost Software License, Version 1.0</a>.</p>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-erlang" class="qs"><h4><a href="https://github.com/msgpack/msgpack-erlang" target="_blank">msgpack/msgpack-erlang <span class="qs-url">https://github.com/msgpack/msgpack-erlang</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-erlang" class="anchor" aria-hidden="true" href="#messagepack-erlang"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack Erlang</h5>
<p dir="auto"><a href="https://travis-ci.org/msgpack/msgpack-erlang" rel="nofollow"><img src="https://camo.githubusercontent.com/a3618d198118d6bd9aaab570cd93b334ea0063fba34fc5f279539c661a883ef4/68747470733a2f2f7365637572652e7472617669732d63692e6f72672f6d73677061636b2f6d73677061636b2d65726c616e672e706e67" alt="Travis" data-canonical-src="https://secure.travis-ci.org/msgpack/msgpack-erlang.png" style="max-width: 100%;"></a>
<a href="https://drone.io/github.com/msgpack/msgpack-erlang" rel="nofollow"><img src="https://camo.githubusercontent.com/f2bf9dd88647517fa712dc708995900c087a07a069569ab82a90bac0c6efe4ee/68747470733a2f2f64726f6e652e696f2f6769746875622e636f6d2f6d73677061636b2f6d73677061636b2d65726c616e672f7374617475732e706e67" alt="Drone.io" data-canonical-src="https://drone.io/github.com/msgpack/msgpack-erlang/status.png" style="max-width: 100%;"></a>
<a href="https://hex.pm/packages/msgpack" rel="nofollow"><img src="https://camo.githubusercontent.com/e17f916ae44ed230a8f4085a686a3ae3dc9f3b9c0dafda98740bfdb41c327497/68747470733a2f2f696d672e736869656c64732e696f2f686578706d2f762f6d73677061636b2e737667" alt="hex.pm version" data-canonical-src="https://img.shields.io/hexpm/v/msgpack.svg" style="max-width: 100%;"></a></p>
<h6 dir="auto">
<a id="user-content-prerequisites-for-runtime" class="anchor" aria-hidden="true" href="#prerequisites-for-runtime"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Prerequisites for runtime</h6>
<p dir="auto"><a href="http://erlang.org/" rel="nofollow">Erlang/OTP</a>, &gt;= 17.0 Also based on
<a href="https://github.com/msgpack/msgpack/blob/0b8f5ac67cdd130f4d4d4fe6afb839b989fdb86a/spec.md">the new msgpack spec 0b8f5a</a>.</p>
<h6 dir="auto">
<a id="user-content-edit-rebarconfig-to-use-in-your-application" class="anchor" aria-hidden="true" href="#edit-rebarconfig-to-use-in-your-application"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>edit rebar.config to use in your application</h6>
<div class="highlight highlight-source-erlang position-relative overflow-auto" data-snippet-clipboard-copy-content='{deps, [
  {msgpack, ".*",
    {git, "git://github.com/msgpack/msgpack-erlang.git", {branch, "master"}}}
]}.'><pre>{<span class="pl-c1">deps</span>, [
  {<span class="pl-c1">msgpack</span>, <span class="pl-s"><span class="pl-pds">"</span>.*<span class="pl-pds">"</span></span>,
    {<span class="pl-c1">git</span>, <span class="pl-s"><span class="pl-pds">"</span>git://github.com/msgpack/msgpack-erlang.git<span class="pl-pds">"</span></span>, {<span class="pl-c1">branch</span>, <span class="pl-s"><span class="pl-pds">"</span>master<span class="pl-pds">"</span></span>}}}
]}.</pre></div>
<p dir="auto">Or as it is <a href="https://hex.pm/packages/msgpack" rel="nofollow">now published at hex.pm</a>, just</p>
<div class="highlight highlight-source-erlang position-relative overflow-auto" data-snippet-clipboard-copy-content="{deps, [msgpack]}."><pre>{<span class="pl-c1">deps</span>, [<span class="pl-c1">msgpack</span>]}.</pre></div>
<p dir="auto">might work.</p>
<h6 dir="auto">
<a id="user-content-simple-deserialization" class="anchor" aria-hidden="true" href="#simple-deserialization"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Simple deserialization</h6>
<div class="highlight highlight-source-erlang position-relative overflow-auto" data-snippet-clipboard-copy-content="Ham = msgpack:pack(Spam),
{ok, Spam} = msgpack:unpack(Ham)."><pre><span class="pl-smi">Ham</span> <span class="pl-k">=</span> <span class="pl-en">msgpack</span>:<span class="pl-en">pack</span>(<span class="pl-smi">Spam</span>),
{<span class="pl-c1">ok</span>, <span class="pl-smi">Spam</span>} <span class="pl-k">=</span> <span class="pl-en">msgpack</span>:<span class="pl-en">unpack</span>(<span class="pl-smi">Ham</span>).</pre></div>
<h6 dir="auto">
<a id="user-content-stream-deserialization" class="anchor" aria-hidden="true" href="#stream-deserialization"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Stream deserialization</h6>
<div class="highlight highlight-source-erlang position-relative overflow-auto" data-snippet-clipboard-copy-content="{Term0, Rest0} = msgpack:unpack_stream(Binary),
{Term1, Rest1} = msgpack:unpack_stream(Rest0),
..."><pre>{<span class="pl-smi">Term0</span>, <span class="pl-smi">Rest0</span>} <span class="pl-k">=</span> <span class="pl-en">msgpack</span>:<span class="pl-en">unpack_stream</span>(<span class="pl-smi">Binary</span>),
{<span class="pl-smi">Term1</span>, <span class="pl-smi">Rest1</span>} <span class="pl-k">=</span> <span class="pl-en">msgpack</span>:<span class="pl-en">unpack_stream</span>(<span class="pl-smi">Rest0</span>),
...</pre></div>
<h6 dir="auto">
<a id="user-content-options-for-packing-and-unpacking" class="anchor" aria-hidden="true" href="#options-for-packing-and-unpacking"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Options, for packing and unpacking</h6>
<h7 dir="auto">
<a id="user-content-spec-newold" class="anchor" aria-hidden="true" href="#spec-newold"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{spec, new|old}</code>
</h7>
<p dir="auto">Both for packing and unpacking. Default is <code>new</code>. Major difference
between old and new spec is:</p>
<ul dir="auto">
<li>raw family (<code>0xa0~0xbf</code>, <code>0xda</code>, <code>0xdb</code>) becomes new str family</li>
<li>
<code>0xd9</code> is new as str8</li>
<li>new bin space (<code>0xc4, 0xc5, 0xc6</code> as bin8, bin16, bin32)</li>
<li>new ext space (<code>0xc7, 0xc8, 0xc9</code> as ext8, ext16, ext32)</li>
<li>new fixext space (<code>0xd4, 0xd5, 0xd6, 0xd7, 0xd8</code> as fixext1, fixext2, fixext4, fixext8, fixext16),</li>
</ul>
<p dir="auto">The default is new spec. Old spec mode does not handle these new types but
returns error. To use
<a href="https://github.com/msgpack/msgpack/blob/master/spec-old.md">old spec</a>
mode, this option is explicitly added.</p>
<div class="highlight highlight-source-erlang position-relative overflow-auto" data-snippet-clipboard-copy-content="OldHam = msgpack:pack(Spam, [{spec, old}]),
{ok, Spam} = msgpack:unpack(OldHam, [{spec, old}])."><pre><span class="pl-smi">OldHam</span> <span class="pl-k">=</span> <span class="pl-en">msgpack</span>:<span class="pl-en">pack</span>(<span class="pl-smi">Spam</span>, [{<span class="pl-c1">spec</span>, <span class="pl-c1">old</span>}]),
{<span class="pl-c1">ok</span>, <span class="pl-smi">Spam</span>} <span class="pl-k">=</span> <span class="pl-en">msgpack</span>:<span class="pl-en">unpack</span>(<span class="pl-smi">OldHam</span>, [{<span class="pl-c1">spec</span>, <span class="pl-c1">old</span>}]).</pre></div>
<h7 dir="auto">
<a id="user-content-allow_atom-nonepack" class="anchor" aria-hidden="true" href="#allow_atom-nonepack"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{allow_atom, none|pack}</code>
</h7>
<p dir="auto">Only in packing. Atoms are packed as binaries. Default value is <code>pack</code>.
Otherwise, any term including atoms throws badarg.</p>
<h7 dir="auto">
<a id="user-content-known_atoms-atom" class="anchor" aria-hidden="true" href="#known_atoms-atom"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{known_atoms, [atom()]}</code>
</h7>
<p dir="auto">Both in packing and unpacking. In packing, if an atom is in this list
a binary is encoded as a binary. In unpacking, msgpacked binaries are
decoded as atoms with <code>erlang:binary_to_existing_atom/2</code> with encoding
<code>utf8</code>. Default value is an empty list.</p>
<p dir="auto">Even if <code>allow_atom</code> is <code>none</code>, known atoms are packed.</p>
<h7 dir="auto">
<a id="user-content-unpack_str-as_binaryas_list" class="anchor" aria-hidden="true" href="#unpack_str-as_binaryas_list"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{unpack_str, as_binary|as_list}</code>
</h7>
<p dir="auto">A switch to choose decoded term style of <code>str</code> type when <em>unpacking</em>.
Only available at new spec. Default is <code>as_list</code>.</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="mode        as_binary    as_list
-----------+------------+-------
bin         binary()     binary()
str         binary()     string()"><pre><code>mode        as_binary    as_list
-----------+------------+-------
bin         binary()     binary()
str         binary()     string()
</code></pre></div>
<h7 dir="auto">
<a id="user-content-validate_string-boolean" class="anchor" aria-hidden="true" href="#validate_string-boolean"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{validate_string, boolean()}</code>
</h7>
<p dir="auto">Only in unpacking, UTF-8 validation at unpacking from <code>str</code> type will
be enabled. Default value is <code>false</code>.</p>
<h7 dir="auto">
<a id="user-content-pack_str-from_binaryfrom_listnone" class="anchor" aria-hidden="true" href="#pack_str-from_binaryfrom_listnone"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{pack_str, from_binary|from_list|none}</code>
</h7>
<p dir="auto">A switch to choose packing of <code>string()</code> when packing. Only available
at new spec. Default is <code>from_list</code> for symmetry with <code>unpack_str</code>
option.</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="mode        from_list    from_binary    none
-----------+------------+--------------+-----------------
binary()    bin          str*/bin       bin
string()    str*/array   array of int   array of int
list()      array        array          array"><pre><code>mode        from_list    from_binary    none
-----------+------------+--------------+-----------------
binary()    bin          str*/bin       bin
string()    str*/array   array of int   array of int
list()      array        array          array
</code></pre></div>
<p dir="auto">But the default option pays the cost of performance for symmetry. If
the overhead of UTF-8 validation is unacceptable, choosing <code>none</code> as
the option would be the best.</p>
<ul dir="auto">
<li>* Tries to pack as <code>str</code> if it is a valid <code>string()</code>.</li>
</ul>
<h7 dir="auto">
<a id="user-content-map_format-mapjiffyjsx" class="anchor" aria-hidden="true" href="#map_format-mapjiffyjsx"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{map_format, map|jiffy|jsx}</code>
</h7>
<p dir="auto">Both at packing and unpacking. Default value is <code>map</code>.</p>
<div class="highlight highlight-source-erlang position-relative overflow-auto" data-snippet-clipboard-copy-content='msgpack:pack(#{ &lt;&lt;"key"&gt;&gt; =&gt; &lt;&lt;"value"&gt;&gt; }, []).
msgpack:pack(#{ &lt;&lt;"key"&gt;&gt; =&gt; &lt;&lt;"value"&gt;&gt; }, [{map_format, map}]).
msgpack:pack({[{&lt;&lt;"key"&gt;&gt;, &lt;&lt;"value"&gt;&gt;}]}, [{map_format, jiffy}]),
msgpack:pack([{&lt;&lt;"key"&gt;&gt;, &lt;&lt;"value"&gt;&gt;}], [{map_format, jsx}]).'><pre><span class="pl-en">msgpack</span>:<span class="pl-en">pack</span>(#{ &lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span>&gt;&gt; <span class="pl-k">=&gt;</span> &lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>&gt;&gt; }, []).
<span class="pl-en">msgpack</span>:<span class="pl-en">pack</span>(#{ &lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span>&gt;&gt; <span class="pl-k">=&gt;</span> &lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>&gt;&gt; }, [{<span class="pl-c1">map_format</span>, <span class="pl-c1">map</span>}]).
<span class="pl-en">msgpack</span>:<span class="pl-en">pack</span>({[{&lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span>&gt;&gt;, &lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>&gt;&gt;}]}, [{<span class="pl-c1">map_format</span>, <span class="pl-c1">jiffy</span>}]),
<span class="pl-en">msgpack</span>:<span class="pl-en">pack</span>([{&lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span>&gt;&gt;, &lt;&lt;<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>&gt;&gt;}], [{<span class="pl-c1">map_format</span>, <span class="pl-c1">jsx</span>}]).</pre></div>
<h7 dir="auto">
<a id="user-content-ext-msgpack_ext_packer-msgpack_ext_unpackermodule" class="anchor" aria-hidden="true" href="#ext-msgpack_ext_packer-msgpack_ext_unpackermodule"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>{ext, {msgpack_ext_packer(), msgpack_ext_unpacker()}|module()}</code>
</h7>
<p dir="auto">At both. The default behaviour in case of facing ext data at decoding
is to ignore them as its length is known.</p>
<p dir="auto">Now msgpack-erlang supports ext type. Now you can serialize everything
with your original (de)serializer. That will enable us to handle
erlang- native types like <code>pid()</code>, <code>ref()</code> contained in <code>tuple()</code>. See
<code>test/msgpack_ext_example_tests.erl</code> for example code.</p>
<div class="highlight highlight-source-erlang position-relative overflow-auto" data-snippet-clipboard-copy-content="Packer = fun({ref, Ref}, Opt) when is_reference(Ref) -&gt; {ok, {12, term_to_binary(Ref)}} end,
Unpacker = fun(12, Bin) -&gt; {ok, {ref, binary_to_term(Bin)}} end,
Ref = make_ref(),
Opt = [{ext,{Packer,Unpacker}}],
{ok, {ref, Ref}} = msgpack:unpack(msgpack:pack({ref, Ref}, Opt), Opt)."><pre><span class="pl-smi">Packer</span> <span class="pl-k">=</span> <span class="pl-k">fun</span>({<span class="pl-c1">ref</span>, <span class="pl-smi">Ref</span>}, <span class="pl-smi">Opt</span>) <span class="pl-k">when</span> <span class="pl-en">is_reference</span>(<span class="pl-smi">Ref</span>) -&gt; {<span class="pl-c1">ok</span>, {<span class="pl-c1">12</span>, <span class="pl-en">term_to_binary</span>(<span class="pl-smi">Ref</span>)}} <span class="pl-k">end</span>,
<span class="pl-smi">Unpacker</span> <span class="pl-k">=</span> <span class="pl-k">fun</span>(<span class="pl-c1">12</span>, <span class="pl-smi">Bin</span>) -&gt; {<span class="pl-c1">ok</span>, {<span class="pl-c1">ref</span>, <span class="pl-en">binary_to_term</span>(<span class="pl-smi">Bin</span>)}} <span class="pl-k">end</span>,
<span class="pl-smi">Ref</span> <span class="pl-k">=</span> <span class="pl-en">make_ref</span>(),
<span class="pl-smi">Opt</span> <span class="pl-k">=</span> [{<span class="pl-c1">ext</span>,{<span class="pl-smi">Packer</span>,<span class="pl-smi">Unpacker</span>}}],
{<span class="pl-c1">ok</span>, {<span class="pl-c1">ref</span>, <span class="pl-smi">Ref</span>}} <span class="pl-k">=</span> <span class="pl-en">msgpack</span>:<span class="pl-en">unpack</span>(<span class="pl-en">msgpack</span>:<span class="pl-en">pack</span>({<span class="pl-c1">ref</span>, <span class="pl-smi">Ref</span>}, <span class="pl-smi">Opt</span>), <span class="pl-smi">Opt</span>).</pre></div>
<h6 dir="auto">
<a id="user-content-misc" class="anchor" aria-hidden="true" href="#misc"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Misc</h6>
<h7 dir="auto">
<a id="user-content-float-type" class="anchor" aria-hidden="true" href="#float-type"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Float type</h7>
<p dir="auto">The Float type of Message Pack represents IEEE 754 floating point number, so it includes Nan and Infinity.
In unpacking, msgpack-erlang returns <code>nan</code>, <code>positive_infinity</code> and <code>negative_infinity</code>.</p>
<h6 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h6>
<p dir="auto">Apache License 2.0</p>
<h5 dir="auto">
<a id="user-content-release-notes" class="anchor" aria-hidden="true" href="#release-notes"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Release Notes</h5>
<h6 dir="auto">
<a id="user-content-070" class="anchor" aria-hidden="true" href="#070"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.7.0</h6>
<ul dir="auto">
<li>Support <code>nan</code>, <code>positive_infinity</code> and <code>negative_infinity</code>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-060" class="anchor" aria-hidden="true" href="#060"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.6.0</h6>
<ul dir="auto">
<li>Support OTP 19.0</li>
</ul>
<h6 dir="auto">
<a id="user-content-050" class="anchor" aria-hidden="true" href="#050"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.5.0</h6>
<ul dir="auto">
<li>Renewed optional arguments to pack/unpack interface. This is
incompatible change from 0.4 series.</li>
</ul>
<h6 dir="auto">
<a id="user-content-040" class="anchor" aria-hidden="true" href="#040"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.4.0</h6>
<ul dir="auto">
<li>Deprecate <code>nil</code>
</li>
<li>Moved to rebar3</li>
<li>Promote default map unpacker as default format when OTP is &gt;= 17</li>
<li>Added QuickCheck tests</li>
<li>Since this version OTP older than R16B03-1 are no more supported</li>
</ul>
<h6 dir="auto">
<a id="user-content-035--034" class="anchor" aria-hidden="true" href="#035--034"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.3.5 / 0.3.4</h6>
<ul dir="auto">
<li>0.3 series will be the last versions that supports R16B or older
versions of OTP.</li>
<li>OTP 18.0 support</li>
<li>Promote default map unpacker as default format when OTP is &gt;= 18</li>
</ul>
<h6 dir="auto">
<a id="user-content-033" class="anchor" aria-hidden="true" href="#033"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.3.3</h6>
<ul dir="auto">
<li>Add OTP 17 series to Travis-CI tests</li>
<li>Fix wrong numbering for ext types</li>
<li>Allow packing maps even when {format,map} is not set</li>
<li>Fix Dialyzer invalid contract warning</li>
<li>Proper use of null for jiffy-style encoding/decoding</li>
</ul>
<h6 dir="auto">
<a id="user-content-032" class="anchor" aria-hidden="true" href="#032"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.3.2</h6>
<ul dir="auto">
<li>set back default style as jiffy</li>
<li>fix bugs around nil/null handling</li>
</ul>
<h6 dir="auto">
<a id="user-content-030" class="anchor" aria-hidden="true" href="#030"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.3.0</h6>
<ul dir="auto">
<li>supports map new in 17.0</li>
<li>jiffy-style maps will be deprecated in near future</li>
<li>set default style as map</li>
</ul>
<h6 dir="auto">
<a id="user-content-028" class="anchor" aria-hidden="true" href="#028"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.8</h6>
<p dir="auto">0.2 series works with OTP 17.0, R16, R15, and with MessagePack's new
and old format. But does not support <code>map</code> type introduced in
OTP 17.0.</p>
<p dir="auto">It also supports JSX-compatible mode.</p>
</article>
  </div>
        </div>
        
        <div id="qs-vmihailenco-msgpack" class="qs"><h4><a href="https://msgpack.uptrace.dev/" target="_blank">vmihailenco/msgpack <span class="qs-url">https://msgpack.uptrace.dev/</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-encoding-for-golang" class="anchor" aria-hidden="true" href="#messagepack-encoding-for-golang"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack encoding for Golang</h5>
<p dir="auto"><a href="https://travis-ci.org/vmihailenco/msgpack" rel="nofollow"><img src="https://camo.githubusercontent.com/61bdb4c546130de8b74eddff7de0d6cf11a309c5c022937fd7735c36ac6547e1/68747470733a2f2f7472617669732d63692e6f72672f766d696861696c656e636f2f6d73677061636b2e737667" alt="Build Status" data-canonical-src="https://travis-ci.org/vmihailenco/msgpack.svg" style="max-width: 100%;"></a>
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5" rel="nofollow"><img src="https://camo.githubusercontent.com/cffc384b58a566df38d9a72cd4c2bcf31a0f7f6c25e8b8b69ebfc5064314bebe/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f766d696861696c656e636f2f6d73677061636b2f7635" alt="PkgGoDev" data-canonical-src="https://pkg.go.dev/badge/github.com/vmihailenco/msgpack/v5" style="max-width: 100%;"></a>
<a href="https://msgpack.uptrace.dev/" rel="nofollow"><img src="https://camo.githubusercontent.com/69e8fd1ebf3fdaf0158bdb0d1b6cb30212c1e950e117a0b9d19684ead491d421/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6d73677061636b2d646f63756d656e746174696f6e2d696e666f726d6174696f6e616c" alt="Documentation" data-canonical-src="https://img.shields.io/badge/msgpack-documentation-informational" style="max-width: 100%;"></a>
<a href="https://discord.gg/rWtp5Aj" rel="nofollow"><img src="https://camo.githubusercontent.com/a19403897efd43047f062aba945f6fde175ed63a420b0a94e8d12809ba56f74f/68747470733a2f2f646973636f72646170702e636f6d2f6170692f6775696c64732f3735323037303130353834373935353531382f7769646765742e706e67" alt="Chat" data-canonical-src="https://discordapp.com/api/guilds/752070105847955518/widget.png" style="max-width: 100%;"></a></p>
<p dir="auto">msgpack is brought to you by <g-emoji class="g-emoji" alias="star" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png">⭐</g-emoji> <a href="https://github.com/uptrace/uptrace"><strong>uptrace/uptrace</strong></a>.
Uptrace is an open source and blazingly fast <strong>distributed tracing</strong> backend powered by
OpenTelemetry and ClickHouse. Give it a star as well!</p>
<h6 dir="auto">
<a id="user-content-resources" class="anchor" aria-hidden="true" href="#resources"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Resources</h6>
<ul dir="auto">
<li><a href="https://msgpack.uptrace.dev" rel="nofollow">Documentation</a></li>
<li><a href="https://discord.gg/rWtp5Aj" rel="nofollow">Chat</a></li>
<li><a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5" rel="nofollow">Reference</a></li>
<li><a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#pkg-examples" rel="nofollow">Examples</a></li>
</ul>
<p dir="auto">Other projects you may like:</p>
<ul dir="auto">
<li>
<a href="https://bun.uptrace.dev" rel="nofollow">Bun</a> - fast and simple SQL client for PostgreSQL, MySQL, and SQLite.</li>
<li>
<a href="https://bunrouter.uptrace.dev/" rel="nofollow">BunRouter</a> - fast and flexible HTTP router for Go.</li>
</ul>
<h6 dir="auto">
<a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h6>
<ul dir="auto">
<li>Primitives, arrays, maps, structs, time.Time and interface{}.</li>
<li>Appengine *datastore.Key and datastore.Cursor.</li>
<li>
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#CustomEncoder" rel="nofollow">CustomEncoder</a>/<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#CustomDecoder" rel="nofollow">CustomDecoder</a> interfaces for custom encoding.</li>
<li>
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#example-RegisterExt" rel="nofollow">Extensions</a> to encode
type information.</li>
<li>Renaming fields via <code>msgpack:"my_field_name"</code> and alias via <code>msgpack:"alias:another_name"</code>.</li>
<li>Omitting individual empty fields via <code>msgpack:",omitempty"</code> tag or all
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#example-Marshal-OmitEmpty" rel="nofollow">empty fields in a struct</a>.</li>
<li>
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#Encoder.SetSortMapKeys" rel="nofollow">Map keys sorting</a>.</li>
<li>Encoding/decoding all
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#Encoder.UseArrayEncodedStructs" rel="nofollow">structs as arrays</a>
or
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#example-Marshal-AsArray" rel="nofollow">individual structs</a>.</li>
<li>
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#Encoder.SetCustomStructTag" rel="nofollow">Encoder.SetCustomStructTag</a> with <a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#Decoder.SetCustomStructTag" rel="nofollow">Decoder.SetCustomStructTag</a> can turn msgpack into drop-in
replacement for any tag.</li>
<li>Simple but very fast and efficient
<a href="https://pkg.go.dev/github.com/vmihailenco/msgpack/v5#example-Decoder.Query" rel="nofollow">queries</a>.</li>
</ul>
<h6 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h6>
<p dir="auto">msgpack supports 2 last Go versions and requires support for
<a href="https://github.com/golang/go/wiki/Modules">Go modules</a>. So make sure to initialize a Go module:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="go mod init github.com/my/repo"><pre>go mod init github.com/my/repo</pre></div>
<p dir="auto">And then install msgpack/v5 (note <em>v5</em> in the import; omitting it is a popular mistake):</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="go get github.com/vmihailenco/msgpack/v5"><pre>go get github.com/vmihailenco/msgpack/v5</pre></div>
<h6 dir="auto">
<a id="user-content-quickstart" class="anchor" aria-hidden="true" href="#quickstart"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quickstart</h6>
<div class="highlight highlight-source-go position-relative overflow-auto" data-snippet-clipboard-copy-content='import "github.com/vmihailenco/msgpack/v5"

func ExampleMarshal() {
    type Item struct {
        Foo string
    }

    b, err := msgpack.Marshal(&amp;Item{Foo: "bar"})
    if err != nil {
        panic(err)
    }

    var item Item
    err = msgpack.Unmarshal(b, &amp;item)
    if err != nil {
        panic(err)
    }
    fmt.Println(item.Foo)
    // Output: bar
}'><pre><span class="pl-k">import</span> <span class="pl-s">"github.com/vmihailenco/msgpack/v5"</span>

<span class="pl-k">func</span> <span class="pl-en">ExampleMarshal</span>() {
    <span class="pl-k">type</span> <span class="pl-smi">Item</span> <span class="pl-k">struct</span> {
        <span class="pl-c1">Foo</span> <span class="pl-smi">string</span>
    }

    <span class="pl-s1">b</span>, <span class="pl-s1">err</span> <span class="pl-c1">:=</span> <span class="pl-s1">msgpack</span>.<span class="pl-en">Marshal</span>(<span class="pl-c1">&amp;</span><span class="pl-smi">Item</span>{<span class="pl-c1">Foo</span>: <span class="pl-s">"bar"</span>})
    <span class="pl-k">if</span> <span class="pl-s1">err</span> <span class="pl-c1">!=</span> <span class="pl-c1">nil</span> {
        <span class="pl-en">panic</span>(<span class="pl-s1">err</span>)
    }

    <span class="pl-k">var</span> <span class="pl-s1">item</span> <span class="pl-smi">Item</span>
    <span class="pl-s1">err</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span>.<span class="pl-en">Unmarshal</span>(<span class="pl-s1">b</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">item</span>)
    <span class="pl-k">if</span> <span class="pl-s1">err</span> <span class="pl-c1">!=</span> <span class="pl-c1">nil</span> {
        <span class="pl-en">panic</span>(<span class="pl-s1">err</span>)
    }
    <span class="pl-s1">fmt</span>.<span class="pl-en">Println</span>(<span class="pl-s1">item</span>.<span class="pl-c1">Foo</span>)
    <span class="pl-c">// Output: bar</span>
}</pre></div>
</article>
  </div>
        </div>
        
        <div id="qs-ugorji-go" class="qs"><h4><a href="https://github.com/ugorji/go" target="_blank">ugorji/go <span class="qs-url">https://github.com/ugorji/go</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><p dir="auto"><strong>MessagePack and <a href="http://github.com/ugorji/binc">Binc</a> Codec for <a href="http://golang.org" rel="nofollow">Go</a> Language.</strong></p>
<p dir="auto"><em>A High Performance, Feature-Rich, Idiomatic encode/decode and rpc library</em>.</p>
<p dir="auto">To install:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="go get github.com/ugorji/go/codec"><pre><code>go get github.com/ugorji/go/codec
</code></pre></div>
<p dir="auto">Source: [<a href="http://github.com/ugorji/go">http://github.com/ugorji/go</a>]<br>
Online documentation: [<a href="http://godoc.org/github.com/ugorji/go/codec" rel="nofollow">http://godoc.org/github.com/ugorji/go/codec</a>]</p>
<p dir="auto">Typical usage:</p>
<div class="highlight highlight-source-go position-relative overflow-auto" data-snippet-clipboard-copy-content='    // create and use decoder/encoder
    var (
        v interface{} // value to decode/encode into
        r io.Reader
        w io.Writer
        b []byte
        mh codec.MsgpackHandle
    )
    
    dec = codec.NewDecoder(r, &amp;mh)
    dec = codec.NewDecoderBytes(b, &amp;mh)
    err = dec.Decode(&amp;v) 
    
    enc = codec.NewEncoder(w, &amp;mh)
    enc = codec.NewEncoderBytes(&amp;b, &amp;mh)
    err = enc.Encode(v)
    
    //RPC Server
    go func() {
        for {
            conn, err := listener.Accept()
            rpcCodec := codec.GoRpc.ServerCodec(conn, h)
            //OR rpcCodec := codec.MsgpackSpecRpc.ServerCodec(conn, h)
            rpc.ServeCodec(rpcCodec)
        }
    }()
    
    //RPC Communication (client side)
    conn, err = net.Dial("tcp", "localhost:5555")
    rpcCodec := codec.GoRpc.ClientCodec(conn, h)
    //OR rpcCodec := codec.MsgpackSpecRpc.ClientCodec(conn, h)
    client := rpc.NewClientWithCodec(rpcCodec)'><pre>    <span class="pl-c">// create and use decoder/encoder</span>
    <span class="pl-k">var</span> (
        <span class="pl-s1">v</span> <span class="pl-k">interface</span>{} <span class="pl-c">// value to decode/encode into</span>
        <span class="pl-s1">r</span> io.<span class="pl-smi">Reader</span>
        <span class="pl-s1">w</span> io.<span class="pl-smi">Writer</span>
        <span class="pl-s1">b</span> []<span class="pl-smi">byte</span>
        <span class="pl-s1">mh</span> codec.<span class="pl-smi">MsgpackHandle</span>
    )
    
    <span class="pl-s1">dec</span> <span class="pl-c1">=</span> <span class="pl-s1">codec</span>.<span class="pl-en">NewDecoder</span>(<span class="pl-s1">r</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">mh</span>)
    <span class="pl-s1">dec</span> <span class="pl-c1">=</span> <span class="pl-s1">codec</span>.<span class="pl-en">NewDecoderBytes</span>(<span class="pl-s1">b</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">mh</span>)
    <span class="pl-s1">err</span> <span class="pl-c1">=</span> <span class="pl-s1">dec</span>.<span class="pl-en">Decode</span>(<span class="pl-c1">&amp;</span><span class="pl-s1">v</span>) 
    
    <span class="pl-s1">enc</span> <span class="pl-c1">=</span> <span class="pl-s1">codec</span>.<span class="pl-en">NewEncoder</span>(<span class="pl-s1">w</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">mh</span>)
    <span class="pl-s1">enc</span> <span class="pl-c1">=</span> <span class="pl-s1">codec</span>.<span class="pl-en">NewEncoderBytes</span>(<span class="pl-c1">&amp;</span><span class="pl-s1">b</span>, <span class="pl-c1">&amp;</span><span class="pl-s1">mh</span>)
    <span class="pl-s1">err</span> <span class="pl-c1">=</span> <span class="pl-s1">enc</span>.<span class="pl-en">Encode</span>(<span class="pl-s1">v</span>)
    
    <span class="pl-c">//RPC Server</span>
    <span class="pl-k">go</span> <span class="pl-k">func</span>() {
        <span class="pl-k">for</span> {
            <span class="pl-s1">conn</span>, <span class="pl-s1">err</span> <span class="pl-c1">:=</span> <span class="pl-s1">listener</span>.<span class="pl-en">Accept</span>()
            <span class="pl-s1">rpcCodec</span> <span class="pl-c1">:=</span> <span class="pl-s1">codec</span>.<span class="pl-c1">GoRpc</span>.<span class="pl-en">ServerCodec</span>(<span class="pl-s1">conn</span>, <span class="pl-s1">h</span>)
            <span class="pl-c">//OR rpcCodec := codec.MsgpackSpecRpc.ServerCodec(conn, h)</span>
            <span class="pl-s1">rpc</span>.<span class="pl-en">ServeCodec</span>(<span class="pl-s1">rpcCodec</span>)
        }
    }()
    
    <span class="pl-c">//RPC Communication (client side)</span>
    <span class="pl-s1">conn</span>, <span class="pl-s1">err</span> <span class="pl-c1">=</span> <span class="pl-s1">net</span>.<span class="pl-en">Dial</span>(<span class="pl-s">"tcp"</span>, <span class="pl-s">"localhost:5555"</span>)
    <span class="pl-s1">rpcCodec</span> <span class="pl-c1">:=</span> <span class="pl-s1">codec</span>.<span class="pl-c1">GoRpc</span>.<span class="pl-en">ClientCodec</span>(<span class="pl-s1">conn</span>, <span class="pl-s1">h</span>)
    <span class="pl-c">//OR rpcCodec := codec.MsgpackSpecRpc.ClientCodec(conn, h)</span>
    <span class="pl-s1">client</span> <span class="pl-c1">:=</span> <span class="pl-s1">rpc</span>.<span class="pl-en">NewClientWithCodec</span>(<span class="pl-s1">rpcCodec</span>)</pre></div>
</article>
  </div>
        </div>
        
        <div id="qs-tinylib-msgp" class="qs"><h4><a href="https://github.com/tinylib/msgp" target="_blank">tinylib/msgp <span class="qs-url">https://github.com/tinylib/msgp</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-code-generator-" class="anchor" aria-hidden="true" href="#messagepack-code-generator-"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack Code Generator <a href="https://travis-ci.org/tinylib/msgp" rel="nofollow"><img src="https://camo.githubusercontent.com/18f29ee24c2f8d8a313693de2c27219d0427cfefe5d503daf5774f8612eabc50/68747470733a2f2f7472617669732d63692e6f72672f74696e796c69622f6d7367702e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/tinylib/msgp.svg?branch=master" style="max-width: 100%;"></a>
</h5>
<p dir="auto">This is a code generation tool and serialization library for <a href="http://msgpack.org" rel="nofollow">MessagePack</a>. You can read more about MessagePack <a href="http://github.com/tinylib/msgp/wiki">in the wiki</a>, or at <a href="http://msgpack.org" rel="nofollow">msgpack.org</a>.</p>
<h7 dir="auto">
<a id="user-content-why" class="anchor" aria-hidden="true" href="#why"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Why?</h7>
<ul dir="auto">
<li>Use Go as your schema language</li>
<li>Performance</li>
<li><a href="http://godoc.org/github.com/tinylib/msgp/msgp#CopyToJSON" rel="nofollow">JSON interop</a></li>
<li><a href="http://github.com/tinylib/msgp/wiki/Using-Extensions">User-defined extensions</a></li>
<li>Type safety</li>
<li>Encoding flexibility</li>
</ul>
<h7 dir="auto">
<a id="user-content-quickstart" class="anchor" aria-hidden="true" href="#quickstart"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quickstart</h7>
<p dir="auto">In a source file, include the following directive:</p>
<div class="highlight highlight-source-go position-relative overflow-auto" data-snippet-clipboard-copy-content="//go:generate msgp"><pre><span class="pl-c">//go:generate msgp</span></pre></div>
<p dir="auto">The <code>msgp</code> command will generate serialization methods for all exported type declarations in the file.</p>
<p dir="auto">You can <a href="http://github.com/tinylib/msgp/wiki/Using-the-Code-Generator">read more about the code generation options here</a>.</p>
<h7 dir="auto">
<a id="user-content-use" class="anchor" aria-hidden="true" href="#use"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use</h7>
<p dir="auto">Field names can be set in much the same way as the <code>encoding/json</code> package. For example:</p>
<div class="highlight highlight-source-go position-relative overflow-auto" data-snippet-clipboard-copy-content='type Person struct {
	Name       string `msg:"name"`
	Address    string `msg:"address"`
	Age        int    `msg:"age"`
	Hidden     string `msg:"-"` // this field is ignored
	unexported bool             // this field is also ignored
}'><pre><span class="pl-k">type</span> <span class="pl-smi">Person</span> <span class="pl-k">struct</span> {
	<span class="pl-c1">Name</span>       <span class="pl-smi">string</span> <span class="pl-s">`msg:"name"`</span>
	<span class="pl-c1">Address</span>    <span class="pl-smi">string</span> <span class="pl-s">`msg:"address"`</span>
	<span class="pl-c1">Age</span>        <span class="pl-smi">int</span>    <span class="pl-s">`msg:"age"`</span>
	<span class="pl-c1">Hidden</span>     <span class="pl-smi">string</span> <span class="pl-s">`msg:"-"`</span> <span class="pl-c">// this field is ignored</span>
	<span class="pl-c1">unexported</span> <span class="pl-smi">bool</span>             <span class="pl-c">// this field is also ignored</span>
}</pre></div>
<p dir="auto">By default, the code generator will satisfy <code>msgp.Sizer</code>, <code>msgp.Encodable</code>, <code>msgp.Decodable</code>,
<code>msgp.Marshaler</code>, and <code>msgp.Unmarshaler</code>. Carefully-designed applications can use these methods to do
marshalling/unmarshalling with zero heap allocations.</p>
<p dir="auto">While <code>msgp.Marshaler</code> and <code>msgp.Unmarshaler</code> are quite similar to the standard library's
<code>json.Marshaler</code> and <code>json.Unmarshaler</code>, <code>msgp.Encodable</code> and <code>msgp.Decodable</code> are useful for
stream serialization. (<code>*msgp.Writer</code> and <code>*msgp.Reader</code> are essentially protocol-aware versions
of <code>*bufio.Writer</code> and <code>*bufio.Reader</code>, respectively.)</p>
<h7 dir="auto">
<a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h7>
<ul dir="auto">
<li>Extremely fast generated code</li>
<li>Test and benchmark generation</li>
<li>JSON interoperability (see <code>msgp.CopyToJSON() and msgp.UnmarshalAsJSON()</code>)</li>
<li>Support for complex type declarations</li>
<li>Native support for Go's <code>time.Time</code>, <code>complex64</code>, and <code>complex128</code> types</li>
<li>Generation of both <code>[]byte</code>-oriented and <code>io.Reader/io.Writer</code>-oriented methods</li>
<li>Support for arbitrary type system extensions</li>
<li><a href="http://github.com/tinylib/msgp/wiki/Preprocessor-Directives">Preprocessor directives</a></li>
<li>File-based dependency model means fast codegen regardless of source tree size.</li>
</ul>
<p dir="auto">Consider the following:</p>
<div class="highlight highlight-source-go position-relative overflow-auto" data-snippet-clipboard-copy-content='const Eight = 8
type MyInt int
type Data []byte

type Struct struct {
	Which  map[string]*MyInt `msg:"which"`
	Other  Data              `msg:"other"`
	Nums   [Eight]float64    `msg:"nums"`
}'><pre><span class="pl-k">const</span> <span class="pl-s1">Eight</span> <span class="pl-c1">=</span> <span class="pl-c1">8</span>
<span class="pl-k">type</span> <span class="pl-smi">MyInt</span> <span class="pl-smi">int</span>
<span class="pl-k">type</span> <span class="pl-smi">Data</span> []<span class="pl-smi">byte</span>

<span class="pl-k">type</span> <span class="pl-smi">Struct</span> <span class="pl-k">struct</span> {
	<span class="pl-c1">Which</span>  <span class="pl-k">map</span>[<span class="pl-smi">string</span>]<span class="pl-c1">*</span><span class="pl-smi">MyInt</span> <span class="pl-s">`msg:"which"`</span>
	<span class="pl-c1">Other</span>  <span class="pl-smi">Data</span>              <span class="pl-s">`msg:"other"`</span>
	<span class="pl-c1">Nums</span>   [<span class="pl-s1">Eight</span>]<span class="pl-smi">float64</span>    <span class="pl-s">`msg:"nums"`</span>
}</pre></div>
<p dir="auto">As long as the declarations of <code>MyInt</code> and <code>Data</code> are in the same file as <code>Struct</code>, the parser will determine that the type information for <code>MyInt</code> and <code>Data</code> can be passed into the definition of <code>Struct</code> before its methods are generated.</p>
<h8 dir="auto">
<a id="user-content-extensions" class="anchor" aria-hidden="true" href="#extensions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Extensions</h8>
<p dir="auto">MessagePack supports defining your own types through "extensions," which are just a tuple of
the data "type" (<code>int8</code>) and the raw binary. You <a href="http://github.com/tinylib/msgp/wiki/Using-Extensions">can see a worked example in the wiki.</a></p>
<h7 dir="auto">
<a id="user-content-status" class="anchor" aria-hidden="true" href="#status"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Status</h7>
<p dir="auto">Mostly stable, in that no breaking changes have been made to the <code>/msgp</code> library in more than a year. Newer versions
of the code may generate different code than older versions for performance reasons. I (@philhofer) am aware of a
number of stability-critical commercial applications that use this code with good results. But, caveat emptor.</p>
<p dir="auto">You can read more about how <code>msgp</code> maps MessagePack types onto Go types <a href="http://github.com/tinylib/msgp/wiki">in the wiki</a>.</p>
<p dir="auto">Here some of the known limitations/restrictions:</p>
<ul dir="auto">
<li>Identifiers from outside the processed source file are assumed (optimistically) to satisfy the generator's interfaces. If this isn't the case, your code will fail to compile.</li>
<li>Like most serializers, <code>chan</code> and <code>func</code> fields are ignored, as well as non-exported fields.</li>
<li>Encoding of <code>interface{}</code> is limited to built-ins or types that have explicit encoding methods.</li>
<li>
<em>Maps must have <code>string</code> keys.</em> This is intentional (as it preserves JSON interop.) Although non-string map keys are not forbidden by the MessagePack standard, many serializers impose this restriction. (It also means <em>any</em> well-formed <code>struct</code> can be de-serialized into a <code>map[string]interface{}</code>.) The only exception to this rule is that the deserializers will allow you to read map keys encoded as <code>bin</code> types, due to the fact that some legacy encodings permitted this. (However, those values will still be cast to Go <code>string</code>s, and they will be converted to <code>str</code> types when re-encoded. It is the responsibility of the user to ensure that map keys are UTF-8 safe in this case.) The same rules hold true for JSON translation.</li>
</ul>
<p dir="auto">If the output compiles, then there's a pretty good chance things are fine. (Plus, we generate tests for you.) <em>Please, please, please</em> file an issue if you think the generator is writing broken code.</p>
<h7 dir="auto">
<a id="user-content-performance" class="anchor" aria-hidden="true" href="#performance"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Performance</h7>
<p dir="auto">If you like benchmarks, see <a href="http://bravenewgeek.com/so-you-wanna-go-fast/" rel="nofollow">here</a> and <a href="https://github.com/alecthomas/go_serialization_benchmarks">here</a>.</p>
<p dir="auto">As one might expect, the generated methods that deal with <code>[]byte</code> are faster for small objects, but the <code>io.Reader/Writer</code> methods are generally more memory-efficient (and, at some point, faster) for large (&gt; 2KB) objects.</p>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-haskell" class="qs"><h4><a href="http://hackage.haskell.org/package/msgpack" target="_blank">msgpack/msgpack-haskell <span class="qs-url">http://hackage.haskell.org/package/msgpack</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-haskell-" class="anchor" aria-hidden="true" href="#messagepack-for-haskell-"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for Haskell <a href="https://travis-ci.org/msgpack/msgpack-haskell" rel="nofollow"><img src="https://camo.githubusercontent.com/e598155aff8ab3bbf2e644c989108de9acfa10ee95a5544398c021135b0731de/68747470733a2f2f7472617669732d63692e6f72672f6d73677061636b2f6d73677061636b2d6861736b656c6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/msgpack/msgpack-haskell.svg?branch=master" style="max-width: 100%;"></a>
</h5>
<p dir="auto">This is an implementation of <a href="https://en.wikipedia.org/wiki/MessagePack" rel="nofollow">MessagePack</a> for <a href="https://www.haskell.org" rel="nofollow">Haskell</a>.</p>
<p dir="auto">It contains:</p>
<ul dir="auto">
<li>Serializer/Deserializer</li>
<li>RPC</li>
</ul>
<h5 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h5>
<p dir="auto">Execute following instructions:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="$ cabal update
$ cabal install msgpack
$ cabal install msgpack-rpc"><pre lang="{.bash}"><code>$ cabal update
$ cabal install msgpack
$ cabal install msgpack-rpc
</code></pre></div>
<h5 dir="auto">
<a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Documentation</h5>
<p dir="auto"><a href="https://www.haskell.org/haddock" rel="nofollow">Haddock</a> documentation can be found on Hackage:</p>
<ul dir="auto">
<li><a href="http://hackage.haskell.org/package/msgpack" rel="nofollow">http://hackage.haskell.org/package/msgpack</a></li>
<li><a href="http://hackage.haskell.org/package/msgpack-rpc" rel="nofollow">http://hackage.haskell.org/package/msgpack-rpc</a></li>
<li><a href="http://hackage.haskell.org/package/msgpack-aeson" rel="nofollow">http://hackage.haskell.org/package/msgpack-aeson</a></li>
<li><a href="http://hackage.haskell.org/package/msgpack-idl" rel="nofollow">http://hackage.haskell.org/package/msgpack-idl</a></li>
</ul>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-java" class="qs"><h4><a href="https://github.com/msgpack/msgpack-java" target="_blank">msgpack/msgpack-java <span class="qs-url">https://github.com/msgpack/msgpack-java</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-java" class="anchor" aria-hidden="true" href="#messagepack-for-java"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for Java</h5>
<p dir="auto"><a href="http://msgpack.org" rel="nofollow">MessagePack</a> is a binary serialization format. If you need a fast and compact alternative of JSON, MessagePack is your friend. For example, a small integer can be encoded in a single byte, and short strings only need a single byte prefix + the original byte array. MessagePack implementation is already available in various languages (See also the list in <a href="http://msgpack.org" rel="nofollow">http://msgpack.org</a>) and works as a universal data format.</p>
<ul dir="auto">
<li>Message Pack specification: <a href="https://github.com/msgpack/msgpack/blob/master/spec.md">https://github.com/msgpack/msgpack/blob/master/spec.md</a>
</li>
</ul>
<p dir="auto">MessagePack v7 (or later) is a faster implementation of the previous version <a href="https://github.com/msgpack/msgpack-java/tree/v06">v06</a>, and
supports all of the message pack types, including <a href="https://github.com/msgpack/msgpack/blob/master/spec.md#formats-ext">extension format</a>.</p>
<p dir="auto"><a href="https://www.javadoc.io/doc/org.msgpack/msgpack-core" rel="nofollow">JavaDoc is available at javadoc.io</a>.</p>
<h6 dir="auto">
<a id="user-content-quick-start" class="anchor" aria-hidden="true" href="#quick-start"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quick Start</h6>
<p dir="auto"><a href="https://maven-badges.herokuapp.com/maven-central/org.msgpack/msgpack-core/" rel="nofollow"><img src="https://camo.githubusercontent.com/3aeba2442e2dd78ee2c3820d6a9cf54d72ad564cf54a0ab8a2f7f251e81e5c91/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f6f72672e6d73677061636b2f6d73677061636b2d636f72652f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/org.msgpack/msgpack-core/badge.svg" style="max-width: 100%;"></a>
<a href="https://www.javadoc.io/doc/org.msgpack/msgpack-core" rel="nofollow"><img src="https://camo.githubusercontent.com/29a28f78028d8f93eb55c218aec316dcaff49f3243d8601b024454e24037f09e/68747470733a2f2f6a617661646f632e696f2f62616467652f6f72672e6d73677061636b2f6d73677061636b2d636f72652e737667" alt="Javadoc" data-canonical-src="https://javadoc.io/badge/org.msgpack/msgpack-core.svg" style="max-width: 100%;"></a></p>
<p dir="auto">For Maven users:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;dependency&gt;
   &lt;groupId&gt;org.msgpack&lt;/groupId&gt;
   &lt;artifactId&gt;msgpack-core&lt;/artifactId&gt;
   &lt;version&gt;(version)&lt;/version&gt;
&lt;/dependency&gt;"><pre><code>&lt;dependency&gt;
   &lt;groupId&gt;org.msgpack&lt;/groupId&gt;
   &lt;artifactId&gt;msgpack-core&lt;/artifactId&gt;
   &lt;version&gt;(version)&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div>
<p dir="auto">For sbt users:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='libraryDependencies += "org.msgpack" % "msgpack-core" % "(version)"'><pre><code>libraryDependencies += "org.msgpack" % "msgpack-core" % "(version)"
</code></pre></div>
<p dir="auto">For gradle users:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="repositories {
    mavenCentral()
}

dependencies {
    compile 'org.msgpack:msgpack-core:(version)'
}"><pre><code>repositories {
    mavenCentral()
}

dependencies {
    compile 'org.msgpack:msgpack-core:(version)'
}
</code></pre></div>
<ul dir="auto">
<li><a href="https://github.com/msgpack/msgpack-java/blob/develop/msgpack-core/src/test/java/org/msgpack/core/example/MessagePackExample.java">Usage examples</a></li>
</ul>
<h7 dir="auto">
<a id="user-content-integration-with-jackson-objectmapper-jackson-databind" class="anchor" aria-hidden="true" href="#integration-with-jackson-objectmapper-jackson-databind"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Integration with Jackson ObjectMapper (jackson-databind)</h7>
<p dir="auto">msgpack-java supports serialization and deserialization of Java objects through <a href="https://github.com/FasterXML/jackson-databind">jackson-databind</a>.
For details, see <a href="https://github.com/msgpack/msgpack-java/blob/develop/msgpack-jackson/README.md">msgpack-jackson/README.md</a>. The template-based serialization mechanism used in v06 is deprecated.</p>
<ul dir="auto">
<li><a href="https://github.com/msgpack/msgpack-java/blob/develop/RELEASE_NOTES.md">Release Notes</a></li>
</ul>
<h6 dir="auto">
<a id="user-content-for-messagepack-developers-" class="anchor" aria-hidden="true" href="#for-messagepack-developers-"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>For MessagePack Developers <a href="https://travis-ci.org/msgpack/msgpack-java" rel="nofollow"><img src="https://camo.githubusercontent.com/6ca3edc340f2e9cd3a06b681db5a12965d43a458dc21b438c7cfc611ccc37010/68747470733a2f2f7472617669732d63692e6f72672f6d73677061636b2f6d73677061636b2d6a6176612e7376673f6272616e63683d7630372d646576656c6f70" alt="Travis CI" data-canonical-src="https://travis-ci.org/msgpack/msgpack-java.svg?branch=v07-develop" style="max-width: 100%;"></a>
</h6>
<p dir="auto">msgpack-java uses <a href="http://www.scala-sbt.org/" rel="nofollow">sbt</a> for building the projects. For the basic usage of sbt, see:</p>
<ul dir="auto">
<li><a href="http://xerial.org/blog/2014/03/24/sbt/" rel="nofollow">Building Java projects with sbt</a></li>
</ul>
<p dir="auto">Coding style</p>
<ul dir="auto">
<li>msgpack-java uses <a href="https://github.com/airlift/codestyle">the same coding style</a> with Facebook Presto</li>
<li><a href="https://raw.githubusercontent.com/airlift/codestyle/master/IntelliJIdea14/Airlift.xml" rel="nofollow">IntelliJ setting file</a></li>
</ul>
<h7 dir="auto">
<a id="user-content-basic-sbt-commands" class="anchor" aria-hidden="true" href="#basic-sbt-commands"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Basic sbt commands</h7>
<p dir="auto">Enter the sbt console:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="$ ./sbt"><pre><code>$ ./sbt
</code></pre></div>
<p dir="auto">Here is a list of sbt commands for daily development:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="&gt; ~compile                                 # Compile source codes
&gt; ~test:compile                            # Compile both source and test codes
&gt; ~test                                    # Run tests upon source code change
&gt; ~testOnly *MessagePackTest               # Run tests in the specified class
&gt; ~testOnly *MessagePackTest -- (pattern)  # Run tests matching the pattern 
&gt; project msgpack-core                     # Focus on a specific project
&gt; package                                  # Create a jar file in the target folder of each project
&gt; findbugs                                 # Produce findbugs report in target/findbugs
&gt; jacoco:cover                             # Report the code coverage of tests to target/jacoco folder
&gt; jcheckStyle                              # Run check style
&gt; ;scalafmt;test:scalafmt;scalafmtSbt      # Reformat Scala codes"><pre><code>&gt; ~compile                                 # Compile source codes
&gt; ~test:compile                            # Compile both source and test codes
&gt; ~test                                    # Run tests upon source code change
&gt; ~testOnly *MessagePackTest               # Run tests in the specified class
&gt; ~testOnly *MessagePackTest -- (pattern)  # Run tests matching the pattern 
&gt; project msgpack-core                     # Focus on a specific project
&gt; package                                  # Create a jar file in the target folder of each project
&gt; findbugs                                 # Produce findbugs report in target/findbugs
&gt; jacoco:cover                             # Report the code coverage of tests to target/jacoco folder
&gt; jcheckStyle                              # Run check style
&gt; ;scalafmt;test:scalafmt;scalafmtSbt      # Reformat Scala codes
</code></pre></div>
<h7 dir="auto">
<a id="user-content-publishing" class="anchor" aria-hidden="true" href="#publishing"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Publishing</h7>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="&gt; publishLocal            # Install to local .ivy2 repository
&gt; publishM2               # Install to local .m2 Maven repository
&gt; publish                 # Publishing a snapshot version to the Sonatype repository"><pre><code>&gt; publishLocal            # Install to local .ivy2 repository
&gt; publishM2               # Install to local .m2 Maven repository
&gt; publish                 # Publishing a snapshot version to the Sonatype repository
</code></pre></div>
<h7 dir="auto">
<a id="user-content-publish-to-sonatype-maven-central" class="anchor" aria-hidden="true" href="#publish-to-sonatype-maven-central"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Publish to Sonatype (Maven Central)</h7>
<p dir="auto">To publish a new version, you only need to add a new git tag and push it to GitHub. GitHub Action will deploy a new release version to Maven Central (Sonatype).</p>
<div class="highlight highlight-source-scala position-relative overflow-auto" data-snippet-clipboard-copy-content="$ git tag v0.x.y
$ git push origin v0.x.y"><pre>$ git tag v0.x.y
$ git push origin v0.x.y</pre></div>
<p dir="auto">To generate a release notes, you can use this command line:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="$ git log v(last version).. --oneline | cut -f 2- -d ' ' | perl -npe 's/(.*)\(\#([0-9]+)\)/* \1\[\#\2\]\(http:\/\/github.com\/msgpack\/msgpack-java\/pull\/\2\)/g'"><pre><code>$ git log v(last version).. --oneline | cut -f 2- -d ' ' | perl -npe 's/(.*)\(\#([0-9]+)\)/* \1\[\#\2\]\(http:\/\/github.com\/msgpack\/msgpack-java\/pull\/\2\)/g'
</code></pre></div>
<h8 dir="auto">
<a id="user-content-publishing-to-sonatype-from-local-machine" class="anchor" aria-hidden="true" href="#publishing-to-sonatype-from-local-machine"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Publishing to Sonatype from Local Machine</h8>
<p dir="auto">If you need to publish to Maven central using a local machine, you need to configure <a href="https://github.com/xerial/sbt-sonatype">sbt-sonatype</a> plugin. First set Sonatype account information (user name and password) in the global sbt settings. To protect your password, never include this file in your project.</p>
<p dir="auto"><em><strong>$HOME/.sbt/(sbt-version)/sonatype.sbt</strong></em></p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='credentials += Credentials("Sonatype Nexus Repository Manager",
        "oss.sonatype.org",
        "(Sonatype user name)",
        "(Sonatype password)")'><pre><code>credentials += Credentials("Sonatype Nexus Repository Manager",
        "oss.sonatype.org",
        "(Sonatype user name)",
        "(Sonatype password)")
</code></pre></div>
<p dir="auto">You may also need to configure GPG. See the instruction in <a href="https://github.com/sbt/sbt-pgp">sbt-pgp</a>.</p>
<p dir="auto">Then, run <code>publishedSigned</code> followed by <code>sonatypeBundleRelease</code>:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="# [optional] When you need to perform the individual release steps manually, use the following commands:
&gt; publishSigned           # Publish GPG signed artifacts to the Sonatype repository
&gt; sonatypeBundleRelease   # Publish to the Maven Central (It will be synched within less than 4 hours)"><pre><code># [optional] When you need to perform the individual release steps manually, use the following commands:
&gt; publishSigned           # Publish GPG signed artifacts to the Sonatype repository
&gt; sonatypeBundleRelease   # Publish to the Maven Central (It will be synched within less than 4 hours)
</code></pre></div>
<p dir="auto">If some sporadic error happens (e.g., Sonatype timeout), rerun <code>sonatypeBundleRelease</code> again.</p>
<h7 dir="auto">
<a id="user-content-project-structure" class="anchor" aria-hidden="true" href="#project-structure"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Project Structure</h7>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="msgpack-core                 # Contains packer/unpacker implementation that never uses third-party libraries
msgpack-jackson              # Contains jackson-dataformat-java implementation"><pre><code>msgpack-core                 # Contains packer/unpacker implementation that never uses third-party libraries
msgpack-jackson              # Contains jackson-dataformat-java implementation
</code></pre></div>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-javascript" class="qs"><h4><a href="https://msgpack.org/" target="_blank">msgpack/msgpack-javascript <span class="qs-url">https://msgpack.org/</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-javascriptecma-262--" class="anchor" aria-hidden="true" href="#messagepack-for-javascriptecma-262--"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for JavaScript/ECMA-262  </h5>
<p dir="auto"><a href="https://www.npmjs.com/package/@msgpack/msgpack" rel="nofollow"><img src="https://camo.githubusercontent.com/66cb71ffd0fac1adb6bbaf2ece2a895086a6678b30549c1ce9b5f682813b57d7/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f406d73677061636b2f6d73677061636b2e737667" alt="npm version" data-canonical-src="https://img.shields.io/npm/v/@msgpack/msgpack.svg" style="max-width: 100%;"></a> <a target="_blank" rel="noopener noreferrer" href="https://github.com/msgpack/msgpack-javascript/workflows/CI/badge.svg"><img src="https://github.com/msgpack/msgpack-javascript/workflows/CI/badge.svg" alt="CI" style="max-width: 100%;"></a> <a href="https://codecov.io/gh/msgpack/msgpack-javascript" rel="nofollow"><img src="https://camo.githubusercontent.com/89598e8133168947124cc95fd32c042f9e579487b56d4056192205d25e4c3cd3/68747470733a2f2f636f6465636f762e696f2f67682f6d73677061636b2f6d73677061636b2d6a6176617363726970742f6272616e63682f6d61737465722f6772617068732f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/msgpack/msgpack-javascript/branch/master/graphs/badge.svg" style="max-width: 100%;"></a> <a href="https://bundlephobia.com/result?p=@msgpack/msgpack" rel="nofollow"><img src="https://camo.githubusercontent.com/303cc840988faab6ddb63ab8e4af105ae6458f59df675c6c4114bc2c9a81583c/68747470733a2f2f62616467656e2e6e65742f62756e646c6570686f6269612f6d696e7a69702f406d73677061636b2f6d73677061636b" alt="minzip" data-canonical-src="https://badgen.net/bundlephobia/minzip/@msgpack/msgpack" style="max-width: 100%;"></a> <a href="https://bundlephobia.com/result?p=@msgpack/msgpack" rel="nofollow"><img src="https://camo.githubusercontent.com/9e761c8202917adef2f2b6203625ebcf6d141e6f348ccbfc88c66835ce9100b3/68747470733a2f2f62616467656e2e6e65742f62756e646c6570686f6269612f747265652d7368616b696e672f406d73677061636b2f6d73677061636b" alt="tree-shaking" data-canonical-src="https://badgen.net/bundlephobia/tree-shaking/@msgpack/msgpack" style="max-width: 100%;"></a></p>
<p dir="auto">This is a JavaScript/ECMA-262 implementation of <strong>MessagePack</strong>, an efficient binary serilization format:</p>
<p dir="auto"><a href="https://msgpack.org/" rel="nofollow">https://msgpack.org/</a></p>
<p dir="auto">This library is a universal JavaScript, meaning it is compatible with all the major browsers and NodeJS. In addition, because it is implemented in <a href="https://www.typescriptlang.org/" rel="nofollow">TypeScript</a>, type definition files (<code>d.ts</code>) are bundled in the distribution.</p>
<p dir="auto"><em>Note that this is the second version of MessagePack for JavaScript. The first version, which was implemented in ES5 and was never released to npmjs.com, is tagged as <a href="https://github.com/msgpack/msgpack-javascript/tree/classic">classic</a>.</em></p>
<h6 dir="auto">
<a id="user-content-synopsis" class="anchor" aria-hidden="true" href="#synopsis"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Synopsis</h6>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { deepStrictEqual } from "assert";
import { encode, decode } from "@msgpack/msgpack";

const object = {
  nil: null,
  integer: 1,
  float: Math.PI,
  string: "Hello, world!",
  binary: Uint8Array.from([1, 2, 3]),
  array: [10, 20, 30],
  map: { foo: "bar" },
  timestampExt: new Date(),
};

const encoded: Uint8Array = encode(object);

deepStrictEqual(decode(encoded), object);'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">deepStrictEqual</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"assert"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">encode</span><span class="pl-kos">,</span> <span class="pl-s1">decode</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">object</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
  <span class="pl-c1">nil</span>: <span class="pl-c1">null</span><span class="pl-kos">,</span>
  <span class="pl-c1">integer</span>: <span class="pl-c1">1</span><span class="pl-kos">,</span>
  <span class="pl-c1">float</span>: <span class="pl-smi">Math</span><span class="pl-kos">.</span><span class="pl-c1">PI</span><span class="pl-kos">,</span>
  <span class="pl-c1">string</span>: <span class="pl-s">"Hello, world!"</span><span class="pl-kos">,</span>
  <span class="pl-c1">binary</span>: <span class="pl-smi">Uint8Array</span><span class="pl-kos">.</span><span class="pl-en">from</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">1</span><span class="pl-kos">,</span> <span class="pl-c1">2</span><span class="pl-kos">,</span> <span class="pl-c1">3</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">,</span>
  <span class="pl-c1">array</span>: <span class="pl-kos">[</span><span class="pl-c1">10</span><span class="pl-kos">,</span> <span class="pl-c1">20</span><span class="pl-kos">,</span> <span class="pl-c1">30</span><span class="pl-kos">]</span><span class="pl-kos">,</span>
  <span class="pl-c1">map</span>: <span class="pl-kos">{</span> <span class="pl-c1">foo</span>: <span class="pl-s">"bar"</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-c1">timestampExt</span>: <span class="pl-k">new</span> <span class="pl-smi">Date</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span>: <span class="pl-smi">Uint8Array</span> <span class="pl-c1">=</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">object</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-en">deepStrictEqual</span><span class="pl-kos">(</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-s1">object</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h6 dir="auto">
<a id="user-content-table-of-contents" class="anchor" aria-hidden="true" href="#table-of-contents"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Table of Contents</h6>
<ul dir="auto">
<li><a href="#synopsis">Synopsis</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#install">Install</a></li>
<li>
<a href="#api">API</a>
<ul dir="auto">
<li>
<a href="#encodedata-unknown-options-encodeoptions-uint8array"><code>encode(data: unknown, options?: EncodeOptions): Uint8Array</code></a>
<ul dir="auto">
<li><a href="#encodeoptions"><code>EncodeOptions</code></a></li>
</ul>
</li>
<li>
<a href="#decodebuffer-arraylikenumber--buffersource-options-decodeoptions-unknown"><code>decode(buffer: ArrayLike&lt;number&gt; | BufferSource, options?: DecodeOptions): unknown</code></a>
<ul dir="auto">
<li><a href="#decodeoptions"><code>DecodeOptions</code></a></li>
</ul>
</li>
<li><a href="#decodemultibuffer-arraylikenumber--buffersource-options-decodeoptions-generatorunknown-void-unknown"><code>decodeMulti(buffer: ArrayLike&lt;number&gt; | BufferSource, options?: DecodeOptions): Generator&lt;unknown, void, unknown&gt;</code></a></li>
<li><a href="#decodeasyncstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-promiseunknown"><code>decodeAsync(stream: ReadableStreamLike&lt;ArrayLike&lt;number&gt; | BufferSource&gt;, options?: DecodeAsyncOptions): Promise&lt;unknown&gt;</code></a></li>
<li><a href="#decodearraystreamstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-asynciterableunknown"><code>decodeArrayStream(stream: ReadableStreamLike&lt;ArrayLike&lt;number&gt; | BufferSource&gt;, options?: DecodeAsyncOptions): AsyncIterable&lt;unknown&gt;</code></a></li>
<li><a href="#decodemultistreamstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-asynciterableunknown"><code>decodeMultiStream(stream: ReadableStreamLike&lt;ArrayLike&lt;number&gt; | BufferSource&gt;, options?: DecodeAsyncOptions): AsyncIterable&lt;unknown&gt;</code></a></li>
<li><a href="#reusing-encoder-and-decoder-instances">Reusing Encoder and Decoder instances</a></li>
</ul>
</li>
<li>
<a href="#extension-types">Extension Types</a>
<ul dir="auto">
<li><a href="#extensioncodec-context">ExtensionCodec context</a></li>
<li><a href="#handling-bigint-with-extensioncodec">Handling BigInt with ExtensionCodec</a></li>
<li><a href="#the-temporal-module-as-timestamp-extensions">The temporal module as timestamp extensions</a></li>
</ul>
</li>
<li><a href="#decoding-a-blob">Decoding a Blob</a></li>
<li>
<a href="#messagepack-specification">MessagePack Specification</a>
<ul dir="auto">
<li><a href="#messagepack-mapping-table">MessagePack Mapping Table</a></li>
</ul>
</li>
<li>
<a href="#prerequisites">Prerequisites</a>
<ul dir="auto">
<li><a href="#ecma-262">ECMA-262</a></li>
<li><a href="#nodejs">NodeJS</a></li>
<li><a href="#typescript-compiler--type-definitions">TypeScript Compiler / Type Definitions</a></li>
</ul>
</li>
<li><a href="#benchmark">Benchmark</a></li>
<li>
<a href="#distribution">Distribution</a>
<ul dir="auto">
<li><a href="#npm--npmjscom">NPM / npmjs.com</a></li>
<li><a href="#cdn--unpkgcom">CDN / unpkg.com</a></li>
</ul>
</li>
<li><a href="#deno-support">Deno Support</a></li>
<li>
<a href="#maintenance">Maintenance</a>
<ul dir="auto">
<li><a href="#testing">Testing</a></li>
<li><a href="#continuous-integration">Continuous Integration</a></li>
<li><a href="#release-engineering">Release Engineering</a></li>
<li><a href="#updating-dependencies">Updating Dependencies</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
</ul>
<h6 dir="auto">
<a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install</h6>
<p dir="auto">This library is published to <code>npmjs.com</code> as <a href="https://www.npmjs.com/package/@msgpack/msgpack" rel="nofollow">@msgpack/msgpack</a>.</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="npm install @msgpack/msgpack"><pre>npm install @msgpack/msgpack</pre></div>
<h6 dir="auto">
<a id="user-content-api" class="anchor" aria-hidden="true" href="#api"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>API</h6>
<h7 dir="auto">
<a id="user-content-encodedata-unknown-options-encodeoptions-uint8array" class="anchor" aria-hidden="true" href="#encodedata-unknown-options-encodeoptions-uint8array"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>encode(data: unknown, options?: EncodeOptions): Uint8Array</code>
</h7>
<p dir="auto">It encodes <code>data</code> into a single MessagePack-encoded object, and returns a byte array as <code>Uint8Array</code>, throwing errors if <code>data</code> is, or includes, a non-serializable object such as a <code>function</code> or a <code>symbol</code>.</p>
<p dir="auto">for example:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { encode } from "@msgpack/msgpack";

const encoded: Uint8Array = encode({ foo: "bar" });
console.log(encoded);'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">encode</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span>: <span class="pl-smi">Uint8Array</span> <span class="pl-c1">=</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">foo</span>: <span class="pl-s">"bar"</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto">If you'd like to convert an <code>uint8array</code> to a NodeJS <code>Buffer</code>, use <code>Buffer.from(arrayBuffer, offset, length)</code> in order not to copy the underlying <code>ArrayBuffer</code>, while <code>Buffer.from(uint8array)</code> copies it:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { encode } from "@msgpack/msgpack";

const encoded: Uint8Array = encode({ foo: "bar" });

// `buffer` refers the same ArrayBuffer as `encoded`.
const buffer: Buffer = Buffer.from(encoded.buffer, encoded.byteOffset, encoded.byteLength);
console.log(buffer);'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">encode</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span>: <span class="pl-smi">Uint8Array</span> <span class="pl-c1">=</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">foo</span>: <span class="pl-s">"bar"</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// `buffer` refers the same ArrayBuffer as `encoded`.</span>
<span class="pl-k">const</span> <span class="pl-s1">buffer</span>: <span class="pl-smi">Buffer</span> <span class="pl-c1">=</span> <span class="pl-smi">Buffer</span><span class="pl-kos">.</span><span class="pl-en">from</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">.</span><span class="pl-c1">buffer</span><span class="pl-kos">,</span> <span class="pl-s1">encoded</span><span class="pl-kos">.</span><span class="pl-c1">byteOffset</span><span class="pl-kos">,</span> <span class="pl-s1">encoded</span><span class="pl-kos">.</span><span class="pl-c1">byteLength</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">buffer</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h8 dir="auto">
<a id="user-content-encodeoptions" class="anchor" aria-hidden="true" href="#encodeoptions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>EncodeOptions</code>
</h8>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>extensionCodec</td>
<td>ExtensionCodec</td>
<td><code>ExtensionCodec.defaultCodec</code></td>
</tr>
<tr>
<td>maxDepth</td>
<td>number</td>
<td><code>100</code></td>
</tr>
<tr>
<td>initialBufferSize</td>
<td>number</td>
<td><code>2048</code></td>
</tr>
<tr>
<td>sortKeys</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>forceFloat32</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>forceIntegerToFloat</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>ignoreUndefined</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>context</td>
<td>user-defined</td>
<td>-</td>
</tr>
</tbody>
</table>
<h7 dir="auto">
<a id="user-content-decodebuffer-arraylikenumber--buffersource-options-decodeoptions-unknown" class="anchor" aria-hidden="true" href="#decodebuffer-arraylikenumber--buffersource-options-decodeoptions-unknown"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>decode(buffer: ArrayLike&lt;number&gt; | BufferSource, options?: DecodeOptions): unknown</code>
</h7>
<p dir="auto">It decodes <code>buffer</code> that includes a MessagePack-encoded object, and returns the decoded object typed <code>unknown</code>.</p>
<p dir="auto"><code>buffer</code> must be an array of bytes, which is typically <code>Uint8Array</code> or <code>ArrayBuffer</code>. <code>BufferSource</code> is defined as <code>ArrayBuffer | ArrayBufferView</code>.</p>
<p dir="auto">In addition, <code>buffer</code> can include a single encoded object. If the <code>buffer</code> includes extra bytes after an object, it will throw <code>RangeError</code>. To decode <code>buffer</code> that includes multiple encoded objects, use <code>decodeMulti()</code> or <code>decodeMultiStream()</code> (recommended) instead.</p>
<p dir="auto">for example:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { decode } from "@msgpack/msgpack";

const encoded: Uint8Array;
const object = decode(encoded);
console.log(object);'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">decode</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span>: <span class="pl-smi">Uint8Array</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">object</span> <span class="pl-c1">=</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">object</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto">NodeJS <code>Buffer</code> is also acceptable because it is a subclass of <code>Uint8Array</code>.</p>
<h8 dir="auto">
<a id="user-content-decodeoptions" class="anchor" aria-hidden="true" href="#decodeoptions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>DecodeOptions</code>
</h8>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>extensionCodec</td>
<td>ExtensionCodec</td>
<td><code>ExtensionCodec.defaultCodec</code></td>
</tr>
<tr>
<td>maxStrLength</td>
<td>number</td>
<td>
<code>4_294_967_295</code> (UINT32_MAX)</td>
</tr>
<tr>
<td>maxBinLength</td>
<td>number</td>
<td>
<code>4_294_967_295</code> (UINT32_MAX)</td>
</tr>
<tr>
<td>maxArrayLength</td>
<td>number</td>
<td>
<code>4_294_967_295</code> (UINT32_MAX)</td>
</tr>
<tr>
<td>maxMapLength</td>
<td>number</td>
<td>
<code>4_294_967_295</code> (UINT32_MAX)</td>
</tr>
<tr>
<td>maxExtLength</td>
<td>number</td>
<td>
<code>4_294_967_295</code> (UINT32_MAX)</td>
</tr>
<tr>
<td>context</td>
<td>user-defined</td>
<td>-</td>
</tr>
</tbody>
</table>
<p dir="auto">You can use <code>max${Type}Length</code> to limit the length of each type decoded.</p>
<h7 dir="auto">
<a id="user-content-decodemultibuffer-arraylikenumber--buffersource-options-decodeoptions-generatorunknown-void-unknown" class="anchor" aria-hidden="true" href="#decodemultibuffer-arraylikenumber--buffersource-options-decodeoptions-generatorunknown-void-unknown"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>decodeMulti(buffer: ArrayLike&lt;number&gt; | BufferSource, options?: DecodeOptions): Generator&lt;unknown, void, unknown&gt;</code>
</h7>
<p dir="auto">It decodes <code>buffer</code> that includes multiple MessagePack-encoded objects, and returns decoded objects as a generator. That is, this is a synchronous variant for <code>decodeMultiStream()</code>.</p>
<p dir="auto">This function is not recommended to decode a MessagePack binary via I/O stream including sockets because it's synchronous. Instead, <code>decodeMultiStream()</code> decodes it asynchronously, typically spending less time and memory.</p>
<p dir="auto">for example:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { decode } from "@msgpack/msgpack";

const encoded: Uint8Array;

for (const object of decodeMulti(encoded)) {
  console.log(object);
}'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">decode</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span>: <span class="pl-smi">Uint8Array</span><span class="pl-kos">;</span>

<span class="pl-k">for</span> <span class="pl-kos">(</span><span class="pl-k">const</span> <span class="pl-s1">object</span> <span class="pl-k">of</span> <span class="pl-en">decodeMulti</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">object</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span></pre></div>
<h7 dir="auto">
<a id="user-content-decodeasyncstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-promiseunknown" class="anchor" aria-hidden="true" href="#decodeasyncstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-promiseunknown"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>decodeAsync(stream: ReadableStreamLike&lt;ArrayLike&lt;number&gt; | BufferSource&gt;, options?: DecodeAsyncOptions): Promise&lt;unknown&gt;</code>
</h7>
<p dir="auto">It decodes <code>stream</code>, where <code>ReadableStreamLike&lt;T&gt;</code> is defined as <code>ReadableStream&lt;T&gt; | AsyncIterable&lt;T&gt;</code>, in an async iterable of byte arrays, and returns decoded object as <code>unknown</code> type, wrapped in <code>Promise</code>. This function works asynchronously. This is an async variant for <code>decode()</code>.</p>
<p dir="auto"><code>DecodeAsyncOptions</code> is the same as <code>DecodeOptions</code> for <code>decode()</code>.</p>
<p dir="auto">This function is designed to work with whatwg <code>fetch()</code> like this:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { decodeAsync } from "@msgpack/msgpack";

const MSGPACK_TYPE = "application/x-msgpack";

const response = await fetch(url);
const contentType = response.headers.get("Content-Type");
if (contentType &amp;&amp; contentType.startsWith(MSGPACK_TYPE) &amp;&amp; response.body != null) {
  const object = await decodeAsync(response.body);
  // do something with object
} else { /* handle errors */ }'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">decodeAsync</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-smi">MSGPACK_TYPE</span> <span class="pl-c1">=</span> <span class="pl-s">"application/x-msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-en">fetch</span><span class="pl-kos">(</span><span class="pl-s1">url</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">contentType</span> <span class="pl-c1">=</span> <span class="pl-s1">response</span><span class="pl-kos">.</span><span class="pl-c1">headers</span><span class="pl-kos">.</span><span class="pl-en">get</span><span class="pl-kos">(</span><span class="pl-s">"Content-Type"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">contentType</span> <span class="pl-c1">&amp;&amp;</span> <span class="pl-s1">contentType</span><span class="pl-kos">.</span><span class="pl-en">startsWith</span><span class="pl-kos">(</span><span class="pl-smi">MSGPACK_TYPE</span><span class="pl-kos">)</span> <span class="pl-c1">&amp;&amp;</span> <span class="pl-s1">response</span><span class="pl-kos">.</span><span class="pl-c1">body</span> <span class="pl-c1">!=</span> <span class="pl-c1">null</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-k">const</span> <span class="pl-s1">object</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-en">decodeAsync</span><span class="pl-kos">(</span><span class="pl-s1">response</span><span class="pl-kos">.</span><span class="pl-c1">body</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-c">// do something with object</span>
<span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span> <span class="pl-c">/* handle errors */</span> <span class="pl-kos">}</span></pre></div>
<h7 dir="auto">
<a id="user-content-decodearraystreamstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-asynciterableunknown" class="anchor" aria-hidden="true" href="#decodearraystreamstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-asynciterableunknown"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>decodeArrayStream(stream: ReadableStreamLike&lt;ArrayLike&lt;number&gt; | BufferSource&gt;, options?: DecodeAsyncOptions): AsyncIterable&lt;unknown&gt;</code>
</h7>
<p dir="auto">It is alike to <code>decodeAsync()</code>, but only accepts a <code>stream</code> that includes an array of items, and emits a decoded item one by one.</p>
<p dir="auto">for example:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { decodeArrayStream } from "@msgpack/msgpack";

const stream: AsyncIterator&lt;Uint8Array&gt;;

// in an async function:
for await (const item of decodeArrayStream(stream)) {
  console.log(item);
}'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">decodeArrayStream</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">stream</span>: <span class="pl-smi">AsyncIterator</span><span class="pl-kos">&lt;</span><span class="pl-smi">Uint8Array</span><span class="pl-kos">&gt;</span><span class="pl-kos">;</span>

<span class="pl-c">// in an async function:</span>
<span class="pl-k">for</span> <span class="pl-k">await</span> <span class="pl-kos">(</span><span class="pl-k">const</span> <span class="pl-s1">item</span> <span class="pl-k">of</span> <span class="pl-en">decodeArrayStream</span><span class="pl-kos">(</span><span class="pl-s1">stream</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">item</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span></pre></div>
<h7 dir="auto">
<a id="user-content-decodemultistreamstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-asynciterableunknown" class="anchor" aria-hidden="true" href="#decodemultistreamstream-readablestreamlikearraylikenumber--buffersource-options-decodeasyncoptions-asynciterableunknown"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>decodeMultiStream(stream: ReadableStreamLike&lt;ArrayLike&lt;number&gt; | BufferSource&gt;, options?: DecodeAsyncOptions): AsyncIterable&lt;unknown&gt;</code>
</h7>
<p dir="auto">It is alike to <code>decodeAsync()</code> and <code>decodeArrayStream()</code>, but the input <code>stream</code> must consist of multiple MessagePack-encoded items. This is an asynchronous variant for <code>decodeMulti()</code>.</p>
<p dir="auto">In other words, it could decode an unlimited stream and emits a decoded item one by one.</p>
<p dir="auto">for example:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { decodeMultiStream } from "@msgpack/msgpack";

const stream: AsyncIterator&lt;Uint8Array&gt;;

// in an async function:
for await (const item of decodeMultiStream(stream)) {
  console.log(item);
}'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">decodeMultiStream</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">stream</span>: <span class="pl-smi">AsyncIterator</span><span class="pl-kos">&lt;</span><span class="pl-smi">Uint8Array</span><span class="pl-kos">&gt;</span><span class="pl-kos">;</span>

<span class="pl-c">// in an async function:</span>
<span class="pl-k">for</span> <span class="pl-k">await</span> <span class="pl-kos">(</span><span class="pl-k">const</span> <span class="pl-s1">item</span> <span class="pl-k">of</span> <span class="pl-en">decodeMultiStream</span><span class="pl-kos">(</span><span class="pl-s1">stream</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">item</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span></pre></div>
<p dir="auto">This function is available since v2.4.0; previously it was called as <code>decodeStream()</code>.</p>
<h7 dir="auto">
<a id="user-content-reusing-encoder-and-decoder-instances" class="anchor" aria-hidden="true" href="#reusing-encoder-and-decoder-instances"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Reusing Encoder and Decoder instances</h7>
<p dir="auto"><code>Encoder</code> and <code>Decoder</code> classes is provided for better performance:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { deepStrictEqual } from "assert";
import { Encoder, Decoder } from "@msgpack/msgpack";

const encoder = new Encoder();
const decoder = new Decoder();

const encoded: Uint8Array = encoder.encode(object);
deepStrictEqual(decoder.decode(encoded), object);'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">deepStrictEqual</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"assert"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">Encoder</span><span class="pl-kos">,</span> <span class="pl-smi">Decoder</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoder</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">Encoder</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">decoder</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">Decoder</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span>: <span class="pl-smi">Uint8Array</span> <span class="pl-c1">=</span> <span class="pl-s1">encoder</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">object</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">deepStrictEqual</span><span class="pl-kos">(</span><span class="pl-s1">decoder</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-s1">object</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto">According to our benchmark, reusing <code>Encoder</code> instance is about 20% faster
than <code>encode()</code> function, and reusing <code>Decoder</code> instance is about 2% faster
than <code>decode()</code> function. Note that the result should vary in environments
and data structure.</p>
<h6 dir="auto">
<a id="user-content-extension-types" class="anchor" aria-hidden="true" href="#extension-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Extension Types</h6>
<p dir="auto">To handle <a href="https://github.com/msgpack/msgpack/blob/master/spec.md#extension-types">MessagePack Extension Types</a>, this library provides <code>ExtensionCodec</code> class.</p>
<p dir="auto">Here is an example to setup custom extension types that handles <code>Map</code> and <code>Set</code> classes in TypeScript:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { encode, decode, ExtensionCodec } from "@msgpack/msgpack";

const extensionCodec = new ExtensionCodec();

// Set&lt;T&gt;
const SET_EXT_TYPE = 0 // Any in 0-127
extensionCodec.register({
  type: SET_EXT_TYPE,
  encode: (object: unknown): Uint8Array | null =&gt; {
    if (object instanceof Set) {
      return encode([...object]);
    } else {
      return null;
    }
  },
  decode: (data: Uint8Array) =&gt; {
    const array = decode(data) as Array&lt;unknown&gt;;
    return new Set(array);
  },
});

// Map&lt;T&gt;
const MAP_EXT_TYPE = 1; // Any in 0-127
extensionCodec.register({
  type: MAP_EXT_TYPE,
  encode: (object: unknown): Uint8Array =&gt; {
    if (object instanceof Map) {
      return encode([...object]);
    } else {
      return null;
    }
  },
  decode: (data: Uint8Array) =&gt; {
    const array = decode(data) as Array&lt;[unknown, unknown]&gt;;
    return new Map(array);
  },
});

const encoded = encode([new Set&lt;any&gt;(), new Map&lt;any, any&gt;()], { extensionCodec });
const decoded = decode(encoded, { extensionCodec });'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">encode</span><span class="pl-kos">,</span> <span class="pl-s1">decode</span><span class="pl-kos">,</span> <span class="pl-smi">ExtensionCodec</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">extensionCodec</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">ExtensionCodec</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// Set&lt;T&gt;</span>
<span class="pl-k">const</span> <span class="pl-smi">SET_EXT_TYPE</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span> <span class="pl-c">// Any in 0-127</span>
<span class="pl-s1">extensionCodec</span><span class="pl-kos">.</span><span class="pl-en">register</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
  <span class="pl-c1">type</span>: <span class="pl-smi">SET_EXT_TYPE</span><span class="pl-kos">,</span>
  <span class="pl-en">encode</span>: <span class="pl-kos">(</span><span class="pl-s1">object</span>: <span class="pl-smi">unknown</span><span class="pl-kos">)</span>: <span class="pl-smi">Uint8Array</span> <span class="pl-c1">|</span> <span class="pl-smi">null</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">object</span> <span class="pl-k">instanceof</span> <span class="pl-smi">Set</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">[</span>...<span class="pl-s1">object</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span> <span class="pl-c1">null</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-en">decode</span>: <span class="pl-kos">(</span><span class="pl-s1">data</span>: <span class="pl-smi">Uint8Array</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">const</span> <span class="pl-s1">array</span> <span class="pl-c1">=</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">)</span> <span class="pl-k">as</span> <span class="pl-smi">Array</span><span class="pl-kos">&lt;</span><span class="pl-smi">unknown</span><span class="pl-kos">&gt;</span><span class="pl-kos">;</span>
    <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-smi">Set</span><span class="pl-kos">(</span><span class="pl-s1">array</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// Map&lt;T&gt;</span>
<span class="pl-k">const</span> <span class="pl-smi">MAP_EXT_TYPE</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span><span class="pl-kos">;</span> <span class="pl-c">// Any in 0-127</span>
<span class="pl-s1">extensionCodec</span><span class="pl-kos">.</span><span class="pl-en">register</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
  <span class="pl-c1">type</span>: <span class="pl-smi">MAP_EXT_TYPE</span><span class="pl-kos">,</span>
  <span class="pl-en">encode</span>: <span class="pl-kos">(</span><span class="pl-s1">object</span>: <span class="pl-smi">unknown</span><span class="pl-kos">)</span>: <span class="pl-smi">Uint8Array</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">object</span> <span class="pl-k">instanceof</span> <span class="pl-smi">Map</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">[</span>...<span class="pl-s1">object</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span> <span class="pl-c1">null</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-en">decode</span>: <span class="pl-kos">(</span><span class="pl-s1">data</span>: <span class="pl-smi">Uint8Array</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">const</span> <span class="pl-s1">array</span> <span class="pl-c1">=</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">)</span> <span class="pl-k">as</span> <span class="pl-smi">Array</span><span class="pl-kos">&lt;</span><span class="pl-kos">[</span><span class="pl-smi">unknown</span><span class="pl-kos">,</span> <span class="pl-smi">unknown</span><span class="pl-kos">]</span><span class="pl-kos">&gt;</span><span class="pl-kos">;</span>
    <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-smi">Map</span><span class="pl-kos">(</span><span class="pl-s1">array</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span> <span class="pl-c1">=</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-k">new</span> <span class="pl-smi">Set</span><span class="pl-kos">&lt;</span><span class="pl-smi">any</span><span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-k">new</span> <span class="pl-smi">Map</span><span class="pl-kos">&lt;</span><span class="pl-smi">any</span><span class="pl-kos">,</span> <span class="pl-smi">any</span><span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">]</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">decoded</span> <span class="pl-c1">=</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto">Not that extension types for custom objects must be <code>[0, 127]</code>, while <code>[-1, -128]</code> is reserved for MessagePack itself.</p>
<h8 dir="auto">
<a id="user-content-extensioncodec-context" class="anchor" aria-hidden="true" href="#extensioncodec-context"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>ExtensionCodec context</h8>
<p dir="auto">When using an extension codec, it may be necessary to keep encoding/decoding state, to keep track of which objects got encoded/re-created. To do this, pass a <code>context</code> to the <code>EncodeOptions</code> and <code>DecodeOptions</code> (and if using typescript, type the <code>ExtensionCodec</code> too). Don't forget to pass the <code>{extensionCodec, context}</code> along recursive encoding/decoding:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { encode, decode, ExtensionCodec } from "@msgpack/msgpack";

class MyContext {
  track(object: any) { /*...*/ }
}

class MyType { /* ... */ }

const extensionCodec = new ExtensionCodec&lt;MyContext&gt;();

// MyType
const MYTYPE_EXT_TYPE = 0 // Any in 0-127
extensionCodec.register({
  type: MYTYPE_EXT_TYPE,
  encode: (object, context) =&gt; {
    if (object instanceof MyType) {
      context.track(object); // &lt;-- like this
      return encode(object.toJSON(), { extensionCodec, context });
    } else {
      return null;
    }
  },
  decode: (data, extType, context) =&gt; {
    const decoded = decode(data, { extensionCodec, context });
    const my = new MyType(decoded);
    context.track(my); // &lt;-- and like this
    return my;
  },
});

// and later
import { encode, decode } from "@msgpack/msgpack";

const context = new MyContext();

const encoded = = encode({myType: new MyType&lt;any&gt;()}, { extensionCodec, context });
const decoded = decode(encoded, { extensionCodec, context });'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">encode</span><span class="pl-kos">,</span> <span class="pl-s1">decode</span><span class="pl-kos">,</span> <span class="pl-smi">ExtensionCodec</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">class</span> <span class="pl-smi">MyContext</span> <span class="pl-kos">{</span>
  <span class="pl-en">track</span><span class="pl-kos">(</span><span class="pl-s1">object</span>: <span class="pl-smi">any</span><span class="pl-kos">)</span> <span class="pl-kos">{</span> <span class="pl-c">/*...*/</span> <span class="pl-kos">}</span>
<span class="pl-kos">}</span>

<span class="pl-k">class</span> <span class="pl-smi">MyType</span> <span class="pl-kos">{</span> <span class="pl-c">/* ... */</span> <span class="pl-kos">}</span>

<span class="pl-k">const</span> <span class="pl-s1">extensionCodec</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">ExtensionCodec</span><span class="pl-kos">&lt;</span><span class="pl-smi">MyContext</span><span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// MyType</span>
<span class="pl-k">const</span> <span class="pl-smi">MYTYPE_EXT_TYPE</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span> <span class="pl-c">// Any in 0-127</span>
<span class="pl-s1">extensionCodec</span><span class="pl-kos">.</span><span class="pl-en">register</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
  <span class="pl-c1">type</span>: <span class="pl-smi">MYTYPE_EXT_TYPE</span><span class="pl-kos">,</span>
  <span class="pl-en">encode</span>: <span class="pl-kos">(</span><span class="pl-s1">object</span><span class="pl-kos">,</span> <span class="pl-s1">context</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">object</span> <span class="pl-k">instanceof</span> <span class="pl-smi">MyType</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">track</span><span class="pl-kos">(</span><span class="pl-s1">object</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// &lt;-- like this</span>
      <span class="pl-k">return</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">object</span><span class="pl-kos">.</span><span class="pl-en">toJSON</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec<span class="pl-kos">,</span> context <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span> <span class="pl-c1">null</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-en">decode</span>: <span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">,</span> <span class="pl-s1">extType</span><span class="pl-kos">,</span> <span class="pl-s1">context</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">const</span> <span class="pl-s1">decoded</span> <span class="pl-c1">=</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec<span class="pl-kos">,</span> context <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-k">const</span> <span class="pl-s1">my</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">MyType</span><span class="pl-kos">(</span><span class="pl-s1">decoded</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">track</span><span class="pl-kos">(</span><span class="pl-s1">my</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// &lt;-- and like this</span>
    <span class="pl-k">return</span> <span class="pl-s1">my</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// and later</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">encode</span><span class="pl-kos">,</span> <span class="pl-s1">decode</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">context</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">MyContext</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">encoded</span> <span class="pl-c1">=</span> <span class="pl-c1">=</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">myType</span>: <span class="pl-k">new</span> <span class="pl-smi">MyType</span><span class="pl-kos">&lt;</span><span class="pl-smi">any</span><span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec<span class="pl-kos">,</span> context <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">decoded</span> <span class="pl-c1">=</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec<span class="pl-kos">,</span> context <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h8 dir="auto">
<a id="user-content-handling-bigint-with-extensioncodec" class="anchor" aria-hidden="true" href="#handling-bigint-with-extensioncodec"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Handling BigInt with ExtensionCodec</h8>
<p dir="auto">This library does not handle BigInt by default, but you can handle it with <code>ExtensionCodec</code> like this:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { deepStrictEqual } from "assert";
import { encode, decode, ExtensionCodec } from "@msgpack/msgpack";

const BIGINT_EXT_TYPE = 0; // Any in 0-127
const extensionCodec = new ExtensionCodec();
extensionCodec.register({
    type: BIGINT_EXT_TYPE,
    encode: (input: unknown) =&gt; {
        if (typeof input === "bigint") {
            if (input &lt;= Number.MAX_SAFE_INTEGER &amp;&amp; input &gt;= Number.MIN_SAFE_INTEGER) {
                return encode(parseInt(input.toString(), 10));
            } else {
                return encode(input.toString());
            }
        } else {
            return null;
        }
    },
    decode: (data: Uint8Array) =&gt; {
        return BigInt(decode(data));
    },
});

const value = BigInt(Number.MAX_SAFE_INTEGER) + BigInt(1);
const encoded: = encode(value, { extensionCodec });
deepStrictEqual(decode(encoded, { extensionCodec }), value);'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">deepStrictEqual</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"assert"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">encode</span><span class="pl-kos">,</span> <span class="pl-s1">decode</span><span class="pl-kos">,</span> <span class="pl-smi">ExtensionCodec</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-smi">BIGINT_EXT_TYPE</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span><span class="pl-kos">;</span> <span class="pl-c">// Any in 0-127</span>
<span class="pl-k">const</span> <span class="pl-s1">extensionCodec</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">ExtensionCodec</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-s1">extensionCodec</span><span class="pl-kos">.</span><span class="pl-en">register</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
    <span class="pl-c1">type</span>: <span class="pl-smi">BIGINT_EXT_TYPE</span><span class="pl-kos">,</span>
    <span class="pl-en">encode</span>: <span class="pl-kos">(</span><span class="pl-s1">input</span>: <span class="pl-smi">unknown</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
        <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-k">typeof</span> <span class="pl-s1">input</span> <span class="pl-c1">===</span> <span class="pl-s">"bigint"</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
            <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">input</span> <span class="pl-c1">&lt;=</span> <span class="pl-smi">Number</span><span class="pl-kos">.</span><span class="pl-c1">MAX_SAFE_INTEGER</span> <span class="pl-c1">&amp;&amp;</span> <span class="pl-s1">input</span> <span class="pl-c1">&gt;=</span> <span class="pl-smi">Number</span><span class="pl-kos">.</span><span class="pl-c1">MIN_SAFE_INTEGER</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
                <span class="pl-k">return</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-en">parseInt</span><span class="pl-kos">(</span><span class="pl-s1">input</span><span class="pl-kos">.</span><span class="pl-en">toString</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-c1">10</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
            <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
                <span class="pl-k">return</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">input</span><span class="pl-kos">.</span><span class="pl-en">toString</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
            <span class="pl-kos">}</span>
        <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
            <span class="pl-k">return</span> <span class="pl-c1">null</span><span class="pl-kos">;</span>
        <span class="pl-kos">}</span>
    <span class="pl-kos">}</span><span class="pl-kos">,</span>
    <span class="pl-en">decode</span>: <span class="pl-kos">(</span><span class="pl-s1">data</span>: <span class="pl-smi">Uint8Array</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
        <span class="pl-k">return</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">value</span> <span class="pl-c1">=</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-smi">Number</span><span class="pl-kos">.</span><span class="pl-c1">MAX_SAFE_INTEGER</span><span class="pl-kos">)</span> <span class="pl-c1">+</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-c1">1</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">encoded</span>: <span class="pl-c1">=</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">value</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">deepStrictEqual</span><span class="pl-kos">(</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-s1">value</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h8 dir="auto">
<a id="user-content-the-temporal-module-as-timestamp-extensions" class="anchor" aria-hidden="true" href="#the-temporal-module-as-timestamp-extensions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The temporal module as timestamp extensions</h8>
<p dir="auto">There is a proposal for a new date/time representations in JavaScript:</p>
<ul dir="auto">
<li><a href="https://github.com/tc39/proposal-temporal">https://github.com/tc39/proposal-temporal</a></li>
</ul>
<p dir="auto">This library maps <code>Date</code> to the MessagePack timestamp extension by default, but you can re-map the temporal module (or <a href="https://github.com/tc39/proposal-temporal/tree/main/polyfill">Temporal Polyfill</a>) to the timestamp extension like this:</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content='import { Instant } from "@std-proposal/temporal";
import { deepStrictEqual } from "assert";
import {
  encode,
  decode,
  ExtensionCodec,
  EXT_TIMESTAMP,
  encodeTimeSpecToTimestamp,
  decodeTimestampToTimeSpec,
} from "@msgpack/msgpack";

const extensionCodec = new ExtensionCodec();
extensionCodec.register({
  type: EXT_TIMESTAMP, // override the default behavior!
  encode: (input: any) =&gt; {
    if (input instanceof Instant) {
      const sec = input.seconds;
      const nsec = Number(input.nanoseconds - BigInt(sec) * BigInt(1e9));
      return encodeTimeSpecToTimestamp({ sec, nsec });
    } else {
      return null;
    }
  },
  decode: (data: Uint8Array) =&gt; {
    const timeSpec = decodeTimestampToTimeSpec(data);
    const sec = BigInt(timeSpec.sec);
    const nsec = BigInt(timeSpec.nsec);
    return Instant.fromEpochNanoseconds(sec * BigInt(1e9) + nsec);
  },
});

const instant = Instant.fromEpochMilliseconds(Date.now());
const encoded = encode(instant, { extensionCodec });
const decoded = decode(encoded, { extensionCodec });
deepStrictEqual(decoded, instant);'><pre><span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">Instant</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@std-proposal/temporal"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">deepStrictEqual</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"assert"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span>
  <span class="pl-s1">encode</span><span class="pl-kos">,</span>
  <span class="pl-s1">decode</span><span class="pl-kos">,</span>
  <span class="pl-smi">ExtensionCodec</span><span class="pl-kos">,</span>
  <span class="pl-smi">EXT_TIMESTAMP</span><span class="pl-kos">,</span>
  <span class="pl-s1">encodeTimeSpecToTimestamp</span><span class="pl-kos">,</span>
  <span class="pl-s1">decodeTimestampToTimeSpec</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@msgpack/msgpack"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">extensionCodec</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-smi">ExtensionCodec</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-s1">extensionCodec</span><span class="pl-kos">.</span><span class="pl-en">register</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
  <span class="pl-c1">type</span>: <span class="pl-smi">EXT_TIMESTAMP</span><span class="pl-kos">,</span> <span class="pl-c">// override the default behavior!</span>
  <span class="pl-en">encode</span>: <span class="pl-kos">(</span><span class="pl-s1">input</span>: <span class="pl-smi">any</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">input</span> <span class="pl-k">instanceof</span> <span class="pl-smi">Instant</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-k">const</span> <span class="pl-s1">sec</span> <span class="pl-c1">=</span> <span class="pl-s1">input</span><span class="pl-kos">.</span><span class="pl-c1">seconds</span><span class="pl-kos">;</span>
      <span class="pl-k">const</span> <span class="pl-s1">nsec</span> <span class="pl-c1">=</span> <span class="pl-smi">Number</span><span class="pl-kos">(</span><span class="pl-s1">input</span><span class="pl-kos">.</span><span class="pl-c1">nanoseconds</span> <span class="pl-c1">-</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-s1">sec</span><span class="pl-kos">)</span> <span class="pl-c1">*</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-c1">1e9</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-k">return</span> <span class="pl-en">encodeTimeSpecToTimestamp</span><span class="pl-kos">(</span><span class="pl-kos">{</span> sec<span class="pl-kos">,</span> nsec <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span> <span class="pl-c1">null</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-en">decode</span>: <span class="pl-kos">(</span><span class="pl-s1">data</span>: <span class="pl-smi">Uint8Array</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">const</span> <span class="pl-s1">timeSpec</span> <span class="pl-c1">=</span> <span class="pl-en">decodeTimestampToTimeSpec</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-k">const</span> <span class="pl-s1">sec</span> <span class="pl-c1">=</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-s1">timeSpec</span><span class="pl-kos">.</span><span class="pl-c1">sec</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-k">const</span> <span class="pl-s1">nsec</span> <span class="pl-c1">=</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-s1">timeSpec</span><span class="pl-kos">.</span><span class="pl-c1">nsec</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-k">return</span> <span class="pl-smi">Instant</span><span class="pl-kos">.</span><span class="pl-en">fromEpochNanoseconds</span><span class="pl-kos">(</span><span class="pl-s1">sec</span> <span class="pl-c1">*</span> <span class="pl-smi">BigInt</span><span class="pl-kos">(</span><span class="pl-c1">1e9</span><span class="pl-kos">)</span> <span class="pl-c1">+</span> <span class="pl-s1">nsec</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">instant</span> <span class="pl-c1">=</span> <span class="pl-smi">Instant</span><span class="pl-kos">.</span><span class="pl-en">fromEpochMilliseconds</span><span class="pl-kos">(</span><span class="pl-smi">Date</span><span class="pl-kos">.</span><span class="pl-en">now</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">encoded</span> <span class="pl-c1">=</span> <span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">instant</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">const</span> <span class="pl-s1">decoded</span> <span class="pl-c1">=</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> extensionCodec <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">deepStrictEqual</span><span class="pl-kos">(</span><span class="pl-s1">decoded</span><span class="pl-kos">,</span> <span class="pl-s1">instant</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto">This will be default once the temporal module is standardizied, which is not a near-future, though.</p>
<h6 dir="auto">
<a id="user-content-decoding-a-blob" class="anchor" aria-hidden="true" href="#decoding-a-blob"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Decoding a Blob</h6>
<p dir="auto"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob" rel="nofollow"><code>Blob</code></a> is a binary data container provided by browsers. To read its contents, you can use <code>Blob#arrayBuffer()</code> or <code>Blob#stream()</code>. <code>Blob#stream()</code>
is recommended if your target platform support it. This is because streaming
decode should be faster for large objects. In both ways, you need to use
asynchronous API.</p>
<div class="highlight highlight-source-ts position-relative overflow-auto" data-snippet-clipboard-copy-content="async function decodeFromBlob(blob: Blob): unknown {
  if (blob.stream) {
    // Blob#stream(): ReadableStream&lt;Uint8Array&gt; (recommended)
    return await decodeAsync(blob.stream());
  } else {
    // Blob#arrayBuffer(): Promise&lt;ArrayBuffer&gt; (if stream() is not available)
    return decode(await blob.arrayBuffer());
  }
}"><pre><span class="pl-k">async</span> <span class="pl-k">function</span> <span class="pl-en">decodeFromBlob</span><span class="pl-kos">(</span><span class="pl-s1">blob</span>: <span class="pl-smi">Blob</span><span class="pl-kos">)</span>: <span class="pl-smi">unknown</span> <span class="pl-kos">{</span>
  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">blob</span><span class="pl-kos">.</span><span class="pl-c1">stream</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-c">// Blob#stream(): ReadableStream&lt;Uint8Array&gt; (recommended)</span>
    <span class="pl-k">return</span> <span class="pl-k">await</span> <span class="pl-en">decodeAsync</span><span class="pl-kos">(</span><span class="pl-s1">blob</span><span class="pl-kos">.</span><span class="pl-en">stream</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
    <span class="pl-c">// Blob#arrayBuffer(): Promise&lt;ArrayBuffer&gt; (if stream() is not available)</span>
    <span class="pl-k">return</span> <span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-k">await</span> <span class="pl-s1">blob</span><span class="pl-kos">.</span><span class="pl-en">arrayBuffer</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span>
<span class="pl-kos">}</span></pre></div>
<h6 dir="auto">
<a id="user-content-messagepack-specification" class="anchor" aria-hidden="true" href="#messagepack-specification"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack Specification</h6>
<p dir="auto">This library is compatible with the "August 2017" revision of MessagePack specification at the point where timestamp ext was added:</p>
<ul class="contains-task-list">
<li class="task-list-item">
<input type="checkbox" id="" disabled class="task-list-item-checkbox" checked> str/bin separation, added at August 2013</li>
<li class="task-list-item">
<input type="checkbox" id="" disabled class="task-list-item-checkbox" checked> extension types, added at August 2013</li>
<li class="task-list-item">
<input type="checkbox" id="" disabled class="task-list-item-checkbox" checked> timestamp ext type, added at August 2017</li>
</ul>
<p dir="auto">The livinng specification is here:</p>
<p dir="auto"><a href="https://github.com/msgpack/msgpack">https://github.com/msgpack/msgpack</a></p>
<p dir="auto">Note that as of June 2019 there're no official "version" on the MessagePack specification. See <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="67553770" data-permission-text="Title is private" data-url="https://github.com/msgpack/msgpack/issues/195" data-hovercard-type="issue" data-hovercard-url="/msgpack/msgpack/issues/195/hovercard" href="https://github.com/msgpack/msgpack/issues/195">msgpack/msgpack#195</a> for the discussions.</p>
<h7 dir="auto">
<a id="user-content-messagepack-mapping-table" class="anchor" aria-hidden="true" href="#messagepack-mapping-table"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack Mapping Table</h7>
<p dir="auto">The following table shows how JavaScript values are mapped to <a href="https://github.com/msgpack/msgpack/blob/master/spec.md">MessagePack formats</a> and vice versa.</p>
<table>
<thead>
<tr>
<th>Source Value</th>
<th>MessagePack Format</th>
<th>Value Decoded</th>
</tr>
</thead>
<tbody>
<tr>
<td>null, undefined</td>
<td>nil</td>
<td>null (*1)</td>
</tr>
<tr>
<td>boolean (true, false)</td>
<td>bool family</td>
<td>boolean (true, false)</td>
</tr>
<tr>
<td>number (53-bit int)</td>
<td>int family</td>
<td>number (53-bit int)</td>
</tr>
<tr>
<td>number (64-bit float)</td>
<td>float family</td>
<td>number (64-bit float)</td>
</tr>
<tr>
<td>string</td>
<td>str family</td>
<td>string</td>
</tr>
<tr>
<td>ArrayBufferView</td>
<td>bin family</td>
<td>Uint8Array (*2)</td>
</tr>
<tr>
<td>Array</td>
<td>array family</td>
<td>Array</td>
</tr>
<tr>
<td>Object</td>
<td>map family</td>
<td>Object (*3)</td>
</tr>
<tr>
<td>Date</td>
<td>timestamp ext family</td>
<td>Date (*4)</td>
</tr>
</tbody>
</table>
<ul dir="auto">
<li>*1 Both <code>null</code> and <code>undefined</code> are mapped to <code>nil</code> (<code>0xC0</code>) type, and are decoded into <code>null</code>
</li>
<li>*2 Any <code>ArrayBufferView</code>s including NodeJS's <code>Buffer</code> are mapped to <code>bin</code> family, and are decoded into <code>Uint8Array</code>
</li>
<li>*3 In handling <code>Object</code>, it is regarded as <code>Record&lt;string, unknown&gt;</code> in terms of TypeScript</li>
<li>*4 MessagePack timestamps may have nanoseconds, which will lost when it is decoded into JavaScript <code>Date</code>. This behavior can be overridden by registering <code>-1</code> for the extension codec.</li>
</ul>
<h6 dir="auto">
<a id="user-content-prerequisites" class="anchor" aria-hidden="true" href="#prerequisites"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Prerequisites</h6>
<p dir="auto">This is a universal JavaScript library that supports major browsers and NodeJS.</p>
<h7 dir="auto">
<a id="user-content-ecma-262" class="anchor" aria-hidden="true" href="#ecma-262"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>ECMA-262</h7>
<ul dir="auto">
<li>ES5 language features</li>
<li>ES2018 standard library, including:
<ul dir="auto">
<li>Typed arrays (ES2015)</li>
<li>Async iterations (ES2018)</li>
<li>Features added in ES2015-ES2018</li>
</ul>
</li>
</ul>
<p dir="auto">ES2018 standard library used in this library can be polyfilled with <a href="https://github.com/zloirock/core-js">core-js</a>.</p>
<p dir="auto">If you support IE11, import <code>core-js</code> in your application entrypoints, as this library does in testing for browsers.</p>
<h7 dir="auto">
<a id="user-content-nodejs" class="anchor" aria-hidden="true" href="#nodejs"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>NodeJS</h7>
<p dir="auto">NodeJS v10 is required, but NodeJS v12 or later is recommended because it includes the V8 feature of <a href="https://v8.dev/blog/dataview" rel="nofollow">Improving DataView performance in V8</a>.</p>
<p dir="auto">NodeJS before v10 will work by importing <code>@msgpack/msgpack/dist.es5+umd/msgpack</code>.</p>
<h7 dir="auto">
<a id="user-content-typescript-compiler--type-definitions" class="anchor" aria-hidden="true" href="#typescript-compiler--type-definitions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TypeScript Compiler / Type Definitions</h7>
<p dir="auto">This module requires type definitions of <code>AsyncIterator</code>, <code>SourceBuffer</code>, whatwg streams, and so on. They are provided by <code>"lib": ["ES2021", "DOM"]</code> in <code>tsconfig.json</code>.</p>
<p dir="auto">Regarding the TypeScript compiler version, only the latest TypeScript is tested in development.</p>
<h6 dir="auto">
<a id="user-content-benchmark" class="anchor" aria-hidden="true" href="#benchmark"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Benchmark</h6>
<p dir="auto">Run-time performance is not the only reason to use MessagePack, but it's important to choose MessagePack libraries, so a benchmark suite is provided to monitor the performance of this library.</p>
<p dir="auto">V8's built-in JSON has been improved for years, esp. <code>JSON.parse()</code> is <a href="https://v8.dev/blog/v8-release-76" rel="nofollow">significantly improved in V8/7.6</a>, it is the fastest deserializer as of 2019, as the benchmark result bellow suggests.</p>
<p dir="auto">However, MessagePack can handles binary data effectively, actual performance depends on situations. You'd better take benchmark on your own use-case if performance matters.</p>
<p dir="auto">Benchmark on NodeJS/v12.18.3 (V8/7.8)</p>
<table>
<thead>
<tr>
<th>operation</th>
<th align="right">op</th>
<th align="right">ms</th>
<th align="right">op/s</th>
</tr>
</thead>
<tbody>
<tr>
<td>buf = Buffer.from(JSON.stringify(obj));</td>
<td align="right">840700</td>
<td align="right">5000</td>
<td align="right">168140</td>
</tr>
<tr>
<td>buf = JSON.stringify(obj);</td>
<td align="right">1249800</td>
<td align="right">5000</td>
<td align="right">249960</td>
</tr>
<tr>
<td>obj = JSON.parse(buf);</td>
<td align="right">1648000</td>
<td align="right">5000</td>
<td align="right">329600</td>
</tr>
<tr>
<td>buf = require("msgpack-lite").encode(obj);</td>
<td align="right">603500</td>
<td align="right">5000</td>
<td align="right">120700</td>
</tr>
<tr>
<td>obj = require("msgpack-lite").decode(buf);</td>
<td align="right">315900</td>
<td align="right">5000</td>
<td align="right">63180</td>
</tr>
<tr>
<td>buf = require("@msgpack/msgpack").encode(obj);</td>
<td align="right">945400</td>
<td align="right">5000</td>
<td align="right">189080</td>
</tr>
<tr>
<td>obj = require("@msgpack/msgpack").decode(buf);</td>
<td align="right">770200</td>
<td align="right">5000</td>
<td align="right">154040</td>
</tr>
<tr>
<td>buf = /* @msgpack/msgpack */ encoder.encode(obj);</td>
<td align="right">1162600</td>
<td align="right">5000</td>
<td align="right">232520</td>
</tr>
<tr>
<td>obj = /* @msgpack/msgpack */ decoder.decode(buf);</td>
<td align="right">787800</td>
<td align="right">5000</td>
<td align="right">157560</td>
</tr>
</tbody>
</table>
<p dir="auto">Note that <code>Buffer.from()</code> for <code>JSON.stringify()</code> is necessary to emulate I/O where a JavaScript string must be converted into a byte array encoded in UTF-8, whereas MessagePack's <code>encode()</code> returns a byte array.</p>
<h6 dir="auto">
<a id="user-content-distribution" class="anchor" aria-hidden="true" href="#distribution"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Distribution</h6>
<h7 dir="auto">
<a id="user-content-npm--npmjscom" class="anchor" aria-hidden="true" href="#npm--npmjscom"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>NPM / npmjs.com</h7>
<p dir="auto">The NPM package distributed in npmjs.com includes both ES2015+ and ES5 files:</p>
<ul dir="auto">
<li>
<code>dist/</code> is compiled into ES2019 with CommomJS, provided for NodeJS v10</li>
<li>
<code>dist.es5+umd/</code> is compiled into ES5 with UMD
<ul dir="auto">
<li>
<code>dist.es5+umd/msgpack.min.js</code> - the minified file</li>
<li>
<code>dist.es5+umd/msgpack.js</code> - the non-minified file</li>
</ul>
</li>
<li>
<code>dist.es5+esm/</code> is compiled into ES5 with ES modules, provided for webpack-like bundlers and NodeJS's ESM-mode</li>
</ul>
<p dir="auto">If you use NodeJS and/or webpack, their module resolvers use the suitable one automatically.</p>
<h7 dir="auto">
<a id="user-content-cdn--unpkgcom" class="anchor" aria-hidden="true" href="#cdn--unpkgcom"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CDN / unpkg.com</h7>
<p dir="auto">This library is available via CDN:</p>
<div class="highlight highlight-text-html-basic position-relative overflow-auto" data-snippet-clipboard-copy-content='&lt;script crossorigin src="https://unpkg.com/@msgpack/msgpack"&gt;&lt;/script&gt;'><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span> <span class="pl-c1">crossorigin</span> <span class="pl-c1">src</span>="<span class="pl-s">https://unpkg.com/@msgpack/msgpack</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto">It loads <code>MessagePack</code> module to the global object.</p>
<h6 dir="auto">
<a id="user-content-deno-support" class="anchor" aria-hidden="true" href="#deno-support"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Deno Support</h6>
<p dir="auto">You can use this module on Deno.</p>
<p dir="auto">See <code>example/deno-*.ts</code> for examples.</p>
<p dir="auto"><code>deno.land/x</code> is not supported yet.</p>
<h6 dir="auto">
<a id="user-content-maintenance" class="anchor" aria-hidden="true" href="#maintenance"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Maintenance</h6>
<h7 dir="auto">
<a id="user-content-testing" class="anchor" aria-hidden="true" href="#testing"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Testing</h7>
<p dir="auto">For simple testing:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="npm run test"><pre><code>npm run test
</code></pre></div>
<h7 dir="auto">
<a id="user-content-continuous-integration" class="anchor" aria-hidden="true" href="#continuous-integration"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Continuous Integration</h7>
<p dir="auto">This library uses Travis CI.</p>
<p dir="auto">test matrix:</p>
<ul dir="auto">
<li>TypeScript targets
<ul dir="auto">
<li>
<code>target=es2019</code> / <code>target=es5</code>
</li>
</ul>
</li>
<li>JavaScript engines
<ul dir="auto">
<li>NodeJS, browsers (Chrome, Firefox, Safari, IE11, and so on)</li>
</ul>
</li>
</ul>
<p dir="auto">See <a href="/msgpack/msgpack-javascript/blob/main/package.json">test:* in package.json</a> and <a href="/msgpack/msgpack-javascript/blob/main/.travis.yml">.travis.yml</a> for details.</p>
<h7 dir="auto">
<a id="user-content-release-engineering" class="anchor" aria-hidden="true" href="#release-engineering"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Release Engineering</h7>
<div class="highlight highlight-text-shell-session position-relative overflow-auto" data-snippet-clipboard-copy-content="# run tests on NodeJS, Chrome, and Firefox
make test-all

# edit the changelog
code CHANGELOG.md

# bump version
npm version patch|minor|major

# run the publishing task
make publish"><pre># <span class="pl-s1">run tests on NodeJS, Chrome, and Firefox</span>
<span class="pl-c1">make test-all</span>

# <span class="pl-s1">edit the changelog</span>
<span class="pl-c1">code CHANGELOG.md</span>

# <span class="pl-s1">bump version</span>
<span class="pl-c1">npm version patch|minor|major</span>

# <span class="pl-s1">run the publishing task</span>
<span class="pl-c1">make publish</span></pre></div>
<h7 dir="auto">
<a id="user-content-updating-dependencies" class="anchor" aria-hidden="true" href="#updating-dependencies"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Updating Dependencies</h7>
<div class="highlight highlight-text-shell-session position-relative overflow-auto" data-snippet-clipboard-copy-content="npm run update-dependencies"><pre><span class="pl-c1">npm run update-dependencies</span></pre></div>
<h6 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h6>
<p dir="auto">Copyright 2019 The MessagePack community.</p>
<p dir="auto">This software uses the ISC license:</p>
<p dir="auto"><a href="https://opensource.org/licenses/ISC" rel="nofollow">https://opensource.org/licenses/ISC</a></p>
<p dir="auto">See <a href="/msgpack/msgpack-javascript/blob/main/LICENSE">LICENSE</a> for details.</p>
</article>
  </div>
        </div>
        
        <div id="qs-kawanet-msgpack-lite" class="qs"><h4><a href="https://www.npmjs.com/package/msgpack-lite" target="_blank">kawanet/msgpack-lite <span class="qs-url">https://www.npmjs.com/package/msgpack-lite</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-msgpack-lite--" class="anchor" aria-hidden="true" href="#msgpack-lite--"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>msgpack-lite <a href="http://badge.fury.io/js/msgpack-lite" rel="nofollow"><img src="https://camo.githubusercontent.com/8756d61e7043e0623a0c68372f184b034c4b4bc915d18bd235e40a7f23deb32a/68747470733a2f2f62616467652e667572792e696f2f6a732f6d73677061636b2d6c6974652e737667" alt="npm version" data-canonical-src="https://badge.fury.io/js/msgpack-lite.svg" style="max-width: 100%;"></a> <a href="https://travis-ci.org/kawanet/msgpack-lite" rel="nofollow"><img src="https://camo.githubusercontent.com/2754f4262334cb17fff08940d008073393dc3ef20a171060b6704576b45e721c/68747470733a2f2f7472617669732d63692e6f72672f6b6177616e65742f6d73677061636b2d6c6974652e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/kawanet/msgpack-lite.svg?branch=master" style="max-width: 100%;"></a>
</h5>
<p dir="auto">Fast Pure JavaScript MessagePack Encoder and Decoder</p>
<p dir="auto"><a href="https://saucelabs.com/u/msgpack-lite" rel="nofollow"><img src="https://camo.githubusercontent.com/1154a6b8c4a92e36b5a3ac2d2922274ae4b5a8ed7e2e36ace7f9dfeba74fa74e/68747470733a2f2f73617563656c6162732e636f6d2f62726f777365722d6d61747269782f6d73677061636b2d6c6974652e737667" alt="Sauce Test Status" data-canonical-src="https://saucelabs.com/browser-matrix/msgpack-lite.svg" style="max-width: 100%;"></a></p>
<p dir="auto">Online demo: <a href="http://kawanet.github.io/msgpack-lite/" rel="nofollow">http://kawanet.github.io/msgpack-lite/</a></p>
<h7 dir="auto">
<a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h7>
<ul dir="auto">
<li>Pure JavaScript only (No node-gyp nor gcc required)</li>
<li>Faster than any other pure JavaScript libraries on node.js v4</li>
<li>Even faster than node-gyp C++ based <a href="https://www.npmjs.com/package/msgpack" rel="nofollow">msgpack</a> library (<strong>90% faster</strong> on encoding)</li>
<li>Streaming encoding and decoding interface is also available. It's more faster.</li>
<li>Ready for <a href="https://saucelabs.com/u/msgpack-lite" rel="nofollow">Web browsers</a> including Chrome, Firefox, Safari and even IE8</li>
<li>
<a href="https://travis-ci.org/kawanet/msgpack-lite" rel="nofollow">Tested</a> on Node.js v0.10, v0.12, v4, v5 and v6 as well as Web browsers</li>
</ul>
<h7 dir="auto">
<a id="user-content-encoding-and-decoding-messagepack" class="anchor" aria-hidden="true" href="#encoding-and-decoding-messagepack"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Encoding and Decoding MessagePack</h7>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content='var msgpack = require("msgpack-lite");

// encode from JS Object to MessagePack (Buffer)
var buffer = msgpack.encode({"foo": "bar"});

// decode from MessagePack (Buffer) to JS Object
var data = msgpack.decode(buffer); // =&gt; {"foo": "bar"}

// if encode/decode receives an invalid argument an error is thrown'><pre><span class="pl-k">var</span> <span class="pl-s1">msgpack</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"msgpack-lite"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// encode from JS Object to MessagePack (Buffer)</span>
<span class="pl-k">var</span> <span class="pl-s1">buffer</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-s">"foo"</span>: <span class="pl-s">"bar"</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// decode from MessagePack (Buffer) to JS Object</span>
<span class="pl-k">var</span> <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">buffer</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; {"foo": "bar"}</span>

<span class="pl-c">// if encode/decode receives an invalid argument an error is thrown</span></pre></div>
<h7 dir="auto">
<a id="user-content-writing-to-messagepack-stream" class="anchor" aria-hidden="true" href="#writing-to-messagepack-stream"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Writing to MessagePack Stream</h7>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var fs = require(&quot;fs&quot;);
var msgpack = require(&quot;msgpack-lite&quot;);

var writeStream = fs.createWriteStream(&quot;test.msp&quot;);
var encodeStream = msgpack.createEncodeStream();
encodeStream.pipe(writeStream);

// send multiple objects to stream
encodeStream.write({foo: &quot;bar&quot;});
encodeStream.write({baz: &quot;qux&quot;});

// call this once you're done writing to the stream.
encodeStream.end();"><pre><span class="pl-k">var</span> <span class="pl-s1">fs</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"fs"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">msgpack</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"msgpack-lite"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">var</span> <span class="pl-s1">writeStream</span> <span class="pl-c1">=</span> <span class="pl-s1">fs</span><span class="pl-kos">.</span><span class="pl-en">createWriteStream</span><span class="pl-kos">(</span><span class="pl-s">"test.msp"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">encodeStream</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createEncodeStream</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-s1">encodeStream</span><span class="pl-kos">.</span><span class="pl-en">pipe</span><span class="pl-kos">(</span><span class="pl-s1">writeStream</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// send multiple objects to stream</span>
<span class="pl-s1">encodeStream</span><span class="pl-kos">.</span><span class="pl-en">write</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">foo</span>: <span class="pl-s">"bar"</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-s1">encodeStream</span><span class="pl-kos">.</span><span class="pl-en">write</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">baz</span>: <span class="pl-s">"qux"</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// call this once you're done writing to the stream.</span>
<span class="pl-s1">encodeStream</span><span class="pl-kos">.</span><span class="pl-en">end</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h7 dir="auto">
<a id="user-content-reading-from-messagepack-stream" class="anchor" aria-hidden="true" href="#reading-from-messagepack-stream"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Reading from MessagePack Stream</h7>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content='var fs = require("fs");
var msgpack = require("msgpack-lite");

var readStream = fs.createReadStream("test.msp");
var decodeStream = msgpack.createDecodeStream();

// show multiple objects decoded from stream
readStream.pipe(decodeStream).on("data", console.warn);'><pre><span class="pl-k">var</span> <span class="pl-s1">fs</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"fs"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">msgpack</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"msgpack-lite"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">var</span> <span class="pl-s1">readStream</span> <span class="pl-c1">=</span> <span class="pl-s1">fs</span><span class="pl-kos">.</span><span class="pl-en">createReadStream</span><span class="pl-kos">(</span><span class="pl-s">"test.msp"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">decodeStream</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createDecodeStream</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// show multiple objects decoded from stream</span>
<span class="pl-s1">readStream</span><span class="pl-kos">.</span><span class="pl-en">pipe</span><span class="pl-kos">(</span><span class="pl-s1">decodeStream</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">on</span><span class="pl-kos">(</span><span class="pl-s">"data"</span><span class="pl-kos">,</span> <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-c1">warn</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h7 dir="auto">
<a id="user-content-decoding-messagepack-bytes-array" class="anchor" aria-hidden="true" href="#decoding-messagepack-bytes-array"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Decoding MessagePack Bytes Array</h7>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content='var msgpack = require("msgpack-lite");

// decode() accepts Buffer instance per default
msgpack.decode(Buffer([0x81, 0xA3, 0x66, 0x6F, 0x6F, 0xA3, 0x62, 0x61, 0x72]));

// decode() also accepts Array instance
msgpack.decode([0x81, 0xA3, 0x66, 0x6F, 0x6F, 0xA3, 0x62, 0x61, 0x72]);

// decode() accepts raw Uint8Array instance as well
msgpack.decode(new Uint8Array([0x81, 0xA3, 0x66, 0x6F, 0x6F, 0xA3, 0x62, 0x61, 0x72]));'><pre><span class="pl-k">var</span> <span class="pl-s1">msgpack</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"msgpack-lite"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// decode() accepts Buffer instance per default</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0x81</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x66</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x62</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">,</span> <span class="pl-c1">0x72</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// decode() also accepts Array instance</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0x81</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x66</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x62</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">,</span> <span class="pl-c1">0x72</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// decode() accepts raw Uint8Array instance as well</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-v">Uint8Array</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0x81</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x66</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x62</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">,</span> <span class="pl-c1">0x72</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h7 dir="auto">
<a id="user-content-command-line-interface" class="anchor" aria-hidden="true" href="#command-line-interface"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Command Line Interface</h7>
<p dir="auto">A CLI tool bin/msgpack converts data stream from JSON to MessagePack and vice versa.</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="$ echo '{&quot;foo&quot;: &quot;bar&quot;}' | ./bin/msgpack -Jm | od -tx1
0000000    81  a3  66  6f  6f  a3  62  61  72

$ echo '{&quot;foo&quot;: &quot;bar&quot;}' | ./bin/msgpack -Jm | ./bin/msgpack -Mj
{&quot;foo&quot;:&quot;bar&quot;}"><pre>$ <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>{"foo": "bar"}<span class="pl-pds">'</span></span> <span class="pl-k">|</span> ./bin/msgpack -Jm <span class="pl-k">|</span> od -tx1
0000000    81  a3  66  6f  6f  a3  62  61  72

$ <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>{"foo": "bar"}<span class="pl-pds">'</span></span> <span class="pl-k">|</span> ./bin/msgpack -Jm <span class="pl-k">|</span> ./bin/msgpack -Mj
{<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>}</pre></div>
<h7 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h7>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="$ npm install --save msgpack-lite"><pre>$ npm install --save msgpack-lite</pre></div>
<h7 dir="auto">
<a id="user-content-tests" class="anchor" aria-hidden="true" href="#tests"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tests</h7>
<p dir="auto">Run tests on node.js:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="$ make test"><pre>$ make <span class="pl-c1">test</span></pre></div>
<p dir="auto">Run tests on browsers:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="$ make test-browser-local
open the following url in a browser:
http://localhost:4000/__zuul"><pre>$ make test-browser-local
open the following url <span class="pl-k">in</span> a browser:
http://localhost:4000/__zuul</pre></div>
<h7 dir="auto">
<a id="user-content-browser-build" class="anchor" aria-hidden="true" href="#browser-build"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Browser Build</h7>
<p dir="auto">Browser version <a href="https://rawgit.com/kawanet/msgpack-lite/master/dist/msgpack.min.js" rel="nofollow">msgpack.min.js</a> is also available. 50KB minified, 14KB gziped.</p>
<div class="highlight highlight-text-html-basic position-relative overflow-auto" data-snippet-clipboard-copy-content='&lt;!--[if lte IE 9]&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.1.10/es5-shim.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js"&gt;&lt;/script&gt;
&lt;![endif]--&gt;
&lt;script src="https://rawgit.com/kawanet/msgpack-lite/master/dist/msgpack.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
// encode from JS Object to MessagePack (Uint8Array)
var buffer = msgpack.encode({foo: "bar"});

// decode from MessagePack (Uint8Array) to JS Object
var array = new Uint8Array([0x81, 0xA3, 0x66, 0x6F, 0x6F, 0xA3, 0x62, 0x61, 0x72]);
var data = msgpack.decode(array);
&lt;/script&gt;'><pre><span class="pl-c">&lt;!--[if lte IE 9]&gt;</span>
<span class="pl-c">&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.1.10/es5-shim.min.js"&gt;&lt;/script&gt;</span>
<span class="pl-c">&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js"&gt;&lt;/script&gt;</span>
<span class="pl-c">&lt;![endif]--&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">script</span> <span class="pl-c1">src</span>="<span class="pl-s">https://rawgit.com/kawanet/msgpack-lite/master/dist/msgpack.min.js</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
<span class="pl-c">// encode from JS Object to MessagePack (Uint8Array)</span>
<span class="pl-k">var</span> <span class="pl-s1">buffer</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">foo</span>: <span class="pl-s">"bar"</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// decode from MessagePack (Uint8Array) to JS Object</span>
<span class="pl-k">var</span> <span class="pl-s1">array</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-v">Uint8Array</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0x81</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x66</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0x6F</span><span class="pl-kos">,</span> <span class="pl-c1">0xA3</span><span class="pl-kos">,</span> <span class="pl-c1">0x62</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">,</span> <span class="pl-c1">0x72</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">array</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<h7 dir="auto">
<a id="user-content-messagepack-with-browserify" class="anchor" aria-hidden="true" href="#messagepack-with-browserify"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack With Browserify</h7>
<p dir="auto">Step <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="102625486" data-permission-text="Title is private" data-url="https://github.com/kawanet/msgpack-lite/issues/1" data-hovercard-type="issue" data-hovercard-url="/kawanet/msgpack-lite/issues/1/hovercard" href="https://github.com/kawanet/msgpack-lite/issues/1">#1</a>: write some code at first.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content='var msgpack = require("msgpack-lite");
var buffer = msgpack.encode({"foo": "bar"});
var data = msgpack.decode(buffer);
console.warn(data); // =&gt; {"foo": "bar"}'><pre><span class="pl-k">var</span> <span class="pl-s1">msgpack</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"msgpack-lite"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">buffer</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-s">"foo"</span>: <span class="pl-s">"bar"</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">buffer</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">warn</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; {"foo": "bar"}</span></pre></div>
<p dir="auto">Proceed to the next steps if you prefer faster browserify compilation time.</p>
<p dir="auto">Step <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="103352382" data-permission-text="Title is private" data-url="https://github.com/kawanet/msgpack-lite/issues/2" data-hovercard-type="issue" data-hovercard-url="/kawanet/msgpack-lite/issues/2/hovercard" href="https://github.com/kawanet/msgpack-lite/issues/2">#2</a>: add <code>browser</code> property on <code>package.json</code> in your project. This refers the global <code>msgpack</code> object instead of including whole of <code>msgpack-lite</code> source code.</p>
<div class="highlight highlight-source-json position-relative overflow-auto" data-snippet-clipboard-copy-content='{
  "dependencies": {
    "msgpack-lite": "*"
  },
  "browser": {
    "msgpack-lite": "msgpack-lite/global"
  }
}'><pre>{
  <span class="pl-ent">"dependencies"</span>: {
    <span class="pl-ent">"msgpack-lite"</span>: <span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span>
  },
  <span class="pl-ent">"browser"</span>: {
    <span class="pl-ent">"msgpack-lite"</span>: <span class="pl-s"><span class="pl-pds">"</span>msgpack-lite/global<span class="pl-pds">"</span></span>
  }
}</pre></div>
<p dir="auto">Step <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="103869379" data-permission-text="Title is private" data-url="https://github.com/kawanet/msgpack-lite/issues/3" data-hovercard-type="pull_request" data-hovercard-url="/kawanet/msgpack-lite/pull/3/hovercard" href="https://github.com/kawanet/msgpack-lite/pull/3">#3</a>: compile it with <a href="https://www.npmjs.com/package/browserify" rel="nofollow">browserify</a> and <a href="https://www.npmjs.com/package/uglify-js" rel="nofollow">uglifyjs</a>.</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="browserify src/main.js -o tmp/main.browserify.js -s main
uglifyjs tmp/main.browserify.js -m -c -o js/main.min.js
cp node_modules/msgpack-lite/dist/msgpack.min.js js/msgpack.min.js"><pre>browserify src/main.js -o tmp/main.browserify.js -s main
uglifyjs tmp/main.browserify.js -m -c -o js/main.min.js
cp node_modules/msgpack-lite/dist/msgpack.min.js js/msgpack.min.js</pre></div>
<p dir="auto">Step <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="104078625" data-permission-text="Title is private" data-url="https://github.com/kawanet/msgpack-lite/issues/4" data-hovercard-type="pull_request" data-hovercard-url="/kawanet/msgpack-lite/pull/4/hovercard" href="https://github.com/kawanet/msgpack-lite/pull/4">#4</a>: load <a href="https://rawgit.com/kawanet/msgpack-lite/master/dist/msgpack.min.js" rel="nofollow">msgpack.min.js</a> before your code.</p>
<div class="highlight highlight-text-html-basic position-relative overflow-auto" data-snippet-clipboard-copy-content='&lt;script src="js/msgpack.min.js"&gt;&lt;/script&gt;
&lt;script src="js/main.min.js"&gt;&lt;/script&gt;'><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span> <span class="pl-c1">src</span>="<span class="pl-s">js/msgpack.min.js</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">script</span> <span class="pl-c1">src</span>="<span class="pl-s">js/main.min.js</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<h7 dir="auto">
<a id="user-content-interoperability" class="anchor" aria-hidden="true" href="#interoperability"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Interoperability</h7>
<p dir="auto">It is tested to have basic compatibility with other Node.js MessagePack modules below:</p>
<ul dir="auto">
<li>
<a href="https://www.npmjs.com/package/msgpack" rel="nofollow">https://www.npmjs.com/package/msgpack</a> (1.0.2)</li>
<li>
<a href="https://www.npmjs.com/package/msgpack-js" rel="nofollow">https://www.npmjs.com/package/msgpack-js</a> (0.3.0)</li>
<li>
<a href="https://www.npmjs.com/package/msgpack-js-v5" rel="nofollow">https://www.npmjs.com/package/msgpack-js-v5</a> (0.3.0-v5)</li>
<li>
<a href="https://www.npmjs.com/package/msgpack-unpack" rel="nofollow">https://www.npmjs.com/package/msgpack-unpack</a> (2.1.1)</li>
<li>
<a href="https://github.com/msgpack/msgpack-javascript">https://github.com/msgpack/msgpack-javascript</a> (msgpack.codec)</li>
<li>
<a href="https://www.npmjs.com/package/msgpack5" rel="nofollow">https://www.npmjs.com/package/msgpack5</a> (3.3.0)</li>
<li>
<a href="https://www.npmjs.com/package/notepack" rel="nofollow">https://www.npmjs.com/package/notepack</a> (0.0.2)</li>
</ul>
<h7 dir="auto">
<a id="user-content-benchmarks" class="anchor" aria-hidden="true" href="#benchmarks"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Benchmarks</h7>
<p dir="auto">A benchmark tool <code>lib/benchmark.js</code> is available to compare encoding/decoding speed
(operation per second) with other MessagePack modules.
It counts operations of <a href="https://github.com/kawanet/msgpack-lite/blob/master/test/example.json">1KB JSON document</a> in 10 seconds.</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="$ npm install msgpack msgpack-js msgpack-js-v5 msgpack-unpack msgpack5 notepack
$ npm run benchmark 10"><pre>$ npm install msgpack msgpack-js msgpack-js-v5 msgpack-unpack msgpack5 notepack
$ npm run benchmark 10</pre></div>
<table>
<thead>
<tr>
<th>operation</th>
<th align="right">op</th>
<th align="right">ms</th>
<th align="right">op/s</th>
</tr>
</thead>
<tbody>
<tr>
<td>buf = Buffer(JSON.stringify(obj));</td>
<td align="right">1055200</td>
<td align="right">10000</td>
<td align="right">105520</td>
</tr>
<tr>
<td>obj = JSON.parse(buf);</td>
<td align="right">863800</td>
<td align="right">10000</td>
<td align="right">86380</td>
</tr>
<tr>
<td>buf = require("msgpack-lite").encode(obj);</td>
<td align="right">969100</td>
<td align="right">10000</td>
<td align="right">96910</td>
</tr>
<tr>
<td>obj = require("msgpack-lite").decode(buf);</td>
<td align="right">600300</td>
<td align="right">10000</td>
<td align="right">60030</td>
</tr>
<tr>
<td>buf = require("msgpack").pack(obj);</td>
<td align="right">503500</td>
<td align="right">10001</td>
<td align="right">50344</td>
</tr>
<tr>
<td>obj = require("msgpack").unpack(buf);</td>
<td align="right">560200</td>
<td align="right">10001</td>
<td align="right">56014</td>
</tr>
<tr>
<td>buf = Buffer(require("msgpack.codec").msgpack.pack(obj));</td>
<td align="right">653500</td>
<td align="right">10000</td>
<td align="right">65349</td>
</tr>
<tr>
<td>obj = require("msgpack.codec").msgpack.unpack(buf);</td>
<td align="right">367500</td>
<td align="right">10001</td>
<td align="right">36746</td>
</tr>
<tr>
<td>buf = require("msgpack-js-v5").encode(obj);</td>
<td align="right">189500</td>
<td align="right">10002</td>
<td align="right">18946</td>
</tr>
<tr>
<td>obj = require("msgpack-js-v5").decode(buf);</td>
<td align="right">408900</td>
<td align="right">10000</td>
<td align="right">40890</td>
</tr>
<tr>
<td>buf = require("msgpack-js").encode(obj);</td>
<td align="right">189200</td>
<td align="right">10000</td>
<td align="right">18920</td>
</tr>
<tr>
<td>obj = require("msgpack-js").decode(buf);</td>
<td align="right">375600</td>
<td align="right">10002</td>
<td align="right">37552</td>
</tr>
<tr>
<td>buf = require("msgpack5")().encode(obj);</td>
<td align="right">110500</td>
<td align="right">10009</td>
<td align="right">11040</td>
</tr>
<tr>
<td>obj = require("msgpack5")().decode(buf);</td>
<td align="right">165500</td>
<td align="right">10000</td>
<td align="right">16550</td>
</tr>
<tr>
<td>buf = require("notepack")().encode(obj);</td>
<td align="right">847800</td>
<td align="right">10000</td>
<td align="right">84780</td>
</tr>
<tr>
<td>obj = require("notepack")().decode(buf);</td>
<td align="right">599800</td>
<td align="right">10000</td>
<td align="right">59980</td>
</tr>
<tr>
<td>obj = require("msgpack-unpack").decode(buf);</td>
<td align="right">48100</td>
<td align="right">10002</td>
<td align="right">4809</td>
</tr>
</tbody>
</table>
<p dir="auto">Streaming benchmark tool <code>lib/benchmark-stream.js</code> is also available.
It counts milliseconds for 1,000,000 operations of 30 bytes fluentd msgpack fragment.
This shows streaming encoding and decoding are super faster.</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="$ npm run benchmark-stream 2"><pre>$ npm run benchmark-stream 2</pre></div>
<table>
<thead>
<tr>
<th>operation (1000000 x 2)</th>
<th align="right">op</th>
<th align="right">ms</th>
<th align="right">op/s</th>
</tr>
</thead>
<tbody>
<tr>
<td>stream.write(msgpack.encode(obj));</td>
<td align="right">1000000</td>
<td align="right">3027</td>
<td align="right">330360</td>
</tr>
<tr>
<td>stream.write(notepack.encode(obj));</td>
<td align="right">1000000</td>
<td align="right">2012</td>
<td align="right">497017</td>
</tr>
<tr>
<td>msgpack.Encoder().on("data",ondata).encode(obj);</td>
<td align="right">1000000</td>
<td align="right">2956</td>
<td align="right">338294</td>
</tr>
<tr>
<td>msgpack.createEncodeStream().write(obj);</td>
<td align="right">1000000</td>
<td align="right">1888</td>
<td align="right">529661</td>
</tr>
<tr>
<td>stream.write(msgpack.decode(buf));</td>
<td align="right">1000000</td>
<td align="right">2020</td>
<td align="right">495049</td>
</tr>
<tr>
<td>stream.write(notepack.decode(buf));</td>
<td align="right">1000000</td>
<td align="right">1794</td>
<td align="right">557413</td>
</tr>
<tr>
<td>msgpack.Decoder().on("data",ondata).decode(buf);</td>
<td align="right">1000000</td>
<td align="right">2744</td>
<td align="right">364431</td>
</tr>
<tr>
<td>msgpack.createDecodeStream().write(buf);</td>
<td align="right">1000000</td>
<td align="right">1341</td>
<td align="right">745712</td>
</tr>
</tbody>
</table>
<p dir="auto">Test environment: msgpack-lite 0.1.14, Node v4.2.3, Intel(R) Xeon(R) CPU E5-2666 v3 @ 2.90GHz</p>
<h7 dir="auto">
<a id="user-content-messagepack-mapping-table" class="anchor" aria-hidden="true" href="#messagepack-mapping-table"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack Mapping Table</h7>
<p dir="auto">The following table shows how JavaScript objects (value) will be mapped to
<a href="https://github.com/msgpack/msgpack/blob/master/spec.md">MessagePack formats</a>
and vice versa.</p>
<table>
<thead>
<tr>
<th>Source Value</th>
<th>MessagePack Format</th>
<th>Value Decoded</th>
</tr>
</thead>
<tbody>
<tr>
<td>null, undefined</td>
<td>nil format family</td>
<td>null</td>
</tr>
<tr>
<td>Boolean (true, false)</td>
<td>bool format family</td>
<td>Boolean (true, false)</td>
</tr>
<tr>
<td>Number (32bit int)</td>
<td>int format family</td>
<td>Number (int or double)</td>
</tr>
<tr>
<td>Number (64bit double)</td>
<td>float format family</td>
<td>Number (double)</td>
</tr>
<tr>
<td>String</td>
<td>str format family</td>
<td>String</td>
</tr>
<tr>
<td>Buffer</td>
<td>bin format family</td>
<td>Buffer</td>
</tr>
<tr>
<td>Array</td>
<td>array format family</td>
<td>Array</td>
</tr>
<tr>
<td>Map</td>
<td>map format family</td>
<td>Map (if <code>usemap=true</code>)</td>
</tr>
<tr>
<td>Object (plain object)</td>
<td>map format family</td>
<td>Object (or Map if <code>usemap=true</code>)</td>
</tr>
<tr>
<td>Object (see below)</td>
<td>ext format family</td>
<td>Object (see below)</td>
</tr>
</tbody>
</table>
<p dir="auto">Note that both <code>null</code> and <code>undefined</code> are mapped to nil <code>0xC1</code> type.
This means <code>undefined</code> value will be <em>upgraded</em> to <code>null</code> in other words.</p>
<h7 dir="auto">
<a id="user-content-extension-types" class="anchor" aria-hidden="true" href="#extension-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Extension Types</h7>
<p dir="auto">The MessagePack specification allows 128 application-specific extension types.
The library uses the following types to make round-trip conversion possible
for JavaScript native objects.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Object</th>
<th>Type</th>
<th>Object</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td></td>
<td>0x10</td>
<td></td>
</tr>
<tr>
<td>0x01</td>
<td>EvalError</td>
<td>0x11</td>
<td>Int8Array</td>
</tr>
<tr>
<td>0x02</td>
<td>RangeError</td>
<td>0x12</td>
<td>Uint8Array</td>
</tr>
<tr>
<td>0x03</td>
<td>ReferenceError</td>
<td>0x13</td>
<td>Int16Array</td>
</tr>
<tr>
<td>0x04</td>
<td>SyntaxError</td>
<td>0x14</td>
<td>Uint16Array</td>
</tr>
<tr>
<td>0x05</td>
<td>TypeError</td>
<td>0x15</td>
<td>Int32Array</td>
</tr>
<tr>
<td>0x06</td>
<td>URIError</td>
<td>0x16</td>
<td>Uint32Array</td>
</tr>
<tr>
<td>0x07</td>
<td></td>
<td>0x17</td>
<td>Float32Array</td>
</tr>
<tr>
<td>0x08</td>
<td></td>
<td>0x18</td>
<td>Float64Array</td>
</tr>
<tr>
<td>0x09</td>
<td></td>
<td>0x19</td>
<td>Uint8ClampedArray</td>
</tr>
<tr>
<td>0x0A</td>
<td>RegExp</td>
<td>0x1A</td>
<td>ArrayBuffer</td>
</tr>
<tr>
<td>0x0B</td>
<td>Boolean</td>
<td>0x1B</td>
<td>Buffer</td>
</tr>
<tr>
<td>0x0C</td>
<td>String</td>
<td>0x1C</td>
<td></td>
</tr>
<tr>
<td>0x0D</td>
<td>Date</td>
<td>0x1D</td>
<td>DataView</td>
</tr>
<tr>
<td>0x0E</td>
<td>Error</td>
<td>0x1E</td>
<td></td>
</tr>
<tr>
<td>0x0F</td>
<td>Number</td>
<td>0x1F</td>
<td></td>
</tr>
</tbody>
</table>
<p dir="auto">Other extension types are mapped to built-in ExtBuffer object.</p>
<h7 dir="auto">
<a id="user-content-custom-extension-types-codecs" class="anchor" aria-hidden="true" href="#custom-extension-types-codecs"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Custom Extension Types (Codecs)</h7>
<p dir="auto">Register a custom extension type number to serialize/deserialize your own class instances.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content='var msgpack = require("msgpack-lite");

var codec = msgpack.createCodec();
codec.addExtPacker(0x3F, MyVector, myVectorPacker);
codec.addExtUnpacker(0x3F, myVectorUnpacker);

var data = new MyVector(1, 2);
var encoded = msgpack.encode(data, {codec: codec});
var decoded = msgpack.decode(encoded, {codec: codec});

function MyVector(x, y) {
  this.x = x;
  this.y = y;
}

function myVectorPacker(vector) {
  var array = [vector.x, vector.y];
  return msgpack.encode(array); // return Buffer serialized
}

function myVectorUnpacker(buffer) {
  var array = msgpack.decode(buffer);
  return new MyVector(array[0], array[1]); // return Object deserialized
}'><pre><span class="pl-k">var</span> <span class="pl-s1">msgpack</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"msgpack-lite"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-s1">codec</span><span class="pl-kos">.</span><span class="pl-en">addExtPacker</span><span class="pl-kos">(</span><span class="pl-c1">0x3F</span><span class="pl-kos">,</span> <span class="pl-v">MyVector</span><span class="pl-kos">,</span> <span class="pl-s1">myVectorPacker</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-s1">codec</span><span class="pl-kos">.</span><span class="pl-en">addExtUnpacker</span><span class="pl-kos">(</span><span class="pl-c1">0x3F</span><span class="pl-kos">,</span> <span class="pl-s1">myVectorUnpacker</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">var</span> <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-v">MyVector</span><span class="pl-kos">(</span><span class="pl-c1">1</span><span class="pl-kos">,</span> <span class="pl-c1">2</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">encoded</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">,</span> <span class="pl-kos">{</span><span class="pl-c1">codec</span>: <span class="pl-s1">codec</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-k">var</span> <span class="pl-s1">decoded</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">encoded</span><span class="pl-kos">,</span> <span class="pl-kos">{</span><span class="pl-c1">codec</span>: <span class="pl-s1">codec</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-k">function</span> <span class="pl-v">MyVector</span><span class="pl-kos">(</span><span class="pl-s1">x</span><span class="pl-kos">,</span> <span class="pl-s1">y</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">x</span> <span class="pl-c1">=</span> <span class="pl-s1">x</span><span class="pl-kos">;</span>
  <span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">y</span> <span class="pl-c1">=</span> <span class="pl-s1">y</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span>

<span class="pl-k">function</span> <span class="pl-en">myVectorPacker</span><span class="pl-kos">(</span><span class="pl-s1">vector</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-k">var</span> <span class="pl-s1">array</span> <span class="pl-c1">=</span> <span class="pl-kos">[</span><span class="pl-s1">vector</span><span class="pl-kos">.</span><span class="pl-c1">x</span><span class="pl-kos">,</span> <span class="pl-s1">vector</span><span class="pl-kos">.</span><span class="pl-c1">y</span><span class="pl-kos">]</span><span class="pl-kos">;</span>
  <span class="pl-k">return</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s1">array</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// return Buffer serialized</span>
<span class="pl-kos">}</span>

<span class="pl-k">function</span> <span class="pl-en">myVectorUnpacker</span><span class="pl-kos">(</span><span class="pl-s1">buffer</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-k">var</span> <span class="pl-s1">array</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-s1">buffer</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-v">MyVector</span><span class="pl-kos">(</span><span class="pl-s1">array</span><span class="pl-kos">[</span><span class="pl-c1">0</span><span class="pl-kos">]</span><span class="pl-kos">,</span> <span class="pl-s1">array</span><span class="pl-kos">[</span><span class="pl-c1">1</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// return Object deserialized</span>
<span class="pl-kos">}</span></pre></div>
<p dir="auto">The first argument of <code>addExtPacker</code> and <code>addExtUnpacker</code> should be an integer within the range of 0 and 127 (0x0 and 0x7F). <code>myClassPacker</code> is a function that accepts an instance of <code>MyClass</code>, and should return a buffer representing that instance. <code>myClassUnpacker</code> is the opposite: it accepts a buffer and should return an instance of <code>MyClass</code>.</p>
<p dir="auto">If you pass an array of functions to <code>addExtPacker</code> or <code>addExtUnpacker</code>, the value to be encoded/decoded will pass through each one in order. This allows you to do things like this:</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="codec.addExtPacker(0x00, Date, [Number, msgpack.encode]);"><pre><span class="pl-s1">codec</span><span class="pl-kos">.</span><span class="pl-en">addExtPacker</span><span class="pl-kos">(</span><span class="pl-c1">0x00</span><span class="pl-kos">,</span> <span class="pl-v">Date</span><span class="pl-kos">,</span> <span class="pl-kos">[</span><span class="pl-v">Number</span><span class="pl-kos">,</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-c1">encode</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto">You can also pass the <code>codec</code> option to <code>msgpack.Decoder(options)</code>, <code>msgpack.Encoder(options)</code>, <code>msgpack.createEncodeStream(options)</code>, and <code>msgpack.createDecodeStream(options)</code>.</p>
<p dir="auto">If you wish to modify the default built-in codec, you can access it at <code>msgpack.codec.preset</code>.</p>
<h7 dir="auto">
<a id="user-content-custom-codec-options" class="anchor" aria-hidden="true" href="#custom-codec-options"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Custom Codec Options</h7>
<p dir="auto"><code>msgpack.createCodec()</code> function accepts some options.</p>
<p dir="auto">It does NOT have the preset extension types defined when no options given.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec();"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><code>preset</code>: It has the preset extension types described above.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec({preset: true});"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">preset</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><code>safe</code>: It runs a validation of the value before writing it into buffer. This is the default behavior for some old browsers which do not support <code>ArrayBuffer</code> object.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec({safe: true});"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">safe</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><code>useraw</code>: It uses <code>raw</code> formats instead of <code>bin</code> and <code>str</code>.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec({useraw: true});"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">useraw</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><code>int64</code>: It decodes msgpack's <code>int64</code>/<code>uint64</code> formats with <a href="https://github.com/kawanet/int64-buffer">int64-buffer</a> object.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec({int64: true});"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">int64</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><code>binarraybuffer</code>: It ties msgpack's <code>bin</code> format with <code>ArrayBuffer</code> object, instead of <code>Buffer</code> object.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec({binarraybuffer: true, preset: true});"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">binarraybuffer</span>: <span class="pl-c1">true</span><span class="pl-kos">,</span> <span class="pl-c1">preset</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><code>uint8array</code>: It returns Uint8Array object when encoding, instead of <code>Buffer</code> object.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec({uint8array: true});"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">uint8array</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><code>usemap</code>: Uses the global JavaScript Map type, if available, to unpack
MessagePack map elements.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var codec = msgpack.createCodec({usemap: true});"><pre><span class="pl-k">var</span> <span class="pl-s1">codec</span> <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">usemap</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h7 dir="auto">
<a id="user-content-compatibility-mode" class="anchor" aria-hidden="true" href="#compatibility-mode"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Compatibility Mode</h7>
<p dir="auto">The <a href="https://github.com/kawanet/msgpack-lite/issues/22" data-hovercard-type="issue" data-hovercard-url="/kawanet/msgpack-lite/issues/22/hovercard">compatibility mode</a> respects for <a href="https://github.com/msgpack/msgpack/blob/master/spec-old.md">msgpack's old spec</a>. Set <code>true</code> to <code>useraw</code>.</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="// default mode handles both str and bin formats individually
msgpack.encode(&quot;Aa&quot;); // =&gt; &lt;Buffer a2 41 61&gt; (str format)
msgpack.encode(new Buffer([0x41, 0x61])); // =&gt; &lt;Buffer c4 02 41 61&gt; (bin format)

msgpack.decode(new Buffer([0xa2, 0x41, 0x61])); // =&gt; 'Aa' (String)
msgpack.decode(new Buffer([0xc4, 0x02, 0x41, 0x61])); // =&gt; &lt;Buffer 41 61&gt; (Buffer)

// compatibility mode handles only raw format both for String and Buffer
var options = {codec: msgpack.createCodec({useraw: true})};
msgpack.encode(&quot;Aa&quot;, options); // =&gt; &lt;Buffer a2 41 61&gt; (raw format)
msgpack.encode(new Buffer([0x41, 0x61]), options); // =&gt; &lt;Buffer a2 41 61&gt; (raw format)

msgpack.decode(new Buffer([0xa2, 0x41, 0x61]), options); // =&gt; &lt;Buffer 41 61&gt; (Buffer)
msgpack.decode(new Buffer([0xa2, 0x41, 0x61]), options).toString(); // =&gt; 'Aa' (String)"><pre><span class="pl-c">// default mode handles both str and bin formats individually</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s">"Aa"</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; &lt;Buffer a2 41 61&gt; (str format)</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0x41</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; &lt;Buffer c4 02 41 61&gt; (bin format)</span>

<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0xa2</span><span class="pl-kos">,</span> <span class="pl-c1">0x41</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; 'Aa' (String)</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0xc4</span><span class="pl-kos">,</span> <span class="pl-c1">0x02</span><span class="pl-kos">,</span> <span class="pl-c1">0x41</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; &lt;Buffer 41 61&gt; (Buffer)</span>

<span class="pl-c">// compatibility mode handles only raw format both for String and Buffer</span>
<span class="pl-k">var</span> <span class="pl-s1">options</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span><span class="pl-c1">codec</span>: <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">createCodec</span><span class="pl-kos">(</span><span class="pl-kos">{</span><span class="pl-c1">useraw</span>: <span class="pl-c1">true</span><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">}</span><span class="pl-kos">;</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-s">"Aa"</span><span class="pl-kos">,</span> <span class="pl-s1">options</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; &lt;Buffer a2 41 61&gt; (raw format)</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">encode</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0x41</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-s1">options</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; &lt;Buffer a2 41 61&gt; (raw format)</span>

<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0xa2</span><span class="pl-kos">,</span> <span class="pl-c1">0x41</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-s1">options</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; &lt;Buffer 41 61&gt; (Buffer)</span>
<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">decode</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-kos">[</span><span class="pl-c1">0xa2</span><span class="pl-kos">,</span> <span class="pl-c1">0x41</span><span class="pl-kos">,</span> <span class="pl-c1">0x61</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-s1">options</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">toString</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// =&gt; 'Aa' (String)</span></pre></div>
<h7 dir="auto">
<a id="user-content-repository" class="anchor" aria-hidden="true" href="#repository"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Repository</h7>
<ul dir="auto">
<li><a href="https://github.com/kawanet/msgpack-lite">https://github.com/kawanet/msgpack-lite</a></li>
</ul>
<h7 dir="auto">
<a id="user-content-see-also" class="anchor" aria-hidden="true" href="#see-also"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>See Also</h7>
<ul dir="auto">
<li><a href="http://msgpack.org/" rel="nofollow">http://msgpack.org/</a></li>
</ul>
<h7 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h7>
<p dir="auto">The MIT License (MIT)</p>
<p dir="auto">Copyright (c) 2015-2016 Yusuke Kawasaki</p>
<p dir="auto">Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p dir="auto">The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p dir="auto">THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
</article>
  </div>
        </div>
        
        <div id="qs-markstinson-lua-MessagePack" class="qs"><h4><a href="http://fperrad.github.io/lua-MessagePack/" target="_blank">markstinson/lua-MessagePack <span class="qs-url">http://fperrad.github.io/lua-MessagePack/</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-lua-messagepack--a-pure-lua-implementation-spec-v5" class="anchor" aria-hidden="true" href="#lua-messagepack--a-pure-lua-implementation-spec-v5"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>lua-MessagePack : a pure Lua implementation (spec v5)</h5>
<p dir="auto"><a href="https://travis-ci.org/fperrad/lua-MessagePack" rel="nofollow"><img src="https://camo.githubusercontent.com/00a83c9f44341e1044f7609642fa4e57b74ad44235bfb158c0135ab7d1e87cb9/68747470733a2f2f7472617669732d63692e6f72672f667065727261642f6c75612d4d6573736167655061636b2e706e67" alt="Build Status" data-canonical-src="https://travis-ci.org/fperrad/lua-MessagePack.png" style="max-width: 100%;"></a></p>
<h6 dir="auto">
<a id="user-content-introduction" class="anchor" aria-hidden="true" href="#introduction"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Introduction</h6>
<p dir="auto"><a href="http://msgpack.org/" rel="nofollow">MessagePack</a> is an efficient binary serialization format.</p>
<p dir="auto">It lets you exchange data among multiple languages like JSON but it's faster and smaller.</p>
<p dir="auto">It's a pure Lua implementation, without dependency.</p>
<p dir="auto">And it's really fast with <a href="http://luajit.org" rel="nofollow">LuaJIT</a>.</p>
<h6 dir="auto">
<a id="user-content-links" class="anchor" aria-hidden="true" href="#links"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Links</h6>
<p dir="auto">The homepage is at <a href="http://fperrad.github.io/lua-MessagePack/" rel="nofollow">http://fperrad.github.io/lua-MessagePack/</a>,
and the sources are hosted at <a href="http://github.com/fperrad/lua-MessagePack/">http://github.com/fperrad/lua-MessagePack/</a>.</p>
<h6 dir="auto">
<a id="user-content-copyright-and-license" class="anchor" aria-hidden="true" href="#copyright-and-license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Copyright and License</h6>
<p dir="auto">Copyright (c) 2012-2013 Francois Perrad</p>
<p dir="auto">This library is licensed under the terms of the MIT/X11 license, like Lua itself.</p>
</article>
  </div>
        </div>
        
        <div id="qs-mcollina-msgpack5" class="qs"><h4><a href="https://github.com/mcollina/msgpack5" target="_blank">mcollina/msgpack5 <span class="qs-url">https://github.com/mcollina/msgpack5</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-msgpack5" class="anchor" aria-hidden="true" href="#msgpack5"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>msgpack5  <a href="https://github.com/mcollina/msgpack5/actions?query=workflow%3ACI"><img src="https://github.com/mcollina/msgpack5/workflows/CI/badge.svg" alt="CI" style="max-width: 100%;"></a>
</h5>
<p dir="auto">A msgpack v5 implementation for node.js and the browser, with extension point support.</p>
<h6 dir="auto">
<a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install</h6>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="npm install msgpack5 --save"><pre>npm install msgpack5 --save</pre></div>
<h6 dir="auto">
<a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h6>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var msgpack = require('msgpack5')() // namespace our extensions
  , a       = new MyType(2, 'a')
  , encode  = msgpack.encode
  , decode  = msgpack.decode

msgpack.register(0x42, MyType, mytipeEncode, mytipeDecode)

console.log(encode({ 'hello': 'world' }).toString('hex'))
// 81a568656c6c6fa5776f726c64
console.log(decode(encode({ 'hello': 'world' })))
// { hello: 'world' }
console.log(encode(a).toString('hex'))
// d5426161
console.log(decode(encode(a)) instanceof MyType)
// true
console.log(decode(encode(a)))
// { value: 'a', size: 2 }

function MyType(size, value) {
  this.value = value
  this.size  = size
}

function mytipeEncode(obj) {
  var buf = new Buffer(obj.size)
  buf.fill(obj.value)
  return buf
}

function mytipeDecode(data) {
  var result = new MyType(data.length, data.toString('utf8', 0, 1))
    , i

  for (i = 0; i &lt; data.length; i++) {
    if (data.readUInt8(0) != data.readUInt8(i)) {
      throw new Error('should all be the same')
    }
  }

  return result
}"><pre><span class="pl-k">var</span> <span class="pl-s1">msgpack</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'msgpack5'</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c">// namespace our extensions</span>
  <span class="pl-kos">,</span> <span class="pl-s1">a</span>       <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-v">MyType</span><span class="pl-kos">(</span><span class="pl-c1">2</span><span class="pl-kos">,</span> <span class="pl-s">'a'</span><span class="pl-kos">)</span>
  <span class="pl-kos">,</span> <span class="pl-s1">encode</span>  <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-c1">encode</span>
  <span class="pl-kos">,</span> <span class="pl-s1">decode</span>  <span class="pl-c1">=</span> <span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-c1">decode</span>

<span class="pl-s1">msgpack</span><span class="pl-kos">.</span><span class="pl-en">register</span><span class="pl-kos">(</span><span class="pl-c1">0x42</span><span class="pl-kos">,</span> <span class="pl-v">MyType</span><span class="pl-kos">,</span> <span class="pl-s1">mytipeEncode</span><span class="pl-kos">,</span> <span class="pl-s1">mytipeDecode</span><span class="pl-kos">)</span>

<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-s">'hello'</span>: <span class="pl-s">'world'</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">toString</span><span class="pl-kos">(</span><span class="pl-s">'hex'</span><span class="pl-kos">)</span><span class="pl-kos">)</span>
<span class="pl-c">// 81a568656c6c6fa5776f726c64</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">decode</span><span class="pl-kos">(</span><span class="pl-s1">encode</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-s">'hello'</span>: <span class="pl-s">'world'</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">)</span>
<span class="pl-c">// { hello: 'world' }</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">encode</span><span class="pl-kos">(</span><span class="pl-s1">a</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">toString</span><span class="pl-kos">(</span><span class="pl-s">'hex'</span><span class="pl-kos">)</span><span class="pl-kos">)</span>
<span class="pl-c">// d5426161</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">decode</span><span class="pl-kos">(</span><span class="pl-s1">encode</span><span class="pl-kos">(</span><span class="pl-s1">a</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-k">instanceof</span> <span class="pl-v">MyType</span><span class="pl-kos">)</span>
<span class="pl-c">// true</span>
<span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">decode</span><span class="pl-kos">(</span><span class="pl-s1">encode</span><span class="pl-kos">(</span><span class="pl-s1">a</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">)</span>
<span class="pl-c">// { value: 'a', size: 2 }</span>

<span class="pl-k">function</span> <span class="pl-v">MyType</span><span class="pl-kos">(</span><span class="pl-s1">size</span><span class="pl-kos">,</span> <span class="pl-s1">value</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">value</span> <span class="pl-c1">=</span> <span class="pl-s1">value</span>
  <span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">size</span>  <span class="pl-c1">=</span> <span class="pl-s1">size</span>
<span class="pl-kos">}</span>

<span class="pl-k">function</span> <span class="pl-en">mytipeEncode</span><span class="pl-kos">(</span><span class="pl-s1">obj</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-k">var</span> <span class="pl-s1">buf</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-v">Buffer</span><span class="pl-kos">(</span><span class="pl-s1">obj</span><span class="pl-kos">.</span><span class="pl-c1">size</span><span class="pl-kos">)</span>
  <span class="pl-s1">buf</span><span class="pl-kos">.</span><span class="pl-en">fill</span><span class="pl-kos">(</span><span class="pl-s1">obj</span><span class="pl-kos">.</span><span class="pl-c1">value</span><span class="pl-kos">)</span>
  <span class="pl-k">return</span> <span class="pl-s1">buf</span>
<span class="pl-kos">}</span>

<span class="pl-k">function</span> <span class="pl-en">mytipeDecode</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-k">var</span> <span class="pl-s1">result</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-v">MyType</span><span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">.</span><span class="pl-c1">length</span><span class="pl-kos">,</span> <span class="pl-s1">data</span><span class="pl-kos">.</span><span class="pl-en">toString</span><span class="pl-kos">(</span><span class="pl-s">'utf8'</span><span class="pl-kos">,</span> <span class="pl-c1">0</span><span class="pl-kos">,</span> <span class="pl-c1">1</span><span class="pl-kos">)</span><span class="pl-kos">)</span>
    <span class="pl-kos">,</span> <span class="pl-s1">i</span>

  <span class="pl-k">for</span> <span class="pl-kos">(</span><span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span><span class="pl-kos">;</span> <span class="pl-s1">i</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">data</span><span class="pl-kos">.</span><span class="pl-c1">length</span><span class="pl-kos">;</span> <span class="pl-s1">i</span><span class="pl-c1">++</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">data</span><span class="pl-kos">.</span><span class="pl-en">readUInt8</span><span class="pl-kos">(</span><span class="pl-c1">0</span><span class="pl-kos">)</span> <span class="pl-c1">!=</span> <span class="pl-s1">data</span><span class="pl-kos">.</span><span class="pl-en">readUInt8</span><span class="pl-kos">(</span><span class="pl-s1">i</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-v">Error</span><span class="pl-kos">(</span><span class="pl-s">'should all be the same'</span><span class="pl-kos">)</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span>

  <span class="pl-k">return</span> <span class="pl-s1">result</span>
<span class="pl-kos">}</span></pre></div>
<h6 dir="auto">
<a id="user-content-in-the-browser" class="anchor" aria-hidden="true" href="#in-the-browser"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>In the Browser</h6>
<p dir="auto">This library is compatible with <a href="http://npm.im/browserify" rel="nofollow">Browserify</a>.</p>
<p dir="auto">If you want to use standalone, grab the file in the <code>dist</code> folder of
this repo, and use in your own HTML page, the module will expose a
<code>msgpack5</code> global.</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='&lt;script type="text/javascript"
        src="./msgpack5.min.js"&gt;
&lt;/script&gt;'><pre><code>&lt;script type="text/javascript"
        src="./msgpack5.min.js"&gt;
&lt;/script&gt;
</code></pre></div>
<h7 dir="auto">
<a id="user-content-to-build" class="anchor" aria-hidden="true" href="#to-build"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>To build</h7>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="	npm run build"><pre><code>	npm run build
</code></pre></div>
<h6 dir="auto">
<a id="user-content-api" class="anchor" aria-hidden="true" href="#api"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>API</h6>
<p dir="auto"><a name="user-content-api"></a></p>
<h6 dir="auto">
<a id="user-content-api-1" class="anchor" aria-hidden="true" href="#api-1"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>API</h6>
<ul dir="auto">
<li><a href="#msgpack"><code><b>msgpack()</b></code></a></li>
<li><a href="#encode"><code>msgpack().<b>encode()</b></code></a></li>
<li><a href="#decode"><code>msgpack().<b>decode()</b></code></a></li>
<li><a href="#registerEncoder"><code>msgpack().<b>registerEncoder()</b></code></a></li>
<li><a href="#registerDecoder"><code>msgpack().<b>registerDecoder()</b></code></a></li>
<li><a href="#register"><code>msgpack().<b>register()</b></code></a></li>
<li><a href="#encoder"><code>msgpack().<b>encoder()</b></code></a></li>
<li><a href="#decoder"><code>msgpack().<b>decoder()</b></code></a></li>
</ul>
<hr>
<p dir="auto"><a name="user-content-msgpack"></a></p>
<h7 dir="auto">
<a id="user-content-msgpackoptionsobj" class="anchor" aria-hidden="true" href="#msgpackoptionsobj"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>msgpack(options(obj))</h7>
<p dir="auto">Creates a new instance on which you can register new types for being
encoded.</p>
<p dir="auto">options:</p>
<ul dir="auto">
<li>
<code>forceFloat64</code>, a boolean to that forces all floats to be encoded as 64-bits floats. Defaults to false.</li>
<li>
<code>sortKeys</code>, a boolean to force a determinate keys order</li>
<li>
<code>compatibilityMode</code>, a boolean that enables "compatibility mode" which doesn't use str 8 format. Defaults to false.</li>
<li>
<code>disableTimestampEncoding</code>, a boolean that when set disables the encoding of Dates into the <a href="https://github.com/msgpack/msgpack/blob/master/spec.md#timestamp-extension-type">timestamp extension type</a>. Defaults to false.</li>
<li>
<code>preferMap</code>, a boolean that forces all maps to be decoded to <code>Map</code>s rather than plain objects. This ensures that <code>decode(encode(new Map())) instanceof Map</code> and that iteration order is preserved. Defaults to false.</li>
<li>
<code>protoAction</code>, a string which can be <code>error|ignore|remove</code> that determines what happens when decoding a plain object with a <code>__proto__</code> property which would cause prototype poisoning. <code>error</code> (default) throws an error, <code>remove</code> removes the property, <code>ignore</code> (not recommended) allows the property, thereby causing prototype poisoning on the decoded object.</li>
</ul>
<hr>
<p dir="auto"><a name="user-content-encode"></a></p>
<h7 dir="auto">
<a id="user-content-encodeobject" class="anchor" aria-hidden="true" href="#encodeobject"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>encode(object)</h7>
<p dir="auto">Encodes <code>object</code> in msgpack, returns a <a href="http://npm.im/bl" rel="nofollow">bl</a>.</p>
<hr>
<p dir="auto"><a name="user-content-decode"></a></p>
<h7 dir="auto">
<a id="user-content-decodebuf" class="anchor" aria-hidden="true" href="#decodebuf"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>decode(buf)</h7>
<p dir="auto">Decodes buf from in msgpack. <code>buf</code> can be a <code>Buffer</code> or a <a href="http://npm.im/bl" rel="nofollow">bl</a> instance.</p>
<p dir="auto">In order to support a stream interface, a user must pass in a <a href="http://npm.im/bl" rel="nofollow">bl</a> instance.</p>
<hr>
<p dir="auto"><a name="user-content-registerencoder"></a></p>
<h7 dir="auto">
<a id="user-content-registerencodercheckobj-encodeobj" class="anchor" aria-hidden="true" href="#registerencodercheckobj-encodeobj"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>registerEncoder(check(obj), encode(obj))</h7>
<p dir="auto">Register a new custom object type for being automatically encoded.
The arguments are:</p>
<ul dir="auto">
<li>
<code>check</code>, a function that will be called to check if the passed
object should be encoded with the <code>encode</code> function</li>
<li>
<code>encode</code>, a function that will be called to encode an object in binary
form; this function <strong>must</strong> return a <code>Buffer</code> which include the same type
for <a href="#registerDecoder">registerDecoder</a>.</li>
</ul>
<hr>
<p dir="auto"><a name="user-content-registerdecoder"></a></p>
<h7 dir="auto">
<a id="user-content-registerdecodertype-decodebuf" class="anchor" aria-hidden="true" href="#registerdecodertype-decodebuf"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>registerDecoder(type, decode(buf))</h7>
<p dir="auto">Register a new custom object type for being automatically decoded.
The arguments are:</p>
<ul dir="auto">
<li>
<code>type</code>, is a greater than zero integer identificating the type once serialized</li>
<li>
<code>decode</code>, a function that will be called to decode the object from
the passed <code>Buffer</code>
</li>
</ul>
<hr>
<p dir="auto"><a name="user-content-register"></a></p>
<h7 dir="auto">
<a id="user-content-registertype-constructor-encodeobj-decodebuf" class="anchor" aria-hidden="true" href="#registertype-constructor-encodeobj-decodebuf"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>register(type, constructor, encode(obj), decode(buf))</h7>
<p dir="auto">Register a new custom object type for being automatically encoded and
decoded. The arguments are:</p>
<ul dir="auto">
<li>
<code>type</code>, is a greater than zero integer identificating the type once serialized</li>
<li>
<code>constructor</code>, the function that will be used to match the objects
with <code>instanceof</code>
</li>
<li>
<code>encode</code>, a function that will be called to encode an object in binary
form; this function <strong>must</strong> return a <code>Buffer</code> that can be
deserialized by the <code>decode</code> function</li>
<li>
<code>decode</code>, a function that will be called to decode the object from
the passed <code>Buffer</code>
</li>
</ul>
<p dir="auto">This is just a commodity that calls
<a href="#registerEncoder"><code>registerEncoder</code></a> and
<a href="#registerDecoder"><code>registerDecoder</code></a> internally.</p>
<hr>
<p dir="auto"><a name="user-content-encoder"></a></p>
<h7 dir="auto">
<a id="user-content-encoderoptions" class="anchor" aria-hidden="true" href="#encoderoptions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>encoder(options)</h7>
<p dir="auto">Builds a stream in object mode that encodes msgpack.</p>
<p dir="auto">Supported options:</p>
<ul dir="auto">
<li>
<code>wrap</code>, objects should be passed to encoder in wrapped object {value: data}. Wrap option should be used if you need to pass null to encoder.</li>
</ul>
<hr>
<p dir="auto"><a name="user-content-decoder"></a></p>
<h7 dir="auto">
<a id="user-content-decoderoptions" class="anchor" aria-hidden="true" href="#decoderoptions"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>decoder(options)</h7>
<p dir="auto">Builds a stream in object mode that decodes msgpack.</p>
<p dir="auto">Supported options:</p>
<ul dir="auto">
<li>
<code>wrap</code>, decoded objects returned in wrapped object {value: data}. Wrap option should be used if stream contains msgpack nil.</li>
</ul>
<h6 dir="auto">
<a id="user-content-levelup-support" class="anchor" aria-hidden="true" href="#levelup-support"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>LevelUp Support</h6>
<p dir="auto"><strong>msgpack5</strong> can be used as a LevelUp
<a href="https://github.com/rvagg/node-levelup#leveluplocation-options-callback"><code>valueEncoding</code></a> straight away:</p>
<div class="highlight highlight-source-js position-relative overflow-auto" data-snippet-clipboard-copy-content="var level = require('level')
  , pack  = msgpack()
  , db    = level('foo', {
      valueEncoding: pack
    })
  , obj   = { my: 'obj' }

db.put('hello', obj, function(err) {
  db.get('hello', function(err, result) {
    console.log(result)
    db.close()
  })
})
"><pre><span class="pl-k">var</span> <span class="pl-s1">level</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'level'</span><span class="pl-kos">)</span>
  <span class="pl-kos">,</span> <span class="pl-s1">pack</span>  <span class="pl-c1">=</span> <span class="pl-en">msgpack</span><span class="pl-kos">(</span><span class="pl-kos">)</span>
  <span class="pl-kos">,</span> <span class="pl-s1">db</span>    <span class="pl-c1">=</span> <span class="pl-s1">level</span><span class="pl-kos">(</span><span class="pl-s">'foo'</span><span class="pl-kos">,</span> <span class="pl-kos">{</span>
      <span class="pl-c1">valueEncoding</span>: <span class="pl-s1">pack</span>
    <span class="pl-kos">}</span><span class="pl-kos">)</span>
  <span class="pl-kos">,</span> <span class="pl-s1">obj</span>   <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-c1">my</span>: <span class="pl-s">'obj'</span> <span class="pl-kos">}</span>

<span class="pl-s1">db</span><span class="pl-kos">.</span><span class="pl-en">put</span><span class="pl-kos">(</span><span class="pl-s">'hello'</span><span class="pl-kos">,</span> <span class="pl-s1">obj</span><span class="pl-kos">,</span> <span class="pl-k">function</span><span class="pl-kos">(</span><span class="pl-s1">err</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-s1">db</span><span class="pl-kos">.</span><span class="pl-en">get</span><span class="pl-kos">(</span><span class="pl-s">'hello'</span><span class="pl-kos">,</span> <span class="pl-k">function</span><span class="pl-kos">(</span><span class="pl-s1">err</span><span class="pl-kos">,</span> <span class="pl-s1">result</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s1">result</span><span class="pl-kos">)</span>
    <span class="pl-s1">db</span><span class="pl-kos">.</span><span class="pl-en">close</span><span class="pl-kos">(</span><span class="pl-kos">)</span>
  <span class="pl-kos">}</span><span class="pl-kos">)</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span></pre></div>
<h6 dir="auto">
<a id="user-content-related-projects" class="anchor" aria-hidden="true" href="#related-projects"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Related projects</h6>
<ul dir="auto">
<li>
<a href="http://npmjs.com/package/msgpack5rpc" rel="nofollow">msgpack5rpc</a>: An implementation of the
<a href="https://github.com/msgpack-rpc/msgpack-rpc/blob/master/spec.md">msgpack-rpc spec</a>
on top of this library.</li>
</ul>
<h6 dir="auto">
<a id="user-content-disclaimer" class="anchor" aria-hidden="true" href="#disclaimer"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Disclaimer</h6>
<p dir="auto">This library is built fully on JS and on <a href="http://npm.im/bl" rel="nofollow">bl</a> to
simplify the code. Every improvement that keeps the same API is welcome.</p>
<h6 dir="auto">
<a id="user-content-acknowledgements" class="anchor" aria-hidden="true" href="#acknowledgements"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Acknowledgements</h6>
<p dir="auto">This project was kindly sponsored by <a href="http://nearform.com" rel="nofollow">nearForm</a>.</p>
<p dir="auto">This library was originally built as the data format for
<a href="http://npm.im/jschan" rel="nofollow">JSChan</a>.</p>
<h6 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h6>
<p dir="auto">MIT</p>
</article>
  </div>
        </div>
        
        <div id="qs-gabriel-MPMessagePack" class="qs"><h4><a href="https://github.com/gabriel/MPMessagePack" target="_blank">gabriel/MPMessagePack <span class="qs-url">https://github.com/gabriel/MPMessagePack</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install</h5>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='pod "MPMessagePack"'><pre><code>pod "MPMessagePack"
</code></pre></div>
<h6 dir="auto">
<a id="user-content-writing" class="anchor" aria-hidden="true" href="#writing"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Writing</h6>
<div class="highlight highlight-source-objc position-relative overflow-auto" data-snippet-clipboard-copy-content='#import &lt;MPMessagePack/MPMessagePack.h&gt;

NSDictionary *dict =
@{
@"n": @(32134123),
@"bool": @(YES),
@"array": @[@(1.1f), @(2.1)],
@"body": [NSData data],
};

NSData *data = [dict mp_messagePack];'><pre>#<span class="pl-k">import</span> <span class="pl-s"><span class="pl-pds">&lt;</span>MPMessagePack/MPMessagePack.h<span class="pl-pds">&gt;</span></span>

<span class="pl-c1">NSDictionary</span> *dict =
@{
<span class="pl-s"><span class="pl-pds">@"</span>n<span class="pl-pds">"</span></span>: @(<span class="pl-c1">32134123</span>),
<span class="pl-s"><span class="pl-pds">@"</span>bool<span class="pl-pds">"</span></span>: @(<span class="pl-c1">YES</span>),
<span class="pl-s"><span class="pl-pds">@"</span>array<span class="pl-pds">"</span></span>: @[@(<span class="pl-c1">1</span>.<span class="pl-c1">1f</span>), @(<span class="pl-c1">2.1</span>)],
<span class="pl-s"><span class="pl-pds">@"</span>body<span class="pl-pds">"</span></span>: [<span class="pl-c1">NSData</span> <span class="pl-c1">data</span>],
};

<span class="pl-c1">NSData</span> *data = [dict <span class="pl-c1">mp_messagePack</span>];</pre></div>
<p dir="auto">Or via <code>MPMessagePackWriter</code>.</p>
<div class="highlight highlight-source-objc position-relative overflow-auto" data-snippet-clipboard-copy-content="NSError *error = nil;
NSData *data = [MPMessagePackWriter writeObject:dict error:&amp;error];"><pre><span class="pl-c1">NSError</span> *error = <span class="pl-c1">nil</span>;
<span class="pl-c1">NSData</span> *data = [MPMessagePackWriter <span class="pl-c1">writeObject:</span>dict <span class="pl-c1">error:</span>&amp;error];</pre></div>
<p dir="auto">If you need to use an ordered dictionary.</p>
<div class="highlight highlight-source-objc position-relative overflow-auto" data-snippet-clipboard-copy-content='MPOrderedDictionary *dict = [[MPOrderedDictionary alloc] init];
[dict addEntriesFromDictionary:@{@"c": @(1), @"b": @(2), @"a": @(3)}];
[dict sortKeysUsingSelector:@selector(localizedCaseInsensitiveCompare:)];
[dict mp_messagePack];'><pre>MPOrderedDictionary *dict = [[MPOrderedDictionary <span class="pl-c1">alloc</span>] <span class="pl-c1">init</span>];
[dict <span class="pl-c1">addEntriesFromDictionary:</span>@{<span class="pl-s"><span class="pl-pds">@"</span>c<span class="pl-pds">"</span></span>: @(<span class="pl-c1">1</span>), <span class="pl-s"><span class="pl-pds">@"</span>b<span class="pl-pds">"</span></span>: @(<span class="pl-c1">2</span>), <span class="pl-s"><span class="pl-pds">@"</span>a<span class="pl-pds">"</span></span>: @(<span class="pl-c1">3</span>)}];
[dict <span class="pl-c1">sortKeysUsingSelector:</span><span class="pl-k">@selector</span>(<span class="pl-c1">localizedCaseInsensitiveCompare:</span>)];
[dict <span class="pl-c1">mp_messagePack</span>];</pre></div>
<h6 dir="auto">
<a id="user-content-reading" class="anchor" aria-hidden="true" href="#reading"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Reading</h6>
<div class="highlight highlight-source-objc position-relative overflow-auto" data-snippet-clipboard-copy-content="id obj = [MPMessagePackReader readData:data error:&amp;error];"><pre><span class="pl-c1">id</span> obj = [MPMessagePackReader <span class="pl-c1">readData:</span>data <span class="pl-c1">error:</span>&amp;error];</pre></div>
<div class="highlight highlight-source-objc position-relative overflow-auto" data-snippet-clipboard-copy-content="MPMessagePackReader *reader = [[MPMessagePackReader alloc] initWithData:data];
id obj1 = [reader read:&amp;error]; // Read an object
id obj2 = [reader read:&amp;error]; // Read another object"><pre>MPMessagePackReader *reader = [[MPMessagePackReader <span class="pl-c1">alloc</span>] <span class="pl-c1">initWithData:</span>data];
<span class="pl-c1">id</span> obj1 = [reader <span class="pl-c1">read</span>:&amp;error]; <span class="pl-c"><span class="pl-c">//</span> Read an object</span>
<span class="pl-c1">id</span> obj2 = [reader <span class="pl-c1">read</span>:&amp;error]; <span class="pl-c"><span class="pl-c">//</span> Read another object</span></pre></div>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-php" class="qs"><h4><a href="https://github.com/msgpack/msgpack-php" target="_blank">msgpack/msgpack-php <span class="qs-url">https://github.com/msgpack/msgpack-php</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-msgpack-for-php" class="anchor" aria-hidden="true" href="#msgpack-for-php"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Msgpack for PHP</h5>
<p dir="auto"><a href="https://github.com/msgpack/msgpack-php/actions?query=workflow%3Aci+branch%3Amaster"><img src="https://github.com/msgpack/msgpack-php/workflows/ci/badge.svg?branch=master" alt="Build Status" style="max-width: 100%;"></a></p>
<p dir="auto">This extension provides an API for communicating with MessagePack serialization.</p>
<p dir="auto">MessagePack is a binary-based efficient object serialization library.
It enables to exchange structured objects between many languages just like JSON.
But unlike JSON, it is very fast and small.</p>
<h6 dir="auto">
<a id="user-content-requirement" class="anchor" aria-hidden="true" href="#requirement"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Requirement</h6>
<ul dir="auto">
<li>PHP 7.0 +</li>
</ul>
<h6 dir="auto">
<a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install</h6>
<h7 dir="auto">
<a id="user-content-install-from-pecl" class="anchor" aria-hidden="true" href="#install-from-pecl"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install from PECL</h7>
<p dir="auto">Msgpack is an PECL extension, thus you can simply install it by:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="pecl install msgpack"><pre>pecl install msgpack</pre></div>
<h7 dir="auto">
<a id="user-content-compile-msgpack-from-source" class="anchor" aria-hidden="true" href="#compile-msgpack-from-source"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Compile Msgpack from source</h7>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="/path/to/phpize
./configure --with-php-config=/path/to/php-config
make &amp;&amp; make install"><pre>/path/to/phpize
./configure --with-php-config=/path/to/php-config
make <span class="pl-k">&amp;&amp;</span> make install</pre></div>
<h7 dir="auto">
<a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example</h7>
<div class="highlight highlight-text-html-php position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;?php
$data = array(0 =&gt; 1, 1 =&gt; 2, 2 =&gt; 3);
$msg = msgpack_pack($data);
$data = msgpack_unpack($msg);"><pre><span class="pl-ent">&lt;?php</span>
<span class="pl-s1"><span class="pl-c1">$</span>data</span> = <span class="pl-en">array</span>(<span class="pl-c1">0</span> =&gt; <span class="pl-c1">1</span>, <span class="pl-c1">1</span> =&gt; <span class="pl-c1">2</span>, <span class="pl-c1">2</span> =&gt; <span class="pl-c1">3</span>);
<span class="pl-s1"><span class="pl-c1">$</span>msg</span> = <span class="pl-en">msgpack_pack</span>(<span class="pl-s1"><span class="pl-c1">$</span>data</span>);
<span class="pl-s1"><span class="pl-c1">$</span>data</span> = <span class="pl-en">msgpack_unpack</span>(<span class="pl-s1"><span class="pl-c1">$</span>msg</span>);</pre></div>
<h7 dir="auto">
<a id="user-content-advanced-example" class="anchor" aria-hidden="true" href="#advanced-example"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Advanced Example</h7>
<div class="highlight highlight-text-html-php position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;?php
$data = array(0 =&gt; 1, 1 =&gt; 2, 2 =&gt; 3);
$packer = new \MessagePack(false);
// ^ same as $packer-&gt;setOption(\MessagePack::OPT_PHPONLY, false);
$packed = $packer-&gt;pack($data);

$unpacker = new \MessagePackUnpacker(false);
// ^ same as $unpacker-&gt;setOption(\MessagePack::OPT_PHPONLY, false);
$unpacker-&gt;feed($packed);
$unpacker-&gt;execute();
$unpacked = $unpacker-&gt;data();
$unpacker-&gt;reset();"><pre><span class="pl-ent">&lt;?php</span>
<span class="pl-s1"><span class="pl-c1">$</span>data</span> = <span class="pl-en">array</span>(<span class="pl-c1">0</span> =&gt; <span class="pl-c1">1</span>, <span class="pl-c1">1</span> =&gt; <span class="pl-c1">2</span>, <span class="pl-c1">2</span> =&gt; <span class="pl-c1">3</span>);
<span class="pl-s1"><span class="pl-c1">$</span>packer</span> = <span class="pl-k">new</span> \<span class="pl-v">MessagePack</span>(<span class="pl-c1">false</span>);
<span class="pl-c">// ^ same as $packer-&gt;setOption(\MessagePack::OPT_PHPONLY, false);</span>
<span class="pl-s1"><span class="pl-c1">$</span>packed</span> = <span class="pl-s1"><span class="pl-c1">$</span>packer</span>-&gt;<span class="pl-en">pack</span>(<span class="pl-s1"><span class="pl-c1">$</span>data</span>);

<span class="pl-s1"><span class="pl-c1">$</span>unpacker</span> = <span class="pl-k">new</span> \<span class="pl-v">MessagePackUnpacker</span>(<span class="pl-c1">false</span>);
<span class="pl-c">// ^ same as $unpacker-&gt;setOption(\MessagePack::OPT_PHPONLY, false);</span>
<span class="pl-s1"><span class="pl-c1">$</span>unpacker</span>-&gt;<span class="pl-en">feed</span>(<span class="pl-s1"><span class="pl-c1">$</span>packed</span>);
<span class="pl-s1"><span class="pl-c1">$</span>unpacker</span>-&gt;<span class="pl-en">execute</span>();
<span class="pl-s1"><span class="pl-c1">$</span>unpacked</span> = <span class="pl-s1"><span class="pl-c1">$</span>unpacker</span>-&gt;<span class="pl-en">data</span>();
<span class="pl-s1"><span class="pl-c1">$</span>unpacker</span>-&gt;<span class="pl-en">reset</span>();</pre></div>
<h7 dir="auto">
<a id="user-content-advanced-streaming-example" class="anchor" aria-hidden="true" href="#advanced-streaming-example"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Advanced Streaming Example</h7>
<div class="highlight highlight-text-html-php position-relative overflow-auto" data-snippet-clipboard-copy-content='&lt;?php
$data1 = array(0 =&gt; 1, 1 =&gt; 2, 2 =&gt; 3);
$data2 = array("a" =&gt; 1, "b" =&gt; 2, "c" =&gt; 3);

$packer = new \MessagePack(false);
$packed1 = $packer-&gt;pack($data1);
$packed2 = $packer-&gt;pack($data2);

$unpacker = new \MessagePackUnpacker(false);
$buffer = "";
$nread = 0;

//Simulating streaming data :)
$buffer .= $packed1;
$buffer .= $packed2;

while(true) {
   if($unpacker-&gt;execute($buffer, $nread)) {
       $msg = $unpacker-&gt;data();
       
       var_dump($msg);
       
       $unpacker-&gt;reset();
       $buffer = substr($buffer, $nread);
       $nread = 0;
       if(!empty($buffer)) {
            continue;
       }
   }
   break;
}
'><pre><span class="pl-ent">&lt;?php</span>
<span class="pl-s1"><span class="pl-c1">$</span>data1</span> = <span class="pl-en">array</span>(<span class="pl-c1">0</span> =&gt; <span class="pl-c1">1</span>, <span class="pl-c1">1</span> =&gt; <span class="pl-c1">2</span>, <span class="pl-c1">2</span> =&gt; <span class="pl-c1">3</span>);
<span class="pl-s1"><span class="pl-c1">$</span>data2</span> = <span class="pl-en">array</span>(<span class="pl-s">"a"</span> =&gt; <span class="pl-c1">1</span>, <span class="pl-s">"b"</span> =&gt; <span class="pl-c1">2</span>, <span class="pl-s">"c"</span> =&gt; <span class="pl-c1">3</span>);

<span class="pl-s1"><span class="pl-c1">$</span>packer</span> = <span class="pl-k">new</span> \<span class="pl-v">MessagePack</span>(<span class="pl-c1">false</span>);
<span class="pl-s1"><span class="pl-c1">$</span>packed1</span> = <span class="pl-s1"><span class="pl-c1">$</span>packer</span>-&gt;<span class="pl-en">pack</span>(<span class="pl-s1"><span class="pl-c1">$</span>data1</span>);
<span class="pl-s1"><span class="pl-c1">$</span>packed2</span> = <span class="pl-s1"><span class="pl-c1">$</span>packer</span>-&gt;<span class="pl-en">pack</span>(<span class="pl-s1"><span class="pl-c1">$</span>data2</span>);

<span class="pl-s1"><span class="pl-c1">$</span>unpacker</span> = <span class="pl-k">new</span> \<span class="pl-v">MessagePackUnpacker</span>(<span class="pl-c1">false</span>);
<span class="pl-s1"><span class="pl-c1">$</span>buffer</span> = <span class="pl-s">""</span>;
<span class="pl-s1"><span class="pl-c1">$</span>nread</span> = <span class="pl-c1">0</span>;

<span class="pl-c">//Simulating streaming data :)</span>
<span class="pl-s1"><span class="pl-c1">$</span>buffer</span> .= <span class="pl-s1"><span class="pl-c1">$</span>packed1</span>;
<span class="pl-s1"><span class="pl-c1">$</span>buffer</span> .= <span class="pl-s1"><span class="pl-c1">$</span>packed2</span>;

<span class="pl-k">while</span>(<span class="pl-c1">true</span>) {
   <span class="pl-k">if</span>(<span class="pl-s1"><span class="pl-c1">$</span>unpacker</span>-&gt;<span class="pl-en">execute</span>(<span class="pl-s1"><span class="pl-c1">$</span>buffer</span>, <span class="pl-s1"><span class="pl-c1">$</span>nread</span>)) {
       <span class="pl-s1"><span class="pl-c1">$</span>msg</span> = <span class="pl-s1"><span class="pl-c1">$</span>unpacker</span>-&gt;<span class="pl-en">data</span>();
       
       <span class="pl-en">var_dump</span>(<span class="pl-s1"><span class="pl-c1">$</span>msg</span>);
       
       <span class="pl-s1"><span class="pl-c1">$</span>unpacker</span>-&gt;<span class="pl-en">reset</span>();
       <span class="pl-s1"><span class="pl-c1">$</span>buffer</span> = <span class="pl-en">substr</span>(<span class="pl-s1"><span class="pl-c1">$</span>buffer</span>, <span class="pl-s1"><span class="pl-c1">$</span>nread</span>);
       <span class="pl-s1"><span class="pl-c1">$</span>nread</span> = <span class="pl-c1">0</span>;
       <span class="pl-k">if</span>(!<span class="pl-en">empty</span>(<span class="pl-s1"><span class="pl-c1">$</span>buffer</span>)) {
            <span class="pl-k">continue</span>;
       }
   }
   <span class="pl-k">break</span>;
}</pre></div>
<h6 dir="auto">
<a id="user-content-resources" class="anchor" aria-hidden="true" href="#resources"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Resources</h6>
<ul dir="auto">
<li><a href="http://msgpack.org/" rel="nofollow">msgpack</a></li>
</ul>
</article>
  </div>
        </div>
        
        <div id="qs-ymofen-msgpack-delphi" class="qs"><h4><a href="https://github.com/ymofen/msgpack-delphi" target="_blank">ymofen/msgpack-delphi <span class="qs-url">https://github.com/ymofen/msgpack-delphi</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-msgpack-for-delphi" class="anchor" aria-hidden="true" href="#msgpack-for-delphi"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Msgpack for Delphi</h5>
<p dir="auto">It's like JSON but small and fast.</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="unit Owner: D10.Mofen, qdac.swish
contact:
       qq:185511468, 
    email:185511468@qq.com
welcome to report bug"><pre><code>unit Owner: D10.Mofen, qdac.swish
contact:
       qq:185511468, 
    email:185511468@qq.com
welcome to report bug
</code></pre></div>
<h6 dir="auto">
<a id="user-content-works-with" class="anchor" aria-hidden="true" href="#works-with"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Works with</h6>
<ul dir="auto">
<li>Delphi 7 (tested)</li>
<li>Delphi 2007 (tested)</li>
<li>XE5, XE6, XE7, FMX (tested)</li>
</ul>
<h6 dir="auto">
<a id="user-content-changes" class="anchor" aria-hidden="true" href="#changes"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>changes:</h6>
<ul dir="auto">
<li>
<p dir="auto">first release
2014-08-15 13:05:13</p>
</li>
<li>
<p dir="auto">add array support
2014-08-19 12:18:47</p>
</li>
<li>
<p dir="auto">add andriod support
2014-09-08 00:45:27</p>
</li>
</ul>
<ul dir="auto">
<li>fixed int32, int64 parse bug&lt; integer, int64 parse zero&gt;
2014-11-09 22:35:27</li>
</ul>
<ul dir="auto">
<li>add EncodeToFile/DecodeFromFile
2014-11-13 12:30:58</li>
</ul>
<ul dir="auto">
<li>
<p dir="auto">fix  asVariant = null (thanks for cyw(26890954))
2014-11-14 09:05:52</p>
</li>
<li>
<p dir="auto">fix AsInteger = -1 bug (thanks for cyw(26890954))
2014-11-14 12:15:52</p>
</li>
<li>
<p dir="auto">fix AsInteger = -127 bug
check int64/integer/cardinal/word/shortint/smallint/byte assign, encode,decode, read
2014-11-14 12:30:38</p>
</li>
<li>
<p dir="auto">fix AsFloat = 2.507182 bug
thanks fo [珠海]-芒果  1939331207
2014-11-21 12:37:04</p>
</li>
<li>
<p dir="auto">add AddArrayChild func
2015-03-25 17:47:28</p>
</li>
<li>
<p dir="auto">add remove/removeFromParent/Delete function
2015-08-29 22:37:48</p>
</li>
</ul>
<h7 dir="auto">
<a id="user-content-code-example" class="anchor" aria-hidden="true" href="#code-example"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Code Example</h7>
<div class="highlight highlight-source-pascal position-relative overflow-auto" data-snippet-clipboard-copy-content="
var
  lvMsg, lvMsg2:TSimpleMsgPack;
  lvBytes:TBytes;
  s:string;
begin
  lvMsg := TSimpleMsgPack.Create;
  lvMsg.S['key.obj'] := '汉字,ascii';
  if dlgOpen.Execute then
  begin
    lvMsg.S['key.image.name'] := ExtractFileName(dlgOpen.FileName);
    
    // file binary data
    lvMsg.ForcePathObject('key.image.data').LoadBinaryFromFile(dlgOpen.FileName);
  end;
  
  //
  lvBytes := lvMsg.EncodeToBytes;

  lvMsg2 := TSimpleMsgPack.Create;
  lvMsg2.DecodeFromBytes(lvBytes);
  //
  Memo1.Lines.Add(lvMsg2.S['key.obj']);
  if lvMsg2.S['key.image.name'] &lt;&gt; '' then
  begin
    s := ExtractFilePath(ParamStr(0)) + lvMsg2.S['key.image.name'];
    Memo1.Lines.Add('file saved');
    Memo1.Lines.Add(s);
    lvMsg2.ForcePathObject('key.image.data').SaveBinaryToFile(s);    
  end;
  "><pre><span class="pl-k">var</span>
  lvMsg, lvMsg2:TSimpleMsgPack;
  lvBytes:TBytes;
  s:string;
<span class="pl-k">begin</span>
  lvMsg := TSimpleMsgPack.Create;
  lvMsg.S[<span class="pl-s"><span class="pl-pds">'</span>key.obj<span class="pl-pds">'</span></span>] := <span class="pl-s"><span class="pl-pds">'</span>汉字,ascii<span class="pl-pds">'</span></span>;
  <span class="pl-k">if</span> dlgOpen.Execute <span class="pl-k">then</span>
  <span class="pl-k">begin</span>
    lvMsg.S[<span class="pl-s"><span class="pl-pds">'</span>key.image.name<span class="pl-pds">'</span></span>] := ExtractFileName(dlgOpen.FileName);
    
    <span class="pl-c"><span class="pl-c">//</span> file binary data</span>
    lvMsg.ForcePathObject(<span class="pl-s"><span class="pl-pds">'</span>key.image.data<span class="pl-pds">'</span></span>).LoadBinaryFromFile(dlgOpen.FileName);
  <span class="pl-k">end</span>;
  
  <span class="pl-c"><span class="pl-c">//</span></span>
  lvBytes := lvMsg.EncodeToBytes;

  lvMsg2 := TSimpleMsgPack.Create;
  lvMsg2.DecodeFromBytes(lvBytes);
  <span class="pl-c"><span class="pl-c">//</span></span>
  Memo1.Lines.Add(lvMsg2.S[<span class="pl-s"><span class="pl-pds">'</span>key.obj<span class="pl-pds">'</span></span>]);
  <span class="pl-k">if</span> lvMsg2.S[<span class="pl-s"><span class="pl-pds">'</span>key.image.name<span class="pl-pds">'</span></span>] &lt;&gt; <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span> <span class="pl-k">then</span>
  <span class="pl-k">begin</span>
    s := ExtractFilePath(ParamStr(<span class="pl-c1">0</span>)) + lvMsg2.S[<span class="pl-s"><span class="pl-pds">'</span>key.image.name<span class="pl-pds">'</span></span>];
    Memo1.Lines.Add(<span class="pl-s"><span class="pl-pds">'</span>file saved<span class="pl-pds">'</span></span>);
    Memo1.Lines.Add(s);
    lvMsg2.ForcePathObject(<span class="pl-s"><span class="pl-pds">'</span>key.image.data<span class="pl-pds">'</span></span>).SaveBinaryToFile(s);    
  <span class="pl-k">end</span>;
  </pre></div>
</article>
  </div>
        </div>
        
        <div id="qs-romixlab-qmsgpack" class="qs"><h4><a href="https://github.com/romixlab/qmsgpack" target="_blank">romixlab/qmsgpack <span class="qs-url">https://github.com/romixlab/qmsgpack</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-qt" class="anchor" aria-hidden="true" href="#messagepack-for-qt"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for Qt</h5>
<p dir="auto">Full documentation is here <a href="http://msgpack.marsworks.ru/" rel="nofollow">mp.marsw.ru</a></p>
<h6 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h6>
<p dir="auto">Clone repository:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto" data-snippet-clipboard-copy-content="git clone https://github.com/romixlab/qmsgpack.git
cd qmsgpack
mkdir build
cd build
cmake ..
make install"><pre>git clone https://github.com/romixlab/qmsgpack.git
<span class="pl-c1">cd</span> qmsgpack
mkdir build
<span class="pl-c1">cd</span> build
cmake ..
make install</pre></div>
<h6 dir="auto">
<a id="user-content-sample-usage" class="anchor" aria-hidden="true" href="#sample-usage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Sample usage</h6>
<p dir="auto">Packing</p>
<div class="highlight highlight-source-c++ position-relative overflow-auto" data-snippet-clipboard-copy-content="QVariantList list;
list &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3;
QByteArray array = MsgPack::pack(list);"><pre>QVariantList list;
list &lt;&lt; <span class="pl-c1">1</span> &lt;&lt; <span class="pl-c1">2</span> &lt;&lt; <span class="pl-c1">3</span>;
QByteArray array = MsgPack::pack(list);</pre></div>
<p dir="auto">Unpacking:</p>
<div class="highlight highlight-source-c++ position-relative overflow-auto" data-snippet-clipboard-copy-content="QVariantList unpacked = MsgPack::unpack(array).toList();"><pre>QVariantList unpacked = MsgPack::unpack(array).toList();</pre></div>
<p dir="auto">Streaming API:</p>
<div class="highlight highlight-source-c++ position-relative overflow-auto" data-snippet-clipboard-copy-content='// packing
MsgPackStream stream(&amp;ba, QIODevice::WriteOnly);
stream &lt;&lt; 1 &lt;&lt; 2.3 &lt;&lt; "some string";

// unpacking
MsgPackStream stream(ba);
int a;
double b;
QSting s;
stream &gt;&gt; a &gt;&gt; b &gt;&gt; s;'><pre><span class="pl-c"><span class="pl-c">//</span> packing</span>
MsgPackStream <span class="pl-en">stream</span>(&amp;ba, QIODevice::WriteOnly);
stream &lt;&lt; <span class="pl-c1">1</span> &lt;&lt; <span class="pl-c1">2.3</span> &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>some string<span class="pl-pds">"</span></span>;

<span class="pl-c"><span class="pl-c">//</span> unpacking</span>
MsgPackStream <span class="pl-en">stream</span>(ba);
<span class="pl-k">int</span> a;
<span class="pl-k">double</span> b;
QSting s;
stream &gt;&gt; a &gt;&gt; b &gt;&gt; s;</pre></div>
<h6 dir="auto">
<a id="user-content-qt-types-and-user-types" class="anchor" aria-hidden="true" href="#qt-types-and-user-types"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Qt types and User types</h6>
<p dir="auto">There is packers and unpackers for QColor, QTime, QDate, QDateTime, QPoint, QSize, QRect. Also you can create your own packer/unpacker methods for Qt or your own types. See <a href="http://msgpack.marsworks.ru/" rel="nofollow">docs</a> for details.</p>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-ruby" class="qs"><h4><a href="https://github.com/msgpack/msgpack-ruby" target="_blank">msgpack/msgpack-ruby <span class="qs-url">https://github.com/msgpack/msgpack-ruby</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-ruby" class="anchor" aria-hidden="true" href="#messagepack-for-ruby"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for Ruby</h5>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="require 'msgpack'
msg = [1,2,3].to_msgpack  #=&gt; &quot;\x93\x01\x02\x03&quot;
MessagePack.unpack(msg)   #=&gt; [1,2,3]"><pre><code>require 'msgpack'
msg = [1,2,3].to_msgpack  #=&gt; "\x93\x01\x02\x03"
MessagePack.unpack(msg)   #=&gt; [1,2,3]
</code></pre></div>
<h6 dir="auto">
<a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install</h6>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="gem install msgpack"><pre><code>gem install msgpack
</code></pre></div>
<h6 dir="auto">
<a id="user-content-use-cases" class="anchor" aria-hidden="true" href="#use-cases"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use cases</h6>
<ul dir="auto">
<li>Create REST API returing MessagePack using Rails + <a href="https://github.com/nesquena/rabl">RABL</a>
</li>
<li>Store objects efficiently in memcached or Redis</li>
<li>Upload data in efficient format from mobile devices. See also MessagePack for <a href="https://github.com/msgpack/msgpack-objectivec">Objective-C</a> and <a href="https://github.com/msgpack/msgpack-java">Java</a>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-links" class="anchor" aria-hidden="true" href="#links"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Links</h6>
<ul dir="auto">
<li><a href="https://github.com/msgpack/msgpack-ruby">Github</a></li>
<li><a href="http://ruby.msgpack.org/" rel="nofollow">API document</a></li>
</ul>
<h6 dir="auto">
<a id="user-content-streaming-api" class="anchor" aria-hidden="true" href="#streaming-api"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Streaming API</h6>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="# serialize a 2-element array [e1, e2]
pk = MessagePack::Packer.new(io)
pk.write_array_header(2).write(e1).write(e2).flush"><pre><code># serialize a 2-element array [e1, e2]
pk = MessagePack::Packer.new(io)
pk.write_array_header(2).write(e1).write(e2).flush
</code></pre></div>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="# deserialize objects from an IO
u = MessagePack::Unpacker.new(io)
u.each { |obj| ... }"><pre><code># deserialize objects from an IO
u = MessagePack::Unpacker.new(io)
u.each { |obj| ... }
</code></pre></div>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="# event-driven deserialization
def on_read(data)
  @u ||= MessagePack::Unpacker.new
  @u.feed_each(data) { |obj| ... }
end"><pre><code># event-driven deserialization
def on_read(data)
  @u ||= MessagePack::Unpacker.new
  @u.feed_each(data) { |obj| ... }
end
</code></pre></div>
</article>
  </div>
        </div>
        
        <div id="qs-3Hren-msgpack-rust" class="qs"><h4><a href="https://github.com/3Hren/msgpack-rust" target="_blank">3Hren/msgpack-rust <span class="qs-url">https://github.com/3Hren/msgpack-rust</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-rmp---rust-messagepack" class="anchor" aria-hidden="true" href="#rmp---rust-messagepack"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>RMP - Rust MessagePack</h5>
<p dir="auto">RMP is a pure Rust <a href="http://msgpack.org" rel="nofollow">MessagePack</a> implementation.</p>
<p dir="auto"><a href="https://travis-ci.org/3Hren/msgpack-rust" rel="nofollow"><img src="https://camo.githubusercontent.com/2ffa8cc83a0ba3e8207205532b46b7cc373b499c8bc938251f07f8fd15ed60c2/68747470733a2f2f7472617669732d63692e6f72672f334872656e2f6d73677061636b2d727573742e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/3Hren/msgpack-rust.svg?branch=master" style="max-width: 100%;"></a>
<a href="https://coveralls.io/github/3Hren/msgpack-rust?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/c262a2972542fc723c76e2095cfd330f2f743e2f6c3ef626cc797f3377fcf6f4/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f334872656e2f6d73677061636b2d727573742f62616467652e7376673f6272616e63683d6d617374657226736572766963653d676974687562" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/3Hren/msgpack-rust/badge.svg?branch=master&amp;service=github" style="max-width: 100%;"></a></p>
<p dir="auto">This repository consists of three separate crates: the RMP core and two implementations to ease serializing and
deserializing Rust structs.</p>
<table>
<thead>
<tr>
<th>crates.rs</th>
<th>API Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://lib.rs/crates/rmp" rel="nofollow"><img src="https://camo.githubusercontent.com/ae8375ab831116987f0e186314323e29caf0ce9a9e32615c91648388e347b737/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f726d702e737667" alt="rmp" data-canonical-src="https://img.shields.io/crates/v/rmp.svg" style="max-width: 100%;"></a></td>
<td><a href="https://docs.rs/rmp" rel="nofollow">RMP</a></td>
</tr>
<tr>
<td><a href="https://lib.rs/crates/rmp-serde" rel="nofollow"><img src="https://camo.githubusercontent.com/5b20951fc120d519e5e426c743075dc570a1fb96d58354ad9c41ddb81edc391f/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f726d702d73657264652e737667" alt="rmps" data-canonical-src="https://img.shields.io/crates/v/rmp-serde.svg" style="max-width: 100%;"></a></td>
<td><a href="https://docs.rs/rmp-serde" rel="nofollow">RMP Serde</a></td>
</tr>
<tr>
<td><a href="https://lib.rs/crates/rmpv" rel="nofollow"><img src="https://camo.githubusercontent.com/f40661e8dcde7d8dcd10ceb682aad5bc67f394e88d75762c56d376cb274521f3/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f726d70762e737667" alt="rmpv" data-canonical-src="https://img.shields.io/crates/v/rmpv.svg" style="max-width: 100%;"></a></td>
<td><a href="https://docs.rs/rmpv" rel="nofollow">RMP Value</a></td>
</tr>
</tbody>
</table>
<h6 dir="auto">
<a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h6>
<ul dir="auto">
<li>
<p dir="auto"><strong>Convenient API</strong></p>
<p dir="auto">RMP is designed to be lightweight and straightforward. There are low-level API, which gives you
full control on data encoding/decoding process and makes no heap allocations. On the other hand
there are high-level API, which provides you convenient interface using Rust standard library and
compiler reflection, allowing to encode/decode structures using <code>derive</code> attribute.</p>
</li>
<li>
<p dir="auto"><strong>Zero-copy value decoding</strong></p>
<p dir="auto">RMP allows to decode bytes from a buffer in a zero-copy manner easily and blazingly fast, while Rust
static checks guarantees that the data will be valid as long as the buffer lives.</p>
</li>
<li>
<p dir="auto"><strong>Clear error handling</strong></p>
<p dir="auto">RMP's error system guarantees that you never receive an error enum with unreachable variant.</p>
</li>
<li>
<p dir="auto"><strong>Robust and tested</strong></p>
<p dir="auto">This project is developed using TDD and CI, so any found bugs will be fixed without breaking
existing functionality.</p>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-requirements" class="anchor" aria-hidden="true" href="#requirements"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Requirements</h6>
<ul dir="auto">
<li>Rust 1.53.0 or later</li>
</ul>
</article>
  </div>
        </div>
        
        <div id="qs-msgpack-msgpack-scala" class="qs"><h4><a href="https://github.com/msgpack/msgpack-scala" target="_blank">msgpack/msgpack-scala <span class="qs-url">https://github.com/msgpack/msgpack-scala</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepack-for-scala" class="anchor" aria-hidden="true" href="#messagepack-for-scala"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack for Scala</h5>
<p dir="auto"><a href="https://travis-ci.org/msgpack/msgpack-scala" rel="nofollow"><img src="https://camo.githubusercontent.com/20a542686670e299bdd46c8640626e29c72c06332d8cc6abb3e43d9ad3e7f982/68747470733a2f2f7472617669732d63692e6f72672f6d73677061636b2f6d73677061636b2d7363616c612e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/msgpack/msgpack-scala.svg?branch=master" style="max-width: 100%;"></a></p>
<ul dir="auto">
<li>Message Pack specification: <a href="https://github.com/msgpack/msgpack/blob/master/spec.md">https://github.com/msgpack/msgpack/blob/master/spec.md</a>
</li>
</ul>
<h6 dir="auto">
<a id="user-content-quick-start" class="anchor" aria-hidden="true" href="#quick-start"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quick Start</h6>
<p dir="auto"><a href="https://maven-badges.herokuapp.com/maven-central/org.msgpack/msgpack-scala_2.12/" rel="nofollow"><img src="https://camo.githubusercontent.com/792dddff6dac94afaa9025c6fbf51e61c7ed4b1fb7bde1f7461b21bdcc6e2803/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f6f72672e6d73677061636b2f6d73677061636b2d7363616c615f322e31322f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/org.msgpack/msgpack-scala_2.12/badge.svg" style="max-width: 100%;"></a></p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='libraryDependencies += "org.msgpack" %% "msgpack-scala" % "(version)"'><pre><code>libraryDependencies += "org.msgpack" %% "msgpack-scala" % "(version)"
</code></pre></div>
<p dir="auto">General usage is the same with msgpack-java. See this <a href="https://github.com/msgpack/msgpack-java/blob/develop/msgpack-core/src/test/java/org/msgpack/core/example/MessagePackExample.java">example code (Java)</a>.</p>
<h6 dir="auto">
<a id="user-content-for-messagepack-developers" class="anchor" aria-hidden="true" href="#for-messagepack-developers"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>For MessagePack Developers</h6>
<h7 dir="auto">
<a id="user-content-basic-sbt-commands" class="anchor" aria-hidden="true" href="#basic-sbt-commands"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Basic sbt commands</h7>
<p dir="auto">Enter the sbt console:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="$ ./sbt"><pre><code>$ ./sbt
</code></pre></div>
<p dir="auto">Here is a list of sbt commands for daily development:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='&gt; ~compile                                 # Compile source codes
&gt; ~test:compile                            # Compile both source and test codes
&gt; ~test                                    # Run tests upon source code change
&gt; ~test-only *MessagePackTest              # Run tests in the specified class
&gt; ~test-only *MessagePackTest -- -n prim   # Run the test tagged as "prim"
&gt; project msgpack-scala                    # Focus on a specific project
&gt; package                                  # Create a jar file in the target folder of each project
&gt; scalafmt                                 # Reformat source codes
&gt; ; coverage; test; coverageReport; coverageAggregate;  # Code coverage'><pre><code>&gt; ~compile                                 # Compile source codes
&gt; ~test:compile                            # Compile both source and test codes
&gt; ~test                                    # Run tests upon source code change
&gt; ~test-only *MessagePackTest              # Run tests in the specified class
&gt; ~test-only *MessagePackTest -- -n prim   # Run the test tagged as "prim"
&gt; project msgpack-scala                    # Focus on a specific project
&gt; package                                  # Create a jar file in the target folder of each project
&gt; scalafmt                                 # Reformat source codes
&gt; ; coverage; test; coverageReport; coverageAggregate;  # Code coverage
</code></pre></div>
<h7 dir="auto">
<a id="user-content-publishing" class="anchor" aria-hidden="true" href="#publishing"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Publishing</h7>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content="&gt; publishLocal            # Install to local .ivy2 repository
&gt; publish                 # Publishing a snapshot version to the Sonatype repository

&gt; release                 # Run the release procedure (set a new version, run tests, upload artifacts, then deploy to Sonatype)"><pre><code>&gt; publishLocal            # Install to local .ivy2 repository
&gt; publish                 # Publishing a snapshot version to the Sonatype repository

&gt; release                 # Run the release procedure (set a new version, run tests, upload artifacts, then deploy to Sonatype)
</code></pre></div>
<p dir="auto">For publishing to Maven central, msgpack-scala uses <a href="https://github.com/xerial/sbt-sonatype">sbt-sonatype</a> plugin. Set Sonatype account information (user name and password) in the global sbt settings. To protect your password, never include this file in your project.</p>
<p dir="auto"><em><strong>$HOME/.sbt/(sbt-version)/sonatype.sbt</strong></em></p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='credentials += Credentials("Sonatype Nexus Repository Manager",
        "oss.sonatype.org",
        "(Sonatype user name)",
        "(Sonatype password)")'><pre><code>credentials += Credentials("Sonatype Nexus Repository Manager",
        "oss.sonatype.org",
        "(Sonatype user name)",
        "(Sonatype password)")
</code></pre></div>
</article>
  </div>
        </div>
        
        <div id="qs-a2-MessagePack-swift" class="qs"><h4><a href="https://github.com/a2/MessagePack.swift" target="_blank">a2/MessagePack.swift <span class="qs-url">https://github.com/a2/MessagePack.swift</span></a></h4>
<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><h5 dir="auto">
<a id="user-content-messagepackswift" class="anchor" aria-hidden="true" href="#messagepackswift"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MessagePack.swift</h5>
<p dir="auto"><a href="http://cocoapods.org/pods/MessagePack.swift" rel="nofollow"><img src="https://camo.githubusercontent.com/518ad14a87e94fdd7011ed95ab3d8a6f84deb05c094f36b36175c9ec415e80f0/68747470733a2f2f696d672e736869656c64732e696f2f636f636f61706f64732f762f4d6573736167655061636b2e73776966742e7376673f7374796c653d666c6174" alt="Version" data-canonical-src="https://img.shields.io/cocoapods/v/MessagePack.swift.svg?style=flat" style="max-width: 100%;"></a>
<a href="http://cocoapods.org/pods/MessagePack.swift" rel="nofollow"><img src="https://camo.githubusercontent.com/1f08238ceaeb6ad6b379da2c3840eec1f5a06f932115ff67e69604feec292b2f/68747470733a2f2f696d672e736869656c64732e696f2f636f636f61706f64732f6c2f4d6573736167655061636b2e73776966742e7376673f7374796c653d666c6174" alt="License" data-canonical-src="https://img.shields.io/cocoapods/l/MessagePack.swift.svg?style=flat" style="max-width: 100%;"></a>
<a href="http://cocoapods.org/pods/MessagePack.swift" rel="nofollow"><img src="https://camo.githubusercontent.com/094fa6bb9d8eea7480a9e8a37b832a81ffbe842c4126c138fb23ded1c425ad8f/68747470733a2f2f696d672e736869656c64732e696f2f636f636f61706f64732f702f4d6573736167655061636b2e73776966742e7376673f7374796c653d666c6174" alt="Platform" data-canonical-src="https://img.shields.io/cocoapods/p/MessagePack.swift.svg?style=flat" style="max-width: 100%;"></a></p>
<p dir="auto">A fast, zero-dependency MessagePack implementation written in Swift 4. Supports Apple platforms and Linux.</p>
<h6 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h6>
<h7 dir="auto">
<a id="user-content-cocoapods" class="anchor" aria-hidden="true" href="#cocoapods"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CocoaPods</h7>
<p dir="auto">To use CocoaPods, add the following to your Podfile:</p>
<div class="highlight highlight-source-ruby position-relative overflow-auto" data-snippet-clipboard-copy-content="pod 'MessagePack.swift', '~&gt; 4.0'"><pre><span class="pl-en">pod</span> <span class="pl-s">'MessagePack.swift'</span><span class="pl-kos">,</span> <span class="pl-s">'~&gt; 4.0'</span></pre></div>
<h7 dir="auto">
<a id="user-content-carthage" class="anchor" aria-hidden="true" href="#carthage"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Carthage</h7>
<p dir="auto">To use Carthage, add the following to your Cartfile:</p>
<div class="snippet-clipboard-content position-relative overflow-auto" data-snippet-clipboard-copy-content='github "a2/MessagePack.swift" ~&gt; 4.0'><pre lang="ogdl"><code>github "a2/MessagePack.swift" ~&gt; 4.0
</code></pre></div>
<h7 dir="auto">
<a id="user-content-spm-swift-package-manager" class="anchor" aria-hidden="true" href="#spm-swift-package-manager"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SPM (Swift Package Manager)</h7>
<p dir="auto">You can easily integrate MessagePack.swift in your app with SPM. Just add MessagePack.swift as a dependency:</p>
<div class="highlight highlight-source-swift position-relative overflow-auto" data-snippet-clipboard-copy-content='import PackageDescription

let package = Package(
    name: "MyAwesomeApp",
    dependencies: [
        .Package(url: "https://github.com/a2/MessagePack.swift.git", majorVersion: 4),
    ]
)'><pre><span class="pl-k">import</span> <span class="pl-en">PackageDescription</span>

<span class="pl-k">let</span> package <span class="pl-k">=</span> <span class="pl-c1">Package</span>(
    <span class="pl-c1">name</span>: <span class="pl-s"><span class="pl-pds">"</span>MyAwesomeApp<span class="pl-pds">"</span></span>,
    <span class="pl-c1">dependencies</span>: [
        .<span class="pl-c1">Package</span>(<span class="pl-c1">url</span>: <span class="pl-s"><span class="pl-pds">"</span>https://github.com/a2/MessagePack.swift.git<span class="pl-pds">"</span></span>, <span class="pl-c1">majorVersion</span>: <span class="pl-c1">4</span>),
    ]
)</pre></div>
<h6 dir="auto">
<a id="user-content-version" class="anchor" aria-hidden="true" href="#version"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Version</h6>
<ul dir="auto">
<li>Versions 4.x support Swift 5.2.</li>
<li>Versions 3.x support Swift 4.</li>
<li>Support for Swift 3 was dropped after <a href="https://github.com/a2/MessagePack.swift/releases/tag/2.1.1">2.1.1</a>.</li>
<li>Support for Swift 2 was dropped after <a href="https://github.com/a2/MessagePack.swift/releases/tag/1.2.0">1.2.0</a>.</li>
</ul>
<h6 dir="auto">
<a id="user-content-authors" class="anchor" aria-hidden="true" href="#authors"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Authors</h6>
<p dir="auto">Alexsander Akers, <a href="mailto:me@a2.io">me@a2.io</a></p>
<h6 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h6>
<p dir="auto">MessagePack.swift is available under the MIT license. See the LICENSE file for more info.</p>
</article>
  </div>
        </div>
        
      </div>
    </section>

    <section id="related">
      <h3>Related projects</h3>

      <div class="paragraphs">
        <h4><a href="https://github.com/dotcloud/zerorpc-python">ZeroRPC</a> by DotCloud</h4>
        <p>zerorpc is a flexible RPC implementation based on zeromq and messagepack. Service APIs exposed with zerorpc are called "zeroservices".</p>

        <h4><a href="https://github.com/pfi/pficommon">pficommon</a> by Preferred Infrastructure, Inc.</h4>
        <p>General purpose C++ library for Preferred Infrastructure, Inc. It includes MessagePack-RPC implementation for C++</p>
      </div>
    </section>

    <div id="json-to-msgpack">
      <h3>JSON <span class="bytes" id="json-bytes"></span></h3>
      <textarea type="text" id="json-text">{"compact":true,"schema":0}</textarea>
      <h3>MessagePack (hex) <span class="bytes" id="msgpack-bytes"></span> <span class="bytes" id="msgpack-percent"></span></h3>
      <textarea readonly id="msgpack-text"></textarea>
    </div>
  </main>

  <footer>
    <div>
      <div id="thanks">
        <p>MessagePack &trade; Copyright &copy; 2008-2021 Sadayuki Furuhashi</p>
      </div>
    </div>
  </footer>
</body>
